<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="author" content="Regulus"/><meta name="copyright" content="Regulus"/><meta name="theme-color" content="#FFB347"/><meta name="format-detection" content="telephone=no"/><meta name="keywords" content="Hexo Theme MEOW"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="apple-touch-fullscreen" content="yes"/><meta name="application-name" content="电子取证 | Mei的小窝"/><meta name="apple-mobile-web-app-title" content="电子取证 | Mei的小窝"/><meta name="apple-mobile-web-app-status-bar-style" content="#FFB347"/><link rel="canonical" href="http://example.com/2025/12/16/电子取证/"/><meta name="description" content="电子取证不知道是杂项学到后面了还是怎么回事，好像取证的题目越来越多了，然后取证感觉和杂项其他题目都有点不一样了，感觉取证应该自己再立一个方向 电子取证主要包括磁盘取证和内存取证 工具介绍取证这里，工具是最重要的，如果有工具大部分内存取证的题目都可以用lovelymen梭哈，但是学会工具怎么用特别重要，后面会把用到的工具都收集起来 磁盘取证我们在得到附件的时候，如果是一个没后缀且没见过的文件类...">
<meta property="og:type" content="article">
<meta property="og:title" content="电子取证 | Mei的小窝">
<meta property="og:url" content="http://example.com/2025/12/16/%E7%94%B5%E5%AD%90%E5%8F%96%E8%AF%81/index.html">
<meta property="og:site_name" content="Mei的小窝">
<meta property="og:description" content="电子取证不知道是杂项学到后面了还是怎么回事，好像取证的题目越来越多了，然后取证感觉和杂项其他题目都有点不一样了，感觉取证应该自己再立一个方向 电子取证主要包括磁盘取证和内存取证 工具介绍取证这里，工具是最重要的，如果有工具大部分内存取证的题目都可以用lovelymen梭哈，但是学会工具怎么用特别重要，后面会把用到的工具都收集起来 磁盘取证我们在得到附件的时候，如果是一个没后缀且没见过的文件类...">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/2025/12/16/%E7%94%B5%E5%AD%90%E5%8F%96%E8%AF%81/assets/images/Hexo-Theme-MEOW.png">
<meta property="article:published_time" content="2025-12-16T13:18:25.000Z">
<meta property="article:modified_time" content="2025-12-25T13:34:22.079Z">
<meta property="article:author" content="Regulus">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://example.com/2025/12/16/%E7%94%B5%E5%AD%90%E5%8F%96%E8%AF%81/assets/images/Hexo-Theme-MEOW.png"><meta name="robots" content="index,follow"/><meta name="googlebot" content="index,follow"/><meta name="revisit-after" content="1 days"/><title>电子取证 | Mei的小窝</title><link rel="shortcut icon" href="/assets/images/Hexo-Theme-MEOW.ico"><link rel="preconnect" href="/assets"/><link rel="preconnect" href="assets"/>
<link rel="stylesheet" href="/css/style.css">
<link rel="prefetch" href="/"/><link rel="prefetch" href="/archives"/><link rel="prefetch" href="/tags"/><meta name="generator" content="Hexo 7.3.0"></head><body bg-style="none"><header><div id="navbar"><div id="nav-info"><a id="site-icon" href="/" title="主页"><img src="/assets/images/Hexo-Theme-MEOW.png" alt="Logo"/></a><a id="site-name" href="/" title="主页"><div>Mei的小窝</div><img src="/assets/images/svg/uc/uc-home.svg" class="icon noview" alt="Icon"></a></div><div id="nav-menu"><div class="menu-item"><a href="javascript:void(0);"><img src="/assets/images/svg/uc/uc-article.svg" class="icon noview" alt="Icon"><span>文章</span></a><ul class="sub-menu-item"><li><a href="/archives"><img src="/assets/images/svg/uc/uc-archive.svg" class="icon noview" alt="Icon"><span>归档</span></a></li><li><a href="/categories"><img src="/assets/images/svg/uc/uc-category.svg" class="icon noview" alt="Icon"><span>分类</span></a></li><li><a href="/tags"><img src="/assets/images/svg/uc/uc-tag.svg" class="icon noview" alt="Icon"><span>标签</span></a></li><li><a href="/about"><img src="/assets/images/svg/uc/uc-about.svg" class="icon noview" alt="Icon"><span>关于</span></a></li></ul></div></div><div id="nav-function"><div id="search-btn"><a href="javascript:void(0);" title="搜索" accesskey="s"><img src="/assets/images/svg/uc/uc-search.svg" class="icon noview" alt="Icon"><span>搜索</span></a></div><div id="menu-btn"><a href="javascript:void(0);" title="打开菜单"><img src="/assets/images/svg/uc/uc-menu.svg" class="icon noview" alt="Icon"></a></div></div></div></header><div id="menu-aside"><div id="menu-aside-container"><div id="menu-aside-info"><a href="/" title="主页"><img src="/assets/images/Hexo-Theme-MEOW.png" alt="Logo"/></a><a href="/" title="主页">Mei的小窝</a></div><div class="menu-aside-item"><a href="javascript:void(0);"><img src="/assets/images/svg/uc/uc-article.svg" class="icon noview" alt="Icon"><span>文章</span></a><ul class="menu-aside-sub-item"><li><a href="/archives"><img src="/assets/images/svg/uc/uc-archive.svg" class="icon noview" alt="Icon"><span>归档</span></a></li><li><a href="/categories"><img src="/assets/images/svg/uc/uc-category.svg" class="icon noview" alt="Icon"><span>分类</span></a></li><li><a href="/tags"><img src="/assets/images/svg/uc/uc-tag.svg" class="icon noview" alt="Icon"><span>标签</span></a></li><li><a href="/about"><img src="/assets/images/svg/uc/uc-about.svg" class="icon noview" alt="Icon"><span>关于</span></a></li></ul></div><hr/></div></div><main><div class="banner"><div class="banner-info"><div class="banner-avatar"><img src="/assets/images/Hexo-Theme-MEOW.png" alt="Avatar"/></div><div class="banner-title">「 Mei的小窝 」</div></div></div><div class="post-container"><div class="post-main"><div class="post-content"><h1 class="post-title">电子取证</h1><div class="post-author"><span>作者: Regulus</span></div><div class="post-meta"><div class="post-info"><div class="post-date"><div class="post-pubdate"><img src="/assets/images/svg/ta/ta-pubdate.svg" class="icon noview" alt="Icon"><span>发表于2025-12-16</span></div><div class="post-update"><img src="/assets/images/svg/ta/ta-update.svg" class="icon noview" alt="Icon"><span>更新于2025-12-25</span></div></div><div class="post-read"><div class="post-wordcount"><img src="/assets/images/svg/ta/ta-write.svg" class="icon noview" alt="Icon"><span>总字数: 6.9k字</span></div><div class="post-readtime"><img src="/assets/images/svg/ta/ta-time.svg" class="icon noview" alt="Icon"><span>阅读时长: 22分钟</span></div><div class="post-pageview"><img src="/assets/images/svg/ta/ta-fire.svg" class="icon noview" alt="Icon"><span>访问量: </span><span id="vercount_value_page_pv"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"  stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 6l0 -3" /><path d="M16.25 7.75l2.15 -2.15" /><path d="M18 12l3 0" /><path d="M16.25 16.25l2.15 2.15" /><path d="M12 18l0 3" /><path d="M7.75 16.25l-2.15 2.15" /><path d="M6 12l-3 0" /><path d="M7.75 7.75l-2.15 -2.15" /></svg></span></div></div></div><div class="post-attribute"></div></div><div class="post markdown" indent="false"><h1 id="电子取证"><a href="#电子取证" class="headerlink" title="电子取证"></a>电子取证</h1><p>不知道是杂项学到后面了还是怎么回事，好像取证的题目越来越多了，然后取证感觉和杂项其他题目都有点不一样了，感觉取证应该自己再立一个方向</p>
<p>电子取证主要包括磁盘取证和内存取证</p>
<h2 id="工具介绍"><a href="#工具介绍" class="headerlink" title="工具介绍"></a>工具介绍</h2><p>取证这里，工具是最重要的，如果有工具大部分内存取证的题目都可以用lovelymen梭哈，但是学会工具怎么用特别重要，后面会把用到的工具都收集起来</p>
<h2 id="磁盘取证"><a href="#磁盘取证" class="headerlink" title="磁盘取证"></a>磁盘取证</h2><p>我们在得到附件的时候，如果是一个没后缀且没见过的文件类型，或者没见过的后缀，那大概率就是取证了</p>
<p>我们如果需要判断是否为磁盘取证，我们首先需要识别文件类型</p>
<h3 id="1-确认文件类型"><a href="#1-确认文件类型" class="headerlink" title="1.确认文件类型"></a>1.确认文件类型</h3><p>我们区分内存取证和磁盘取证主要的方式就是通过文件类型，当我们拿到文件没有后缀的时候就需要使用工具进行判断</p>
<p><strong>TrIDNet</strong></p>
<p>这个工具感觉就是TrID的一个图形化界面程序，<a target="_blank" rel="noopener" href="https://www.mark0.net/soft-tridnet-e.html">exe文件下载地址</a></p>
<img lazyload src="/assets/images/Meow-Loading.webp" data-lazy-src="/2025/12/16/%E7%94%B5%E5%AD%90%E5%8F%96%E8%AF%81/image-20251217170213049.png" class title="image-20251217170213049">

<p>注意这两个都是要下载的，一个是exe文件另外一个是xml文件集</p>
<p>我们需要将xml文件集解压出来的defs文件放到exe文件的目录下，这样就会自动加载了</p>
<p>这个文件类型有两千多种，但是有时候做题还是识别不出来，真的是难为出题人了</p>
<p>然后听说是可以自己往里面加类型的，但是现在我还不会</p>
<p><strong>file命令</strong></p>
<p>我们可以使用Linux内置的file命令判断文件类型</p>
<p>file命令是通过<strong>魔术字节（magic number）匹配</strong>和其他 heuristics（启发式方法）来识别文件类型。</p>
<p>也就是说判断文件类型的数目取决于magic数据库</p>
<p>我们可以通过<code>file -version</code>判断</p>
<div class="table-container"><table>
<thead>
<tr>
<th>系统 &#x2F; 版本</th>
<th>magic 条目</th>
<th>可能识别类型数量</th>
</tr>
</thead>
<tbody><tr>
<td>Ubuntu 22.04 &#x2F; file 5.41</td>
<td>~5600</td>
<td>2000–3000+</td>
</tr>
<tr>
<td>CentOS 7 &#x2F; file 5.11</td>
<td>~4400</td>
<td>1500–2500</td>
</tr>
</tbody></table></div>
<p>我又拿file命令试了一下，发现刚才那个文件还是不行</p>
<p>语法</p>
<div class="code-container" code-lang="Bash"><div class="codebox"><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">file [-bcLvz][-f &lt;名称文件&gt;][-m &lt;魔法数字文件&gt;...][文件或目录...]</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>

<p><strong>参数</strong>：</p>
<ul>
<li>-b 　列出辨识结果时，不显示文件名称。</li>
<li>-c 　详细显示指令执行过程，便于排错或分析程序执行的情形。</li>
<li>-f&lt;名称文件&gt; 　指定名称文件，其内容有一个或多个文件名称时，让file依序辨识这些文件，格式为每列一个文件名称。</li>
<li>-L 　直接显示符号连接所指向的文件的类别。</li>
<li>-m&lt;魔法数字文件&gt; 　指定魔法数字文件。</li>
<li>-v 　显示版本信息。</li>
<li>-z 　尝试去解读压缩文件的内容。</li>
<li>[文件或目录…] 要确定类型的文件列表，多个文件之间使用空格分开，可以使用shell通配符匹配多个文件。</li>
</ul>
<p>实例</p>
<div class="code-container" code-lang="Bash"><div class="codebox"><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# file install.log</span><br><span class="line">install.log: UTF-8 Unicode text</span><br><span class="line"></span><br><span class="line">[root@localhost ~]# file -b install.log      &lt;== 不显示文件名称</span><br><span class="line">UTF-8 Unicode text</span><br><span class="line"></span><br><span class="line">[root@localhost ~]# file -i install.log      &lt;== 显示MIME类别。</span><br><span class="line">install.log: text/plain; charset=utf-8</span><br><span class="line"></span><br><span class="line">[root@localhost ~]# file -b -i install.log</span><br><span class="line">text/plain; charset=utf-8</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>

<p>显示符号链接的文件类型</p>
<div class="code-container" code-lang="Bash"><div class="codebox"><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# <span class="built_in">ls</span> -l /var/mail</span><br><span class="line">lrwxrwxrwx 1 root root 10 08-13 00:11 /var/mail -&gt; spool/mail</span><br><span class="line"></span><br><span class="line">[root@localhost ~]# file /var/mail</span><br><span class="line">/var/mail: symbolic <span class="built_in">link</span> to `spool/mail<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[root@localhost ~]# file -L /var/mail</span></span><br><span class="line"><span class="string">/var/mail: directory</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[root@localhost ~]# file /var/spool/mail</span></span><br><span class="line"><span class="string">/var/spool/mail: directory</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[root@localhost ~]# file -L /var/spool/mail</span></span><br><span class="line"><span class="string">/var/spool/mail: directory</span></span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>



<p>我感觉主要判断类型有这两个方法就够了，这两个不行其他方法估计也不行</p>
<h3 id="2-磁盘分区"><a href="#2-磁盘分区" class="headerlink" title="2.磁盘分区"></a>2.磁盘分区</h3><p>磁盘取证，那文件肯定是一个磁盘，下次遇见不能判断的文件类型，直接猜是磁盘直接尝试</p>
<p><strong>文件系统</strong></p>
<p>windows主流为FAT和NEFS（FAT12 -&gt; FAT16 -&gt; FAT32 -&gt; NTFS），linux常见文件系统为Ext2、Ext3、Ext4（EXT2 -&gt; EXT3 -&gt; EXT4)这些可以在进行文件类型判断的时候顺便知道</p>
<img lazyload src="/assets/images/Meow-Loading.webp" data-lazy-src="/2025/12/16/%E7%94%B5%E5%AD%90%E5%8F%96%E8%AF%81/image-20251217194551894.png" class title="image-20251217194551894">

<p>FAT：文件分配表，记录文件所在位置的表格。FAT文件系统用“簇”作为数据单元，用户文件和目录都存储在簇中。</p>
<p>NTFS：新技术文件系统，是WindowsNT环境的文件系统，一个日志文件系统，保存磁盘写入信息外还会对所有改变保留一份日志。</p>
<p><strong>比较</strong>：NTFS能够很快恢复正常，且不易丢失数据，替代了老式的FAT文件系统。</p>
<p>Ext：Linux扩展文件系统。Ext2被称作索引是文件系统，Ext3&#x2F;Ext4被称作日志文件系统</p>
<p>CTF中往往会拿到一个无扩展名或者是和文件系统相关扩展名的文件，可以先通过Linux的file命令或者windows的TrIDNet工具识别文件类型，若是磁盘镜像，基本就是磁盘取证了</p>
<p><strong>文件恢复</strong></p>
<p>早在之前写Misc的时候就遇到过文件恢复，可惜当时甚至都不知道这考的是取证。</p>
<p><strong>1.Windows文件恢复</strong></p>
<p>在恢复文件之前我们需要先将磁盘镜像文件进行挂载</p>
<p>Windwos系统中我使用的是DisGenius</p>
<p>我没有题目就只能抄一下大佬的博客了</p>
<p>先进行挂载</p>
<img lazyload src="/assets/images/Meow-Loading.webp" data-lazy-src="/2025/12/16/%E7%94%B5%E5%AD%90%E5%8F%96%E8%AF%81/image-20240926002430189.png" class title="image-20240926002430189">

<p>然后直接恢复文件，我们可以去查看镜像磁盘然后对着目标文件直接恢复即可</p>
<img lazyload src="/assets/images/Meow-Loading.webp" data-lazy-src="/2025/12/16/%E7%94%B5%E5%AD%90%E5%8F%96%E8%AF%81/image-20240926002449430.png" class title="image-20240926002449430">

<p>恢复结果</p>
<img lazyload src="/assets/images/Meow-Loading.webp" data-lazy-src="/2025/12/16/%E7%94%B5%E5%AD%90%E5%8F%96%E8%AF%81/image-20240926002512057.png" class title="image-20240926002512057">



<p><strong>2.Linux文件恢复</strong></p>
<p>Linux系统就没有像Windows系统那么号的图形化界面，我们只能使用命令行进行操作</p>
<p>Linux挂载</p>
<div class="code-container" code-lang="Bash"><div class="codebox"><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> mount 文件名 自定义目录		<span class="comment">#挂载镜像</span></span><br><span class="line"><span class="built_in">sudo</span> umount  文件名 			<span class="comment">#取消挂载</span></span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>

<p>然后挂载的镜像就会加载到指定的目录</p>
<img lazyload src="/assets/images/Meow-Loading.webp" data-lazy-src="/2025/12/16/%E7%94%B5%E5%AD%90%E5%8F%96%E8%AF%81/image-20251217202101564.png" class title="image-20251217202101564">

<p>我们在该目录下发现了加载的文件</p>
<img lazyload src="/assets/images/Meow-Loading.webp" data-lazy-src="/2025/12/16/%E7%94%B5%E5%AD%90%E5%8F%96%E8%AF%81/image-20251217202143286.png" class title="image-20251217202143286">

<p>然后取消挂载其中文件也会删除，mount命令有点多，我感觉只会这两个我就够了</p>
<p><strong>Linux文件恢复</strong></p>
<p>主要的恢复工具有ext3grep和extundelete，其中ext3grep主要负责ext3文件系统的恢复，然后extundelete适配ext3和ext4，extundelete更加现代和方便，于是每次都优先使用extundelete</p>
<p><strong>extundelete</strong></p>
<p>专门针对 <strong>ext3 &#x2F; ext4</strong></p>
<p><strong>基于 Journal（日志）恢复</strong></p>
<p>能恢复：</p>
<ul>
<li>已删除文件</li>
<li>已删除目录</li>
<li>整个分区所有可恢复内容</li>
</ul>
<p>由于是基于日志的恢复，如果没有Journal就需要使用ext3grep</p>
<p>适用场景：</p>
<ul>
<li>flag 文件被 <code>rm</code> 删除</li>
<li>文件名还在，但内容没了</li>
<li>分区还能正常挂载</li>
<li>journal 仍存在</li>
</ul>
<p>实例</p>
<div class="code-container" code-lang="Bash"><div class="codebox"><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 卸载镜像  我们在恢复的时候可以使用分区，也就是我们挂载镜像的目录，这次储存着文件的数据，也可以直接使用镜像文件</span></span><br><span class="line"><span class="built_in">sudo</span> umount /dev/sdb1</span><br><span class="line"><span class="comment"># 查看可恢复的inode 2代表的是根目录，后面不同的数字代表其中的文件，每次使用2就会显示目录下的全部文件</span></span><br><span class="line"><span class="built_in">sudo</span> extundelete /dev/sdb1 --inode 2</span><br><span class="line"><span class="comment"># 恢复单个文件 我们可以使用inode标号也可以使用文件路径，这个文件路径是被删除文件之前的路径可以在查看文件时看到，路径不能写错也不需要前面带根目录</span></span><br><span class="line"><span class="built_in">sudo</span> extundelete /dev/sdb1 --restore-file home/kali/flag.txt</span><br><span class="line"><span class="comment"># 恢复整个目录 恢复的文件会出现在 RECOVERED_FILES/</span></span><br><span class="line"><span class="built_in">sudo</span> extundelete /dev/sdb1 --restore-all</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>

<p>看了实例，感觉还是直接使用镜像文件进行恢复，恢复的时候直接传inode标号比较方便</p>
<p><strong>ext3grep</strong></p>
<ul>
<li><strong>更底层的 inode &#x2F; block 扫描工具</strong></li>
<li>主要针对 <strong>ext3</strong></li>
<li>可以不依赖 journal（一定程度）</li>
</ul>
<p>适用场景：</p>
<ul>
<li>extundelete 无法恢复</li>
<li>journal 被破坏</li>
<li>文件名丢失也无所谓（只要内容）</li>
</ul>
<p>实例</p>
<div class="code-container" code-lang="Bash"><div class="codebox"><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 卸载镜像</span></span><br><span class="line"><span class="built_in">sudo</span> umount /dev/sdb1</span><br><span class="line"><span class="comment"># 扫描超级块</span></span><br><span class="line"><span class="built_in">sudo</span> ext3grep /dev/sdb1 --superblock</span><br><span class="line"><span class="comment"># 恢复所有可恢复项</span></span><br><span class="line"><span class="built_in">sudo</span> ext3grep /dev/sdb1 --restore-all</span><br><span class="line"><span class="comment"># 恢复指定inode</span></span><br><span class="line"><span class="built_in">sudo</span> ext3grep /dev/sdb1 --restore-inode 12345</span><br><span class="line"><span class="comment"># 恢复文件也是一般存放在 RESTORED_FILES/</span></span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>

<p>✅ 优点：</p>
<ul>
<li>比 extundelete 更“野”</li>
<li>在 journal 失效时仍可能成功</li>
</ul>
<p>❌ 缺点：</p>
<ul>
<li>恢复文件名不友好</li>
<li>ext4 支持不完整</li>
<li>输出杂乱，需要人工筛选</li>
</ul>
<p>两个的对比</p>
<div class="table-container"><table>
<thead>
<tr>
<th>对比项</th>
<th>extundelete</th>
<th>ext3grep</th>
</tr>
</thead>
<tbody><tr>
<td>支持 FS</td>
<td>ext3 &#x2F; ext4</td>
<td>ext3（ext4 部分）</td>
</tr>
<tr>
<td>是否依赖 journal</td>
<td>是</td>
<td>不完全</td>
</tr>
<tr>
<td>文件名恢复</td>
<td>✅ 好</td>
<td>❌ 差</td>
</tr>
<tr>
<td>目录结构</td>
<td>✅</td>
<td>❌</td>
</tr>
<tr>
<td>CTF 推荐度</td>
<td>⭐⭐⭐⭐⭐</td>
<td>⭐⭐⭐</td>
</tr>
</tbody></table></div>
<p>总之就是extundelete比ext3grep好用，但是ext3grep不需要journal，可以把所有数据都恢复，所以会是乱的需要我们自己筛选，做题的时候，就先尝试extundelete失败了再使用ext3grep，两个都失败就算了</p>
<h2 id="内存取证"><a href="#内存取证" class="headerlink" title="内存取证"></a>内存取证</h2><p>看完了磁盘取证，原来电脑中已经删除了的数据是这么恢复的，现在就到了我们最常考的内存取证了</p>
<p>内存取证通常是指对计算机等智能设备运行时内存中存储的临时数据进行获取与分析，提取有价值的数据</p>
<p>在CTF比赛中，内存取证往往是提供一个完整的内存镜像，所以说看到提供的附件很大，就可以直接判断是内存取证了</p>
<h3 id="1-volatility"><a href="#1-volatility" class="headerlink" title="1.volatility"></a>1.volatility</h3><p>虽然现在我们内存取证有我们的lovelymen有时候直接一把梭，但是我觉得还是要想流量分析一样，不能只是依靠工具一把梭哈，而是要了解一下原理</p>
<p>下载地址<a target="_blank" rel="noopener" href="https://github.com/volatilityfoundation/volatility3?tab=readme-ov-file">GitHub - volatilityfoundation&#x2F;volatility3: Volatility 3.0 开发 — GitHub - volatilityfoundation&#x2F;volatility3: Volatility 3.0 development</a>这个应该是Wiondows和Linux系统都可以使用的，但是鉴于编码问题和一些命令还是Linux方便一点还是推荐在Linux系统中使用</p>
<p>我使用的是volatitlity3，不用2纯粹感觉有最新版为什么要用老的，而且lovelymen里面也内置了2</p>
<p>当遇到扩展名为raw、img、dmp、vmem等时，就可以直接开始使用进行内存取证了</p>
<p><strong>安装</strong></p>
<p>感觉github这个比以前的都方便安装一点了，下载好压缩包解压后直接下载依赖项就可以了</p>
<div class="code-container" code-lang="Bash"><div class="codebox"><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install --user -e <span class="string">&quot;.[full]&quot;</span></span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>





<p><strong>命令格式</strong></p>
<div class="code-container" code-lang="Bash"><div class="codebox"><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatility -f [image] --profile=[profile] [plugin]</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>

<p><strong>这里需要注意 ：<code>Volatility3</code>和<code>Volatility2</code>用法差不多，但不需要指定<code>profile</code> ，只是插件调用方式改变，特定的操作系统有特定的插件</strong></p>
<p>我们直接输入<code>python vol.py -h</code>即可查看到可用参数和插件</p>
<p>常用参数</p>
<div class="code-container" code-lang="Bash"><div class="codebox"><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">可选参数:</span><br><span class="line">  -h, --<span class="built_in">help</span>            显示此帮助信息并退出，查看特定插件的选项使用 <span class="string">&#x27;vol.py &lt;插件名&gt; --help&#x27;</span></span><br><span class="line">  -c CONFIG, --config CONFIG</span><br><span class="line">                        从JSON文件加载配置</span><br><span class="line">  --parallelism [&#123;processes,threads,off&#125;]</span><br><span class="line">                        启用并行处理（如果未提供参数，则默认为关闭）</span><br><span class="line">  -e EXTEND, --extend EXTEND</span><br><span class="line">                        使用新的（或更改的）设置扩展配置</span><br><span class="line">  -p PLUGIN_DIRS, --plugin-dirs PLUGIN_DIRS</span><br><span class="line">                        用于查找插件的路径列表，以分号分隔</span><br><span class="line">  -s SYMBOL_DIRS, --symbol-dirs SYMBOL_DIRS</span><br><span class="line">                        用于查找符号文件的路径列表，以分号分隔</span><br><span class="line">  -v, --verbosity       增加输出详细程度</span><br><span class="line">  -l LOG, --<span class="built_in">log</span> LOG     将输出记录到文件和控制台</span><br><span class="line">  -o OUTPUT_DIR, --output-dir OUTPUT_DIR</span><br><span class="line">                        输出生成的文件的目录</span><br><span class="line">  -q, --quiet           移除进度反馈</span><br><span class="line">  -r RENDERER, --renderer RENDERER</span><br><span class="line">                        确定如何渲染输出（quick, none, csv, pretty, json, jsonl）</span><br><span class="line">  -f FILE, --file FILE  如果未定义single-location，则作为--single-location=file://的简写</span><br><span class="line">  --write-config        将配置JSON文件写出到config.json</span><br><span class="line">  --save-config SAVE_CONFIG</span><br><span class="line">                        将配置JSON文件保存到文件</span><br><span class="line">  --clear-cache         清除所有短期缓存项目</span><br><span class="line">  --cache-path CACHE_PATH</span><br><span class="line">                        更改用于存储缓存的默认路径（C:\Users\misaki\AppData\Roaming\volatility3）</span><br><span class="line">  --offline             不搜索在线JSON文件</span><br><span class="line">  -u URL, --remote-isf-url URL</span><br><span class="line">                        在线搜索ISF JSON文件</span><br><span class="line">  --filters FILTERS     应用于输出的过滤器列表（格式为[+-]列名,模式[!]）</span><br><span class="line">  --hide-columns [HIDE_COLUMNS ...]</span><br><span class="line">                        不区分大小写的空格分隔前缀列表，用于确定输出中隐藏哪些列（如果提供）</span><br><span class="line">  --single-location SINGLE_LOCATION</span><br><span class="line">                        指定要在其上堆叠的基础位置</span><br><span class="line">  --stackers [STACKERS ...]</span><br><span class="line">                        堆叠器列表</span><br><span class="line">  --single-swap-locations [SINGLE_SWAP_LOCATIONS ...]</span><br><span class="line">                        指定与single-location一起使用的交换层URI列表</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>



<p>常见插件</p>
<div class="code-container" code-lang="Bash"><div class="codebox"><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br></pre></td><td class="code"><pre><span class="line">Volatility 3 插件中文说明</span><br><span class="line"></span><br><span class="line">核心插件 (Core Plugins)</span><br><span class="line">- banners.Banners - 尝试识别镜像中的潜在Linux系统信息横幅</span><br><span class="line">- configwriter.ConfigWriter - 运行自动化检测并输出配置文件到输出目录</span><br><span class="line">- frameworkinfo.FrameworkInfo - 列出Volatility的各种模块化组件</span><br><span class="line">- isfinfo.IsfInfo - 确定当前可用ISF文件的信息或特定ISF文件的信息</span><br><span class="line">- layerwriter.LayerWriter - 运行自动化检测并写出堆栈器生成的主层</span><br><span class="line"></span><br><span class="line">Linux 插件</span><br><span class="line"></span><br><span class="line">基本信息收集</span><br><span class="line">- linux.bash.Bash - 从内存中恢复bash命令历史</span><br><span class="line">- linux.boottime.Boottime - 显示系统启动时间</span><br><span class="line">- linux.capabilities.Capabilities - 列出进程权限</span><br><span class="line">- linux.elfs.Elfs - 列出所有进程的内存映射ELF文件</span><br><span class="line">- linux.envars.Envars - 列出进程及其环境变量</span><br><span class="line">- linux.kallsyms.Kallsyms - 内核符号枚举插件</span><br><span class="line">- linux.kmsg.Kmsg - 内核日志缓冲区读取器</span><br><span class="line">- linux.lsmod.Lsmod - 列出已加载的内核模块</span><br><span class="line">- linux.mountinfo.MountInfo - 列出进程挂载命名空间的挂载点</span><br><span class="line">- linux.vmcoreinfo.VMCoreInfo - 枚举VMCoreInfo表</span><br><span class="line"></span><br><span class="line">进程管理</span><br><span class="line">- linux.pidhashtable.PIDHashTable - 通过PID哈希表枚举进程</span><br><span class="line">- linux.proc.Maps - 列出所有进程的所有内存映射</span><br><span class="line">- linux.psaux.PsAux - 列出进程及其命令行参数</span><br><span class="line">- linux.pscallstack.PsCallStack - 枚举每个任务的调用栈</span><br><span class="line">- linux.pslist.PsList - 列出特定Linux内存镜像中的进程</span><br><span class="line">- linux.psscan.PsScan - 扫描特定Linux镜像中的进程</span><br><span class="line">- linux.pstree.PsTree - 基于父进程ID以树形结构列出进程的插件</span><br><span class="line">- linux.ptrace.Ptrace - 枚举ptrace的追踪者和被追踪任务</span><br><span class="line"></span><br><span class="line">网络相关</span><br><span class="line">- linux.ip.Addr - 列出所有设备的网络接口信息</span><br><span class="line">- linux.ip.Link - 列出网络接口信息，类似于`ip <span class="built_in">link</span> show`</span><br><span class="line">- linux.netfilter.Netfilter - 列出Netfilter钩子</span><br><span class="line">- linux.sockstat.Sockstat - 列出所有进程的所有网络连接</span><br><span class="line"></span><br><span class="line">内核与系统检查</span><br><span class="line">- linux.check_afinfo.Check_afinfo - 验证网络协议操作函数指针</span><br><span class="line">- linux.check_creds.Check_creds - 检查是否有进程共享凭证结构</span><br><span class="line">- linux.check_idt.Check_idt - 检查IDT是否被修改</span><br><span class="line">- linux.check_modules.Check_modules - 比较模块列表与sysfs信息（如果可用）</span><br><span class="line">- linux.check_syscall.Check_syscall - 检查系统调用表中的钩子</span><br><span class="line">- linux.hidden_modules.Hidden_modules - 从内存中挖掘查找隐藏的内核模块</span><br><span class="line">- linux.iomem.IOMem - 生成类似于运行系统中`/proc/iomem`的输出</span><br><span class="line"></span><br><span class="line">内存与文件分析</span><br><span class="line">- linux.pagecache.Files - 从内存中列出文件</span><br><span class="line">- linux.pagecache.InodePages - 列出并恢复缓存的inode页面</span><br><span class="line">- linux.pagecache.RecoverFs - 将缓存的文件系统（目录、文件、符号链接）恢复到压缩的tar包中</span><br><span class="line">- linux.lsof.Lsof - 列出每个进程打开的文件</span><br><span class="line">- linux.library_list.LibraryList - 枚举加载到进程中的库</span><br><span class="line"></span><br><span class="line">内核线程与事件</span><br><span class="line">- linux.ebpf.EBPF - 枚举eBPF程序</span><br><span class="line">- linux.graphics.fbdev.Fbdev - 从fbdev图形子系统中提取帧缓冲区</span><br><span class="line">- linux.keyboard_notifiers.Keyboard_notifiers - 解析键盘通知器调用链</span><br><span class="line">- linux.kthreads.Kthreads - 枚举内核线程函数</span><br><span class="line">- linux.module_extract.ModuleExtract - 从内核中的特定地址重新创建ELF文件</span><br><span class="line">- linux.modxview.Modxview - 集中lsmod、check_modules和hidden_modules结果，高效发现模块存在和污染</span><br><span class="line"></span><br><span class="line">调试与追踪</span><br><span class="line">- linux.tracing.ftrace.CheckFtrace - 检测ftrace钩子</span><br><span class="line">- linux.tracing.perf_events.PerfEvents - 列出每个进程的性能事件</span><br><span class="line">- linux.tracing.tracepoints.CheckTracepoints - 检测跟踪点钩子</span><br><span class="line">- linux.tty_check.tty_check - 检查<span class="built_in">tty</span>设备是否被挂钩</span><br><span class="line"></span><br><span class="line">内存扫描</span><br><span class="line">- linux.malfind.Malfind - 列出可能包含注入代码的进程内存范围</span><br><span class="line">- linux.vmaregexscan.VmaRegExScan - 使用正则表达式扫描任务的所有虚拟内存区域</span><br><span class="line">- linux.vmayarascan.VmaYaraScan - 使用Yara规则扫描任务的所有虚拟内存区域</span><br><span class="line"></span><br><span class="line">macOS 插件</span><br><span class="line"></span><br><span class="line">基本信息收集</span><br><span class="line">- mac.bash.Bash - 从内存中恢复bash命令历史</span><br><span class="line">- mac.dmesg.Dmesg - 打印内核日志缓冲区</span><br><span class="line">- mac.ifconfig.Ifconfig - 列出所有设备的网络接口信息</span><br><span class="line">- mac.lsmod.Lsmod - 列出已加载的内核模块</span><br><span class="line">- mac.mount.Mount - 包含一组插件的模块，产生通常在Mac的mount命令中找到的数据</span><br><span class="line"></span><br><span class="line">进程管理</span><br><span class="line">- mac.list_files.List_Files - 列出所有进程的所有打开文件描述符</span><br><span class="line">- mac.lsof.Lsof - 列出所有进程的所有打开文件描述符</span><br><span class="line">- mac.psaux.Psaux - 恢复程序命令行参数</span><br><span class="line">- mac.pslist.PsList - 列出特定mac内存镜像中的进程</span><br><span class="line">- mac.pstree.PsTree - 基于父进程ID以树形结构列出进程的插件</span><br><span class="line"></span><br><span class="line">网络相关</span><br><span class="line">- mac.netstat.Netstat - 列出所有进程的所有网络连接</span><br><span class="line"></span><br><span class="line">内核与安全检查</span><br><span class="line">- mac.check_syscall.Check_syscall - 检查系统调用表中的钩子</span><br><span class="line">- mac.check_sysctl.Check_sysctl - 检查sysctl处理程序中的钩子</span><br><span class="line">- mac.check_trap_table.Check_trap_table - 检查Mach陷阱表中的钩子</span><br><span class="line">- mac.kauth_listeners.Kauth_listeners - 列出kauth监听器及其状态</span><br><span class="line">- mac.kauth_scopes.Kauth_scopes - 列出kauth作用域及其状态</span><br><span class="line">- mac.socket_filters.Socket_filters - 枚举内核套接字过滤器</span><br><span class="line">- mac.trustedbsd.Trustedbsd - 检查恶意trustedbsd模块</span><br><span class="line">- mac.vfsevents.VFSevents - 列出正在过滤文件系统事件的进程</span><br><span class="line"></span><br><span class="line">内存与事件分析</span><br><span class="line">- mac.kevents.Kevents - 列出进程注册的事件处理程序</span><br><span class="line">- mac.malfind.Malfind - 列出可能包含注入代码的进程内存范围</span><br><span class="line">- mac.proc_maps.Maps - 列出可能包含注入代码的进程内存范围</span><br><span class="line">- mac.timers.Timers - 检查恶意内核定时器</span><br><span class="line"></span><br><span class="line">Windows 插件</span><br><span class="line"></span><br><span class="line">基本信息收集</span><br><span class="line">- windows.info.Info - 显示正在分析的内存样本的操作系统和内核详细信息</span><br><span class="line">- windows.statistics.Statistics - 列出关于内存空间的统计信息</span><br><span class="line">- windows.crashinfo.Crashinfo - 列出Windows崩溃转储的信息</span><br><span class="line"></span><br><span class="line">进程管理</span><br><span class="line">- windows.pslist.PsList - 列出特定Windows内存镜像中的进程</span><br><span class="line">- windows.psscan.PsScan - 扫描特定Windows内存镜像中的进程</span><br><span class="line">- windows.pstree.PsTree - 基于父进程ID以树形结构列出进程的插件</span><br><span class="line">- windows.psxview.PsXView - 列出通过《内存取证艺术》中描述的四种方法找到的所有进程，有助于识别试图隐藏自身的进程</span><br><span class="line">- windows.threads.Threads - 列出进程线程</span><br><span class="line"></span><br><span class="line">进程详细信息</span><br><span class="line">- windows.cmdline.CmdLine - 列出进程命令行参数</span><br><span class="line">- windows.envars.Envars - 显示进程环境变量</span><br><span class="line">- windows.getsids.GetSIDs - 打印拥有每个进程的SID</span><br><span class="line">- windows.getservicesids.GetServiceSIDs - 列出进程令牌SID</span><br><span class="line">- windows.privileges.Privs - 列出进程令牌权限</span><br><span class="line">- windows.sessions.Sessions - 列出从环境变量中提取会话信息的进程</span><br><span class="line"></span><br><span class="line">DLL与模块管理</span><br><span class="line">- windows.dlllist.DllList - 列出特定Windows内存镜像中加载的DLL</span><br><span class="line">- windows.ldrmodules.LdrModules - 列出特定Windows内存镜像中加载的模块</span><br><span class="line">- windows.modules.Modules - 列出已加载的内核模块</span><br><span class="line">- windows.unloadedmodules.UnloadedModules - 列出已卸载的内核模块</span><br><span class="line"></span><br><span class="line">内存分析</span><br><span class="line">- windows.memmap.Memmap - 打印内存映射</span><br><span class="line">- windows.vadinfo.VadInfo - 列出进程内存范围</span><br><span class="line">- windows.vadwalk.VadWalk - 遍历VAD树</span><br><span class="line">- windows.virtmap.VirtMap - 列出虚拟映射部分</span><br><span class="line"></span><br><span class="line">文件系统分析</span><br><span class="line">- windows.filescan.FileScan - 扫描特定Windows内存镜像中的文件对象</span><br><span class="line">- windows.dumpfiles.DumpFiles - 从Windows内存样本中导出缓存的文件内容</span><br><span class="line">- windows.mftscan.MFTScan - 扫描特定Windows内存镜像中的MFT FILE对象</span><br><span class="line">- windows.mftscan.ADS - 扫描备用数据流</span><br><span class="line">- windows.mftscan.ResidentData - 扫描包含常驻数据的MFT记录</span><br><span class="line"></span><br><span class="line">网络分析</span><br><span class="line">- windows.netscan.NetScan - 扫描特定Windows内存镜像中的网络对象</span><br><span class="line">- windows.netstat.NetStat - 遍历特定Windows内存镜像中的网络跟踪结构</span><br><span class="line"></span><br><span class="line">注册表分析</span><br><span class="line">- windows.registry.hivelist.HiveList - 列出特定内存镜像中的注册表配置单元</span><br><span class="line">- windows.registry.hivescan.HiveScan - 扫描特定Windows内存镜像中的注册表配置单元</span><br><span class="line">- windows.registry.printkey.PrintKey - 列出配置单元或特定键值下的注册表键</span><br><span class="line">- windows.registry.userassist.UserAssist - 打印userassist注册表键和信息</span><br><span class="line">- windows.registry.certificates.Certificates - 列出注册表证书存储中的证书</span><br><span class="line"></span><br><span class="line">驱动与设备</span><br><span class="line">- windows.devicetree.DeviceTree - 基于特定Windows内存镜像中的驱动程序和附加设备列出树形结构</span><br><span class="line">- windows.drivermodule.DriverModule - 确定是否有任何加载的驱动程序被rootkit隐藏</span><br><span class="line">- windows.driverscan.DriverScan - 扫描特定Windows内存镜像中的驱动程序</span><br><span class="line">- windows.driverirp.DriverIrp - 列出特定Windows内存镜像中驱动程序的IRP</span><br><span class="line">- windows.modscan.ModScan - 扫描特定Windows内存镜像中的模块</span><br><span class="line"></span><br><span class="line">服务分析</span><br><span class="line">- windows.svcscan.SvcScan - 扫描Windows服务</span><br><span class="line">- windows.svclist.SvcList - 列出services.exe双链表中包含的服务</span><br><span class="line">- windows.svcdiff.SvcDiff - 比较通过列表遍历和扫描找到的服务以发现rootkit</span><br><span class="line"></span><br><span class="line">安全检查</span><br><span class="line">- windows.malfind.Malfind - 列出可能包含注入代码的进程内存范围</span><br><span class="line">- windows.callbacks.Callbacks - 列出内核回调和通知例程</span><br><span class="line">- windows.ssdt.SSDT - 列出系统调用表</span><br><span class="line">- windows.hollowprocesses.HollowProcesses - 列出被掏空的进程</span><br><span class="line">- windows.processghosting.ProcessGhosting - 列出DeletePending位被设置或FILE_OBJECT设置为0或Vads被标记为DeleteOnClose的进程</span><br><span class="line">- windows.skeleton_key_check.Skeleton_Key_Check - 查找Skeleton Key恶意软件的迹象</span><br><span class="line"></span><br><span class="line">密码与哈希提取</span><br><span class="line">- windows.hashdump.Hashdump - 从内存中导出用户哈希（已弃用）</span><br><span class="line">- windows.lsadump.Lsadump - 从内存中导出LSA机密信息（已弃用）</span><br><span class="line">- windows.cachedump.Cachedump - 从内存中导出LSA机密信息（已弃用）</span><br><span class="line">- windows.registry.hashdump.Hashdump - 从内存中导出用户哈希</span><br><span class="line">- windows.registry.lsadump.Lsadump - 从内存中导出LSA机密信息</span><br><span class="line">- windows.registry.cachedump.Cachedump - 从内存中导出LSA机密信息</span><br><span class="line"></span><br><span class="line">应用缓存与执行历史</span><br><span class="line">- windows.amcache.Amcache - 从AmCache中提取已执行应用程序的信息（已弃用）</span><br><span class="line">- windows.registry.amcache.Amcache - 从AmCache中提取已执行应用程序的信息</span><br><span class="line">- windows.shimcachemem.ShimcacheMem - 从ahcache.sys AVL树中读取Shimcache条目</span><br><span class="line"></span><br><span class="line">用户界面相关</span><br><span class="line">- windows.windowstations.WindowStations - 扫描顶层Windows工作站</span><br><span class="line">- windows.windows.Windows - 枚举桌面实例的窗口</span><br><span class="line">- windows.desktops.Desktops - 枚举每个窗口站的桌面实例</span><br><span class="line">- windows.deskscan.DeskScan - 扫描每个窗口站的桌面实例</span><br><span class="line">- windows.consoles.Consoles - 查找Windows控制台缓冲区</span><br><span class="line"></span><br><span class="line">计划任务</span><br><span class="line">- windows.scheduled_tasks.ScheduledTasks - 从Windows注册表中解码计划任务信息，包括触发器、操作、运行时间和创建时间的信息（已弃用）</span><br><span class="line">- windows.registry.scheduled_tasks.ScheduledTasks - 从Windows注册表中解码计划任务信息，包括触发器、操作、运行时间和创建时间的信息</span><br><span class="line"></span><br><span class="line">句柄与对象</span><br><span class="line">- windows.handles.Handles - 列出进程打开的句柄</span><br><span class="line">- windows.mutantscan.MutantScan - 扫描特定Windows内存镜像中的互斥体</span><br><span class="line">- windows.symlinkscan.SymlinkScan - 扫描特定Windows内存镜像中的链接</span><br><span class="line">- windows.thrdscan.ThrdScan - 扫描Windows线程</span><br><span class="line"></span><br><span class="line">系统调用与API</span><br><span class="line">- windows.direct_system_calls.DirectSystemCalls - 检测用于绕过EDR的直接系统调用技术</span><br><span class="line">- windows.indirect_system_calls.IndirectSystemCalls - 间接系统调用检测</span><br><span class="line">- windows.unhooked_system_calls.unhooked_system_calls - 查找Skeleton Key恶意软件的迹象（注意：此描述可能有误，应为检测未挂钩的系统调用）</span><br><span class="line"></span><br><span class="line">其他安全检测</span><br><span class="line">- windows.etwpatch.EtwPatch - 识别恶意软件用于逃避检测的ETW（Windows事件追踪）修补技术</span><br><span class="line">- windows.registry.getcellroutine.GetCellRoutine - 报告具有挂钩GetCellRoutine处理程序的注册表配置单元</span><br><span class="line"></span><br><span class="line">调试相关</span><br><span class="line">- windows.debugregisters.DebugRegisters - 列出调试寄存器信息</span><br><span class="line">- windows.suspended_threads.SuspendedThreads - 枚举挂起的线程</span><br><span class="line"></span><br><span class="line">PE文件分析</span><br><span class="line">- windows.iat.IAT - 提取导入地址表以列出程序使用的外部库中的API（函数）</span><br><span class="line">- windows.pedump.PEDump - 允许从特定地址空间的特定地址提取PE文件</span><br><span class="line">- windows.pe_symbols.PESymbols - 打印进程和内核内存中PE文件的符号</span><br><span class="line">- windows.verinfo.VerInfo - 列出PE文件中的版本信息</span><br><span class="line"></span><br><span class="line">内核结构</span><br><span class="line">- windows.kpcrs.KPCRs - 为每个处理器打印KPCR结构</span><br><span class="line">- windows.timers.Timers - 打印内核定时器和相关的模块DPC</span><br><span class="line">- windows.joblinks.JobLinks - 打印进程作业链接信息</span><br><span class="line">- windows.bigpools.BigPools - 列出大页面池</span><br><span class="line"></span><br><span class="line">命令历史</span><br><span class="line">- windows.cmdscan.CmdScan - 查找Windows命令历史列表</span><br><span class="line"></span><br><span class="line">磁盘与存储</span><br><span class="line">- windows.mbrscan.MBRScan - 扫描并解析潜在的主引导记录（MBR）</span><br><span class="line">- windows.truecrypt.Passphrase - TrueCrypt缓存密码查找器</span><br><span class="line"></span><br><span class="line">扫描插件</span><br><span class="line">- windows.poolscanner.PoolScanner - 通用池扫描插件</span><br><span class="line"></span><br><span class="line">通用插件</span><br><span class="line"></span><br><span class="line">- regexscan.RegExScan - 使用正则表达式模式扫描内核内存</span><br><span class="line">- yarascan.YaraScan - 使用yara规则（字符串或文件）扫描内核内存</span><br><span class="line">- timeliner.Timeliner - 运行所有提供时间相关信息的插件，并按时间排序结果</span><br><span class="line">- vmscan.Vmscan - 扫描Intel VT-d结构并为它们生成VM volatility配置</span><br><span class="line">- windows.strings.Strings - 读取strings命令的输出，并指示每个字符串属于哪个进程</span><br><span class="line"></span><br><span class="line">注意：标记为<span class="string">&quot;（已弃用）&quot;</span>的插件在较新版本的Volatility 3中可能有替代插件或已不再维护。</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>





<p><strong>常用命令</strong></p>
<p>常用插件命令（以当版本插件为准）</p>
<div class="table-container"><table>
<thead>
<tr>
<th>clipboard</th>
<th>提取Windows剪贴板中的内容</th>
</tr>
</thead>
<tbody><tr>
<td>cmdscan</td>
<td>提取执行的命令行历史记录（扫描_COMMAND_HISTORY信息）</td>
</tr>
<tr>
<td><strong>dumpfiles</strong></td>
<td>查看指定文件内容（导出缓存文件）</td>
</tr>
<tr>
<td>envars</td>
<td>显示进程的环境变量</td>
</tr>
<tr>
<td><strong>filescan</strong></td>
<td>提取文件对象（file objects）池信息（扫描文件）</td>
</tr>
<tr>
<td>hashdump</td>
<td>转储内存中的Windows帐户密码哈希(LM&#x2F;NTLM)</td>
</tr>
<tr>
<td><strong>imageinfo</strong></td>
<td>查看&#x2F;识别镜像信息</td>
</tr>
<tr>
<td>mimikatz</td>
<td>提取明文密码</td>
</tr>
<tr>
<td>netscan</td>
<td>查看网络连接状态</td>
</tr>
<tr>
<td>notepad</td>
<td>查看展示的记事本内容</td>
</tr>
<tr>
<td>editbox</td>
<td>查看编辑内容</td>
</tr>
<tr>
<td>pstree</td>
<td>将进程显示为树状列表</td>
</tr>
<tr>
<td>screenshot</td>
<td>获取系统在此刻的截图</td>
</tr>
</tbody></table></div>
<p>查看识别镜像信息</p>
<div class="code-container" code-lang="Bash"><div class="codebox"><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vol.py -f 文件名 windows.info.Info</span><br><span class="line">python vol.py -f Keyboard.raw windows.info.Info</span><br><span class="line"><span class="comment">#查看/识别镜像信息</span></span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>

<p>随着更新有一些命令和以前不一样了，主要还是遵循当前提供的插件</p>
<img lazyload src="/assets/images/Meow-Loading.webp" data-lazy-src="/2025/12/16/%E7%94%B5%E5%AD%90%E5%8F%96%E8%AF%81/image-20251221162233208.png" class title="image-20251221162233208">

<p>我们可以从输出信息中看见Windows版本为<code>win7sp1</code>，然后输出Is64Bit我们可以判断是64位操作系统，于是我们可以选择profile为<code>Win7SP1x64</code>，话说老版本输出有推荐profile，为什么新版本反而没有了，可能是因为这个版本好像可以自动识别profile</p>
<p>指定镜像版本并filescan扫描文件再过滤输出</p>
<div class="code-container" code-lang="Bash"><div class="codebox"><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">vol.py -f 文件名 --profile=镜像版本 windows.filescan.FileScan | grep <span class="string">&quot;文件名&quot;</span></span><br><span class="line"><span class="comment">#volality3自动识别镜像版本	</span></span><br><span class="line">vol.py -f Keyboard.raw  windows.filescan.FileScan | grep <span class="string">&quot;keyboard&quot;</span>	</span><br><span class="line"><span class="comment">#指定镜像版本并filescan扫描文件再过滤输出</span></span><br><span class="line"><span class="comment">#Windows版本</span></span><br><span class="line">python vol.py -f Keyboard.raw windows.filescan.FileScan | findstr /i <span class="string">&quot;keyboard&quot;</span></span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>

<p>我们可以通过这个命令来扫描文件，然后通过grep命令来查找关键字</p>
<img lazyload src="/assets/images/Meow-Loading.webp" data-lazy-src="/2025/12/16/%E7%94%B5%E5%AD%90%E5%8F%96%E8%AF%81/image-20251221165106300.png" class title="image-20251221165106300">

<p>我们可以看到各个文件前面有其对应的内存地址，我们只需要通过访问其地址然后导出文件即可</p>
<p>指定镜像版本并dumpfiles指定文件，指定内存中的偏移量并导出到当前文件夹下面的test目录</p>
<div class="code-container" code-lang="Bash"><div class="codebox"><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vol.py -f 文件名 -o 保存路径 windows.dumpfiles.DumpFiles --physaddr 偏移量</span><br><span class="line">python3 vol.py -f Keyboard.raw -o ./data windows.dumpfiles.DumpFiles --physaddr 0x3d700880</span><br><span class="line"><span class="comment">#指定镜像版本并dumpfiles指定文件，指定内存中的偏移量并导出到当前文件夹下面的test目录</span></span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>

<p>其中我们可以看看dumpfiles插件的参数，我们使用地址提取文件的时候virtaddr和physaddr都尝试一下</p>
<div class="code-container" code-lang="Bash"><div class="codebox"><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Volatility 3 Framework 2.26.2</span><br><span class="line">用法: vol.py windows.dumpfiles.DumpFiles [-h] [--pid PID] [--virtaddr [VIRTADDR ...]] [--physaddr [PHYSADDR ...]] [--filter FILTER]</span><br><span class="line">                                          [--ignore-case]</span><br><span class="line"></span><br><span class="line">从Windows内存样本中导出缓存的文件内容。</span><br><span class="line"></span><br><span class="line">选项:</span><br><span class="line">  -h, --<span class="built_in">help</span>            显示此帮助信息并退出</span><br><span class="line">  --pid PID             包含的进程ID（其他所有进程将被排除）</span><br><span class="line">  --virtaddr [VIRTADDR ...]</span><br><span class="line">                        导出给定虚拟地址的_FILE_OBJECTs</span><br><span class="line">  --physaddr [PHYSADDR ...]</span><br><span class="line">                        导出给定物理地址的_FILE_OBJECTs</span><br><span class="line">  --filter FILTER       导出匹配正则表达式FILTER的文件</span><br><span class="line">  --ignore-case         在过滤匹配时忽略大小写</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>



<p>这么多命令我们肯定是自己写不完了，我们还是在使用的时候再去翻一下插件和参数，反正我的想法就是直接Lovelymen梭哈</p>
<h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><h3 id="7z解压vmdk文件得到磁盘文件"><a href="#7z解压vmdk文件得到磁盘文件" class="headerlink" title="7z解压vmdk文件得到磁盘文件"></a>7z解压vmdk文件得到磁盘文件</h3><p>VMDK是VMware虚拟机的<strong>虚拟磁盘文件</strong>，它模拟了物理磁盘的完整结构：</p>
<div class="code-container" code-lang="Plaintext"><div class="codebox"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">VMDK文件</span><br><span class="line">├── 头部元数据（描述符、几何信息等）</span><br><span class="line">├── **完整的分区表**（MBR或GPT）</span><br><span class="line">│   ├── 分区1（可能是FAT/NTFS/EXT4文件系统）</span><br><span class="line">│   ├── 分区2</span><br><span class="line">│   └── ...</span><br><span class="line">└── 可能的快照数据、增量数据</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>

<p>也就是说其实VMDK文件包含了各种文件系统，我们需要根据其中的文件系统来判断出我们该如何去挂载</p>
<p>于是我们可以使用7z来将其中的文件系统解压出来，得到的也是一个可以挂载的文件</p>
<img lazyload src="/assets/images/Meow-Loading.webp" data-lazy-src="/2025/12/16/%E7%94%B5%E5%AD%90%E5%8F%96%E8%AF%81/image-20251225201523016.png" class title="image-20251225201523016">
</div><div class="post-reward"><div class="post-reward-btn" title="赞赏作者"><img src="/assets/images/svg/uc/uc-gift.svg" class="icon noview" alt="Icon"><span></span></div><div class="post-reward-content"><div class="post-reward-text"></div><div class="post-reward-list"><a href="/null" target="_blank">致谢名单</a></div></div></div><div class="post-copyright"><div class="post-copyright-info">本作品由 Regulus 于 2025-12-16 21:18:25 发布</div><div class="post-copyright-link"><span>作品地址：<a href="http://example.com/2025/12/16/%E7%94%B5%E5%AD%90%E5%8F%96%E8%AF%81/">电子取证</a></span><button class="copy-text" type="button" data-text="http://example.com/2025/12/16/%E7%94%B5%E5%AD%90%E5%8F%96%E8%AF%81/">复制</button></div><div class="post-copyright-detail">除特别声明外，本站作品均采用 <a href='https://creativecommons.org/licenses/by-nc-sa/4.0/' title='Attribution-NonCommercial-ShareAlike' target='_blank'>CC BY-NC-SA 4.0</a> 许可协议，转载请注明来自 <a href='/'>Mei的小窝</a></div><img class="post-copyright-icon noview" src="/assets/images/Hexo-Theme-MEOW.png" alt="Logo"/></div><div class="post-tail-tags"></div></div><aside id="post-sidebar" status="show"><div id="toc-container"><div class="toc-title"><img src="/assets/images/svg/ta/ta-toc.svg" class="icon noview" alt="Icon"><span>目录</span></div><div class="toc-content" id="toc-div"><ol class="toc-list"><li class="toc-list-item toc-list-level-1"><a class="toc-list-link" href="#%E7%94%B5%E5%AD%90%E5%8F%96%E8%AF%81"><span class="toc-list-text">电子取证</span></a><ol class="toc-list-child"><li class="toc-list-item toc-list-level-2"><a class="toc-list-link" href="#%E5%B7%A5%E5%85%B7%E4%BB%8B%E7%BB%8D"><span class="toc-list-text">工具介绍</span></a></li><li class="toc-list-item toc-list-level-2"><a class="toc-list-link" href="#%E7%A3%81%E7%9B%98%E5%8F%96%E8%AF%81"><span class="toc-list-text">磁盘取证</span></a><ol class="toc-list-child"><li class="toc-list-item toc-list-level-3"><a class="toc-list-link" href="#1-%E7%A1%AE%E8%AE%A4%E6%96%87%E4%BB%B6%E7%B1%BB%E5%9E%8B"><span class="toc-list-text">1.确认文件类型</span></a></li><li class="toc-list-item toc-list-level-3"><a class="toc-list-link" href="#2-%E7%A3%81%E7%9B%98%E5%88%86%E5%8C%BA"><span class="toc-list-text">2.磁盘分区</span></a></li></ol></li><li class="toc-list-item toc-list-level-2"><a class="toc-list-link" href="#%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81"><span class="toc-list-text">内存取证</span></a><ol class="toc-list-child"><li class="toc-list-item toc-list-level-3"><a class="toc-list-link" href="#1-volatility"><span class="toc-list-text">1.volatility</span></a></li></ol></li><li class="toc-list-item toc-list-level-2"><a class="toc-list-link" href="#%E5%85%B6%E4%BB%96"><span class="toc-list-text">其他</span></a><ol class="toc-list-child"><li class="toc-list-item toc-list-level-3"><a class="toc-list-link" href="#7z%E8%A7%A3%E5%8E%8Bvmdk%E6%96%87%E4%BB%B6%E5%BE%97%E5%88%B0%E7%A3%81%E7%9B%98%E6%96%87%E4%BB%B6"><span class="toc-list-text">7z解压vmdk文件得到磁盘文件</span></a></li></ol></li></ol></li></ol></div></div></aside></div></div><div id="toolbar" hide=""><div id="toolbar-setting-container" hide=""><div class="toolbar-item"><button id="tool-color-mode" title="深色模式" type="button"><img src="/assets/images/svg/ta/ta-moon.svg" class="icon noview" alt="Icon"></button></div><div class="toolbar-item"><button class="copy-text" id="tool-share" title="分享" type="button" data-text="http://example.com/2025/12/16/%E7%94%B5%E5%AD%90%E5%8F%96%E8%AF%81/"><img src="/assets/images/svg/ta/ta-share.svg" class="icon noview" alt="Icon"></button></div><div class="toolbar-item"><button id="tool-font-size-plus" title="放大字体" type="button"><img src="/assets/images/svg/ta/ta-text-plus.svg" class="icon noview" alt="Icon"></button></div><div class="toolbar-item"><button id="tool-font-size-minus" title="缩小字体" type="button"><img src="/assets/images/svg/ta/ta-text-minus.svg" class="icon noview" alt="Icon"></button></div></div><div class="toolbar-container"><div class="toolbar-item"><button id="tool-setting" title="设置" type="button"><img src="/assets/images/svg/ta/ta-setting.svg" class="icon noview" alt="Icon"></button></div><div class="toolbar-item"><button id="tool-toc" title="目录" type="button"><img src="/assets/images/svg/ta/ta-toc.svg" class="icon noview" alt="Icon"></button></div><div class="toolbar-item"><button id="tool-gototop" title="返回顶部" type="button"><img src="/assets/images/svg/ta/ta-up.svg" class="icon noview" alt="Icon"></button></div></div></div><div class="search-overlay"><div class="search-container"><div class="search-header"><div class="search-title"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0" /><path d="M21 21l-6 -6" /></svg>
搜索</div><div class="search-close-btn"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 21a9 9 0 0 0 9 -9a9 9 0 0 0 -9 -9a9 9 0 0 0 -9 9a9 9 0 0 0 9 9z" /><path d="M9 8l6 8" /><path d="M15 8l-6 8" /></svg></div></div><div class="search-input-box"><input id="search-input" type="search" placeholder="请输入关键词进行站内搜索……" value="" maxlength="80"/></div><div class="search-result-container"><div class="search-result-icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0" /><path d="M21 21l-6 -6" /></svg></div></div></div></div></main><footer><div class="footer"><div id="footer-copyright">© 2024 - 2026 <span>💗</span> <a href="/null">Regulus</a></div><div id="footer-info"><div id="footer-framework">🚀本站由 <a href="https://hexo.io" target="_blank">Hexo</a> & <a href="https://github.com/chanwj/hexo-theme-meow" title="3.2.0" target="_blank">Meow</a> 强力驱动</div><div id="footer-runtime"><span id="runtime" data-startdate="2024-04-02T22:16:20.000Z">🌻已稳定运行.年.月.天</span></div></div><div id="footer-statistic"><span>共撰写164篇文章，全站共409.6k字</span></div><div id="footer-pageview"><div id="container_site_pv"><span>🔥总访问量</span><span id="vercount_value_site_pv"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"  stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 6l0 -3" /><path d="M16.25 7.75l2.15 -2.15" /><path d="M18 12l3 0" /><path d="M16.25 16.25l2.15 2.15" /><path d="M12 18l0 3" /><path d="M7.75 16.25l-2.15 2.15" /><path d="M6 12l-3 0" /><path d="M7.75 7.75l-2.15 -2.15" /></svg></span></div><div id="container_site_uv"><span>🐈访客人数</span><span id="vercount_value_site_uv"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"  stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 6l0 -3" /><path d="M16.25 7.75l2.15 -2.15" /><path d="M18 12l3 0" /><path d="M16.25 16.25l2.15 2.15" /><path d="M12 18l0 3" /><path d="M7.75 16.25l-2.15 2.15" /><path d="M6 12l-3 0" /><path d="M7.75 7.75l-2.15 -2.15" /></svg></span></div></div></div></footer><div class="scripts"><script>const GLOBALCONFIG = {
  root: '/',
  toolbar: true,
  lazyload_src: '/assets/images/Meow-Loading.webp',
  friends: false,
  codeblock: true,
  share_text: '',
  onblur_title: 'Please Come Back～✧(´▽`ʃ♡ƪ)',
  mouse_click: false,
  notify:{
    enable: false,
    info: '复制成功～转载请标注本文地址',
    f12_info: '开发者模式已打开，请遵循本站版权协议'
  },
  search: {
    enable: true,
    path: 'search.json',
    local: {
      top_n_per_article: 1,
      preload: false
    }
  },
  encrypt: false,
};
</script><script>if (!localStorage.getItem('color-mode')) {
  localStorage.setItem('color-mode', 'light' || 'light');
}
document.body.setAttribute('data-mode', localStorage.getItem('color-mode'));
</script>
<script src="/js/theme/tools/utils.js"></script>

<script src="/js/plugins/dist/lazyload.min.js"></script>

<script src="/js/plugins/view-image.min.js"></script>
<script src="https://events.vercount.one/js" defer="defer"></script><script>if (localStorage.getItem('font-size')) {
  document.querySelector('.post').style.fontSize = localStorage.getItem('font-size') + 'px';
}
</script>
<script src="/js/plugins/dist/search.js"></script>

<script src="/js/main.js" type="module"></script>
</div></body></html>