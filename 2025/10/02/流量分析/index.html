<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="author" content="John Doe"/><meta name="copyright" content="John Doe"/><meta name="theme-color" content="#FFB347"/><meta name="format-detection" content="telephone=no"/><meta name="keywords" content="Hexo Theme MEOW"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="apple-touch-fullscreen" content="yes"/><meta name="application-name" content="流量分析 | Mei的小窝"/><meta name="apple-mobile-web-app-title" content="流量分析 | Mei的小窝"/><meta name="apple-mobile-web-app-status-bar-style" content="#FFB347"/><link rel="canonical" href="http://example.com/2025/10/02/流量分析/"/><meta name="description" content="流量分析做题总结不行啊，好歹是一个杂项手，但是杂项本来就杂，流量分析也是最难看懂的，总之就是收集那些特别离谱，根本没见过的流量，普通的流量分析就算了 VoIP我们先来看下VoIP是什么东西   也就是说这就是一个类似使用流量来传递语音，这也是我第一次使用wireshark的电话功能 用wireshark打开流量包然后选择电话打开VoIP通话，然后打开唯一的一段音频   可惜我的英语实在太差了...">
<meta property="og:type" content="article">
<meta property="og:title" content="流量分析 | Mei的小窝">
<meta property="og:url" content="http://example.com/2025/10/02/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/index.html">
<meta property="og:site_name" content="Mei的小窝">
<meta property="og:description" content="流量分析做题总结不行啊，好歹是一个杂项手，但是杂项本来就杂，流量分析也是最难看懂的，总之就是收集那些特别离谱，根本没见过的流量，普通的流量分析就算了 VoIP我们先来看下VoIP是什么东西   也就是说这就是一个类似使用流量来传递语音，这也是我第一次使用wireshark的电话功能 用wireshark打开流量包然后选择电话打开VoIP通话，然后打开唯一的一段音频   可惜我的英语实在太差了...">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/2025/10/02/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/assets/images/Hexo-Theme-MEOW.png">
<meta property="article:published_time" content="2025-10-02T02:52:35.000Z">
<meta property="article:modified_time" content="2025-10-23T12:53:41.976Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://example.com/2025/10/02/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/assets/images/Hexo-Theme-MEOW.png"><meta name="robots" content="index,follow"/><meta name="googlebot" content="index,follow"/><meta name="revisit-after" content="1 days"/><title>流量分析 | Mei的小窝</title><link rel="shortcut icon" href="/assets/images/Hexo-Theme-MEOW.ico"><link rel="preconnect" href="/assets"/><link rel="preconnect" href="assets"/>
<link rel="stylesheet" href="/css/style.css">
<link rel="prefetch" href="/"/><link rel="prefetch" href="/archives"/><link rel="prefetch" href="/tags"/><meta name="generator" content="Hexo 7.3.0"></head><body bg-style="none"><header><div id="navbar"><div id="nav-info"><a id="site-icon" href="/" title="Home"><img src="/assets/images/Hexo-Theme-MEOW.png" alt="Logo"/></a><a id="site-name" href="/" title="Home"><div>Mei的小窝</div><img src="/assets/images/svg/uc/uc-home.svg" class="icon noview" alt="Icon"></a></div><div id="nav-menu"></div><div id="nav-function"><div id="menu-btn"><a href="javascript:void(0);" title="Toggle Menu"><img src="/assets/images/svg/uc/uc-menu.svg" class="icon noview" alt="Icon"></a></div></div></div></header><div id="menu-aside"><div id="menu-aside-container"><div id="menu-aside-info"><a href="/" title="Home"><img src="/assets/images/Hexo-Theme-MEOW.png" alt="Logo"/></a><a href="/" title="Home">Mei的小窝</a></div><hr/></div></div><main><div class="banner"><div class="banner-info"><div class="banner-avatar"><img src="/assets/images/Hexo-Theme-MEOW.png" alt="Avatar"/></div><div class="banner-title">「 MEOW 」</div></div></div><div class="post-container"><div class="post-main"><div class="post-content"><h1 class="post-title">流量分析</h1><div class="post-author"><span>Author: John Doe</span></div><div class="post-meta"><div class="post-info"><div class="post-date"><div class="post-pubdate"><img src="/assets/images/svg/ta/ta-pubdate.svg" class="icon noview" alt="Icon"><span>Created: 2025-10-02</span></div><div class="post-update"><img src="/assets/images/svg/ta/ta-update.svg" class="icon noview" alt="Icon"><span>Updated: 2025-10-23</span></div></div><div class="post-read"></div></div><div class="post-attribute"></div></div><div class="post markdown" indent="false"><h1 id="流量分析做题总结"><a href="#流量分析做题总结" class="headerlink" title="流量分析做题总结"></a>流量分析做题总结</h1><p>不行啊，好歹是一个杂项手，但是杂项本来就杂，流量分析也是最难看懂的，总之就是收集那些特别离谱，根本没见过的流量，普通的流量分析就算了</p>
<h2 id="VoIP"><a href="#VoIP" class="headerlink" title="VoIP"></a>VoIP</h2><p>我们先来看下VoIP是什么东西</p>
<img lazyload src="/assets/images/Meow-Loading.webp" data-lazy-src="/2025/10/02/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/image-20251002110703856.png" class title="image-20251002110703856">

<p>也就是说这就是一个类似使用流量来传递语音，这也是我第一次使用wireshark的电话功能</p>
<p>用wireshark打开流量包然后选择电话打开VoIP通话，然后打开唯一的一段音频</p>
<img lazyload src="/assets/images/Meow-Loading.webp" data-lazy-src="/2025/10/02/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/image-20251002111024219.png" class title="image-20251002111024219">

<p>可惜我的英语实在太差了，听不懂在说什么，但是其实只要把单个字符听到即可</p>
<div class="code-container" code-lang="Plaintext"><div class="codebox"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;9001IVR&#125;</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>





<h2 id="Nmap扫描端口"><a href="#Nmap扫描端口" class="headerlink" title="Nmap扫描端口"></a>Nmap扫描端口</h2><p>题目来源<code>[NewStarCTF 2023 公开赛道]Nmap</code>，叫我们找出Nmap扫描出来的端口号，这个以前没做过，自己看流量包结果是错的，直接看题解</p>
<p>题目描述为</p>
<p>请给出Nmap扫描得到所有的开放端口用英文逗号分隔，端口号从小到大排列。 例如flag{21,22,80,8080}</p>
<p>这个过滤器可以筛选出TCP端口开放的数据包</p>
<div class="code-container" code-lang="Plaintext"><div class="codebox"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tcp.flags.syn == 1 and tcp.flags.ack == 1</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>

<p>也就是WireShark中那些绿色表示成功的流量</p>
<img lazyload src="/assets/images/Meow-Loading.webp" data-lazy-src="/2025/10/02/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/image-20251005132914293.png" class title="image-20251005132914293">

<p>然后就是UDP端口</p>
<div class="code-container" code-lang="Plaintext"><div class="codebox"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">udp</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>

<p>这个过滤条件可以筛选出UDP端口开放的数据包，该过滤条件会匹配所有的UDP数据包，因为UDP没有像TCP那样的连接建立过程，所以UDP数据包的到达通常表示端口是开放的。（UDP和TCP主要的区别就是，UDP不需要连接，可以直接发送包）</p>
<p>这个题目没有UDP请求</p>
<div class="code-container" code-lang="Plaintext"><div class="codebox"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">icmp and icmp.type == 3 and icmp.code == 3</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>

<p>这个过滤条件用于查找被目标主机标记为”端口不可达”的数据包，通常表示端口关闭；</p>
<p>该过滤条件匹配了ICMP “端口不可达”类型的数据包，其中的 “code” 值为3表示端口关闭。</p>
<p>然后我们这个题目主要是查看TCP请求中开启的端口</p>
<img lazyload src="/assets/images/Meow-Loading.webp" data-lazy-src="/2025/10/02/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/5e03cd8fcd2858e5d7ac034bfe5f0170.png" class title="img">

<p>我们成功在TCP中看到端口，其他都是空的</p>
<img lazyload src="/assets/images/Meow-Loading.webp" data-lazy-src="/2025/10/02/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/image-20251005133630088.png" class title="image-20251005133630088">

<p>我们将这些端口从小排到大拿到flag</p>
<div class="code-container" code-lang="Plaintext"><div class="codebox"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;80,3306,5000,7000,8021,9000&#125;</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>





<h2 id="TLS流量分析"><a href="#TLS流量分析" class="headerlink" title="TLS流量分析"></a>TLS流量分析</h2><p>TLS流量太难理解了，还没学过计算机网络，这些东西太深奥了，现在只能学一下别人做题</p>
<p><strong>TLS流量基础</strong></p>
<ul>
<li><strong>TLS作用</strong>：用于加密应用层数据（如HTTP→HTTPS），保护通信隐私。</li>
<li><strong>常见来源</strong>：题目通常提供<code>.pcap</code>或<code>.pcapng</code>文件，包含TLS加密的流量。</li>
<li><strong>关键特征</strong>：在Wireshark中，默认显示为「TLSv1.2」、「TLSv1.3」协议，内容被加密。</li>
</ul>
<p><strong>ssc.key（服务器私钥）</strong></p>
<ul>
<li><strong>是什么</strong>：服务器的RSA私钥文件（通常是<code>.pem</code>或<code>.key</code>格式）</li>
<li><strong>作用</strong>：用于解密TLS握手阶段的<strong>Pre-Master Secret</strong></li>
<li><strong>解密原理</strong>：在RSA密钥交换中，Client用服务器公钥加密Pre-Master Secret，只有持有私钥的服务器能解密</li>
<li><strong>文件内容</strong>：</li>
</ul>
<div class="code-container" code-lang="Plaintext"><div class="codebox"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-----BEGIN PRIVATE KEY-----</span><br><span class="line">MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQCwV6RmqeM...</span><br><span class="line">-----END PRIVATE KEY-----</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>

<p> <strong>key.log（会话密钥日志）</strong></p>
<ul>
<li><strong>是什么</strong>：记录所有TLS会话的<strong>主密钥和流量密钥</strong></li>
<li><strong>作用</strong>：直接提供解密所需的最终密钥，绕过复杂的密钥交换过程</li>
<li><strong>文件内容</strong>：</li>
</ul>
<div class="code-container" code-lang="Plaintext"><div class="codebox"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CLIENT_RANDOM 5a5e5c7e3d9e4f2a8b1c6d3e7f8a9b0c 4f8a1b3c9d2e7f6a8b5c4d3e2f1a9b8c7d6e5f4a3b2c1d0e9f8a7b6c5d4e3f2a1b</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>



<p>HTTP和TLS加密成为了HTTPS流量，所以TLS流量就是被加密的HTTP流量，这两个文件是我们解密TLS流量重要的两个文件，找到这两个文件都是可以直接将其进行解密的，只不过使用方法和过程不同</p>
<p>使用方法都是</p>
<div class="code-container" code-lang="Plaintext"><div class="codebox"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">编辑-&gt;首选项-&gt;Protocols-&gt;TLS</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>



<p>ssc.key是私钥，需要通过Wireshark进行解密</p>
<div class="code-container" code-lang="Plaintext"><div class="codebox"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssc.key → 需要Wireshark进行密码学计算 → 推导出会话密钥 → 解密数据</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>

<p>key.log则通过日志直接获取会话密钥可以直接解密</p>
<div class="code-container" code-lang="Plaintext"><div class="codebox"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">key.log → 直接提供会话密钥 → 立即解密数据</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>

<p>然后这是具体的使用部位</p>
<img lazyload src="/assets/images/Meow-Loading.webp" data-lazy-src="/2025/10/02/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/image-20251017194709437.png" class title="image-20251017194709437">



<p>题目来源buuctf:greatescape</p>
<p>看见很多TLS流量，然后其他流量没有发现什么特别的线索，猜测是TLS流量解密</p>
<p>我们可以通过全局搜索<code>.key</code>来看下是否传递了key文件发现</p>
<img lazyload src="/assets/images/Meow-Loading.webp" data-lazy-src="/2025/10/02/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/image-20251017195243476.png" class title="image-20251017195243476">

<p>我们在下一个流中可以看到key文件</p>
<img lazyload src="/assets/images/Meow-Loading.webp" data-lazy-src="/2025/10/02/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/image-20251017195327912.png" class title="image-20251017195327912">

<p>由于这次私钥是直接明文传递我们可以直接全局搜索<code>BEGIN PRIVATE KEY</code>也可以找到，将其复制出来保存为ssc.key，然后再去配置好即可</p>
<img lazyload src="/assets/images/Meow-Loading.webp" data-lazy-src="/2025/10/02/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/image-20251017201657894.png" class title="image-20251017201657894">

<p>应用后就是追踪tcp.stream eq 80然后再对其流量包追踪HTTP流即可拿到flag，不知道是不是应为flag被写为字段了导致全局搜索不到，那样就只能自己去看流量包了</p>
<img lazyload src="/assets/images/Meow-Loading.webp" data-lazy-src="/2025/10/02/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/image-20251017201940979.png" class title="image-20251017201940979">







<h2 id="USB流量"><a href="#USB流量" class="headerlink" title="USB流量"></a>USB流量</h2><p>USB流量指的是USB设备接口的流量，攻击者能够通过监听usb接口流量获取键盘敲击键、鼠标移动与点击、存储设备的铭文传输通信、USB无线网卡网络传输内容等等。在CTF中，USB流量分析主要以键盘和鼠标流量为主。</p>
<p><strong>键盘流量</strong></p>
<p>USB协议数据部分在Leftover Capture Data域中，数据长度为<code>八个字节</code>。其中键盘击键信息集中在第三个字节中。</p>
<img lazyload src="/assets/images/Meow-Loading.webp" data-lazy-src="/2025/10/02/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/962acba71ed5eb4c15e81619e84972c6.png" class title="在这里插入图片描述">

<p>如图，发现击键信息为0x06，即对应的按键为<code>C</code></p>
<p>这个用来传递按键信息的数据就是hid码，对于Hid码官方是有文档规定的</p>
<p>键位映射关系参考：<a target="_blank" rel="noopener" href="https://wenku.baidu.com/view/9050c3c3af45b307e971971e.html">《USB键盘协议中键码》中的HID Usage ID</a></p>
<p>然后注意，HID码只是绑定按键，不会绑定输入，也就是如果按键布局和正常的不同，相同输入的情况下的hid码也会和正常的不同，有些题目就会改变按键映射来让我们的一些工具失效</p>
<p>对于hid码我们需要使用wireshark安装目录下的teshark去进行提取</p>
<div class="code-container" code-lang="Bash"><div class="codebox"><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tshark -r usb.pcap -T fields -e usb.capdata &gt; usbdata.txt</span><br><span class="line">tshark -r usb.pcap -T fields -e usb.capdata | sed <span class="string">&#x27;/^\s*$/d&#x27;</span> &gt; usbdata.txt <span class="comment">#提取并去除空行</span></span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>

<ul>
<li><code>-T fields</code><ul>
<li><code>-T</code> 选项用于设置输出格式。</li>
<li><code>fields</code> 表示输出将不是标准的数据包摘要，而是<strong>特定字段的值</strong>。这允许你精确提取你想要的某一部分数据。</li>
</ul>
</li>
<li><code>-e usbhid.data</code><ul>
<li><code>-e</code> 选项代表 <strong>field to print</strong>（要打印的字段）。</li>
<li><code>usbhid.data</code> 是这个字段的名字，它特指从 <strong>USB HID设备</strong> 捕获到的<strong>数据载荷</strong>。</li>
<li><strong>简单来说，这个部分就是在告诉tshark：“我不要看数据包的IP地址、端口、时间戳这些杂七杂八的东西，我只要看HID设备传输的核心数据内容。”</strong></li>
</ul>
</li>
</ul>
</div><div class="post-reward"><div class="post-reward-btn" title="Reward The Author"><img src="/assets/images/svg/uc/uc-gift.svg" class="icon noview" alt="Icon"><span></span></div><div class="post-reward-content"><div class="post-reward-text"></div><div class="post-reward-list"><a href="/null" target="_blank">Credits</a></div></div></div><div class="post-copyright"><div class="post-copyright-info">This work is published by John Doe at 2025-10-02 10:52:35</div><div class="post-copyright-link"><span>Link: <a href="http://example.com/2025/10/02/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/">流量分析</a></span><button class="copy-text" type="button" data-text="http://example.com/2025/10/02/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/">Copy</button></div><div class="post-copyright-detail">This work is licensed under <a href='https://creativecommons.org/licenses/by-nc-sa/4.0/' title='Attribution-NonCommercial-ShareAlike' target='_blank'>CC BY-NC-SA 4.0</a>. Please indicate <a href='/'>Mei的小窝</a> when reprinting.</div><img class="post-copyright-icon noview" src="/assets/images/Hexo-Theme-MEOW.png" alt="Logo"/></div><div class="post-tail-tags"></div></div><aside id="post-sidebar" status="show"><div id="toc-container"><div class="toc-title"><img src="/assets/images/svg/ta/ta-toc.svg" class="icon noview" alt="Icon"><span>Table Of Content</span></div><div class="toc-content" id="toc-div"><ol class="toc-list"><li class="toc-list-item toc-list-level-1"><a class="toc-list-link" href="#%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90%E5%81%9A%E9%A2%98%E6%80%BB%E7%BB%93"><span class="toc-list-text">流量分析做题总结</span></a><ol class="toc-list-child"><li class="toc-list-item toc-list-level-2"><a class="toc-list-link" href="#VoIP"><span class="toc-list-text">VoIP</span></a></li><li class="toc-list-item toc-list-level-2"><a class="toc-list-link" href="#Nmap%E6%89%AB%E6%8F%8F%E7%AB%AF%E5%8F%A3"><span class="toc-list-text">Nmap扫描端口</span></a></li><li class="toc-list-item toc-list-level-2"><a class="toc-list-link" href="#TLS%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90"><span class="toc-list-text">TLS流量分析</span></a></li><li class="toc-list-item toc-list-level-2"><a class="toc-list-link" href="#USB%E6%B5%81%E9%87%8F"><span class="toc-list-text">USB流量</span></a></li></ol></li></ol></div></div></aside></div></div><div id="toolbar" hide=""><div id="toolbar-setting-container" hide=""><div class="toolbar-item"><button id="tool-color-mode" title="Dark Mode" type="button"><img src="/assets/images/svg/ta/ta-moon.svg" class="icon noview" alt="Icon"></button></div><div class="toolbar-item"><button class="copy-text" id="tool-share" title="Share" type="button" data-text="http://example.com/2025/10/02/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/"><img src="/assets/images/svg/ta/ta-share.svg" class="icon noview" alt="Icon"></button></div><div class="toolbar-item"><button id="tool-font-size-plus" title="Increase Font Size" type="button"><img src="/assets/images/svg/ta/ta-text-plus.svg" class="icon noview" alt="Icon"></button></div><div class="toolbar-item"><button id="tool-font-size-minus" title="Decrease Font Size" type="button"><img src="/assets/images/svg/ta/ta-text-minus.svg" class="icon noview" alt="Icon"></button></div></div><div class="toolbar-container"><div class="toolbar-item"><button id="tool-setting" title="Settings" type="button"><img src="/assets/images/svg/ta/ta-setting.svg" class="icon noview" alt="Icon"></button></div><div class="toolbar-item"><button id="tool-toc" title="Table Of Content" type="button"><img src="/assets/images/svg/ta/ta-toc.svg" class="icon noview" alt="Icon"></button></div><div class="toolbar-item"><button id="tool-gototop" title="Go To Top" type="button"><img src="/assets/images/svg/ta/ta-up.svg" class="icon noview" alt="Icon"></button></div></div></div></main><footer><div class="footer"><div id="footer-copyright">© 2024 - 2025 <span>💗</span> <a href="/null">John Doe</a></div><div id="footer-info"><div id="footer-framework">🚀Powered by <a href="https://hexo.io" target="_blank">Hexo</a> & <a href="https://github.com/chanwj/hexo-theme-meow" title="3.2.0" target="_blank">Meow</a></div><div id="footer-runtime"><span id="runtime" data-startdate="2024-04-02T22:16:20.000Z">🌻Blog Runtime: . Years . Months . Days</span></div></div></div></footer><div class="scripts"><script>const GLOBALCONFIG = {
  root: '/',
  toolbar: true,
  lazyload_src: '/assets/images/Meow-Loading.webp',
  friends: false,
  codeblock: true,
  share_text: '🐱Share From Meow',
  onblur_title: 'Please Come Back～✧(´▽`ʃ♡ƪ)',
  mouse_click: false,
  notify:{
    enable: false,
    info: 'Copied successfully! Please mark the address of this post if redistribute.',
    f12_info: 'Turned on developer mode, please follow the copyright license of this website'
  },
  search: {
    enable: false,
    path: '',
    local: {
      top_n_per_article: 1,
      preload: false
    }
  },
  encrypt: false,
};
</script><script>if (!localStorage.getItem('color-mode')) {
  localStorage.setItem('color-mode', 'light' || 'light');
}
document.body.setAttribute('data-mode', localStorage.getItem('color-mode'));
</script>
<script src="/js/theme/tools/utils.js"></script>

<script src="/js/plugins/dist/lazyload.min.js"></script>

<script src="/js/plugins/view-image.min.js"></script>
<script>if (localStorage.getItem('font-size')) {
  document.querySelector('.post').style.fontSize = localStorage.getItem('font-size') + 'px';
}
</script>
<script src="/js/main.js" type="module"></script>
</div></body></html>