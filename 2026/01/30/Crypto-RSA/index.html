<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="author" content="Regulus"/><meta name="copyright" content="Regulus"/><meta name="theme-color" content="#FFB347"/><meta name="format-detection" content="telephone=no"/><meta name="keywords" content="Hexo Theme MEOW"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="apple-touch-fullscreen" content="yes"/><meta name="application-name" content="Crypto_RSA | Mei的小窝"/><meta name="apple-mobile-web-app-title" content="Crypto_RSA | Mei的小窝"/><meta name="apple-mobile-web-app-status-bar-style" content="#FFB347"/><link rel="canonical" href="http://example.com/2026/01/30/Crypto-RSA/"/><meta name="description" content="Crypto RSA这是我学的第一个现代密码，在学RSA之前先了解一下对称加密和非对称加密的区别。 核心区别    特性 对称加密 非对称加密    密钥数量 1个密钥（加解密相同） 2个密钥（公钥+私钥）   速度 快（适合大数据） 慢（适合小数据）   主要用途 数据加密传输 密钥交换、数字签名、身份验证   典型算法 AES、DES、3DES、ChaCha20 RSA、ECC、ElGa...">
<meta property="og:type" content="article">
<meta property="og:title" content="Crypto_RSA | Mei的小窝">
<meta property="og:url" content="http://example.com/2026/01/30/Crypto-RSA/index.html">
<meta property="og:site_name" content="Mei的小窝">
<meta property="og:description" content="Crypto RSA这是我学的第一个现代密码，在学RSA之前先了解一下对称加密和非对称加密的区别。 核心区别    特性 对称加密 非对称加密    密钥数量 1个密钥（加解密相同） 2个密钥（公钥+私钥）   速度 快（适合大数据） 慢（适合小数据）   主要用途 数据加密传输 密钥交换、数字签名、身份验证   典型算法 AES、DES、3DES、ChaCha20 RSA、ECC、ElGa...">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/2026/01/30/Crypto-RSA/assets/images/Hexo-Theme-MEOW.png">
<meta property="article:published_time" content="2026-01-30T05:32:09.000Z">
<meta property="article:modified_time" content="2026-01-31T13:37:34.194Z">
<meta property="article:author" content="Regulus">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://example.com/2026/01/30/Crypto-RSA/assets/images/Hexo-Theme-MEOW.png"><meta name="robots" content="index,follow"/><meta name="googlebot" content="index,follow"/><meta name="revisit-after" content="1 days"/><title>Crypto_RSA | Mei的小窝</title><link rel="shortcut icon" href="/assets/images/Hexo-Theme-MEOW.ico"><link rel="preconnect" href="/assets"/><link rel="preconnect" href="assets"/>
<link rel="stylesheet" href="/css/style.css">
<link rel="prefetch" href="/"/><link rel="prefetch" href="/archives"/><link rel="prefetch" href="/tags"/><meta name="generator" content="Hexo 7.3.0"></head><body bg-style="none"><header><div id="navbar"><div id="nav-info"><a id="site-icon" href="/" title="主页"><img src="/assets/images/Hexo-Theme-MEOW.png" alt="Logo"/></a><a id="site-name" href="/" title="主页"><div>Mei的小窝</div><img src="/assets/images/svg/uc/uc-home.svg" class="icon noview" alt="Icon"></a></div><div id="nav-menu"><div class="menu-item"><a href="javascript:void(0);"><img src="/assets/images/svg/uc/uc-article.svg" class="icon noview" alt="Icon"><span>文章</span></a><ul class="sub-menu-item"><li><a href="/archives"><img src="/assets/images/svg/uc/uc-archive.svg" class="icon noview" alt="Icon"><span>归档</span></a></li><li><a href="/categories"><img src="/assets/images/svg/uc/uc-category.svg" class="icon noview" alt="Icon"><span>分类</span></a></li><li><a href="/tags"><img src="/assets/images/svg/uc/uc-tag.svg" class="icon noview" alt="Icon"><span>标签</span></a></li><li><a href="/about"><img src="/assets/images/svg/uc/uc-about.svg" class="icon noview" alt="Icon"><span>关于</span></a></li></ul></div></div><div id="nav-function"><div id="search-btn"><a href="javascript:void(0);" title="搜索" accesskey="s"><img src="/assets/images/svg/uc/uc-search.svg" class="icon noview" alt="Icon"><span>搜索</span></a></div><div id="menu-btn"><a href="javascript:void(0);" title="打开菜单"><img src="/assets/images/svg/uc/uc-menu.svg" class="icon noview" alt="Icon"></a></div></div></div></header><div id="menu-aside"><div id="menu-aside-container"><div id="menu-aside-info"><a href="/" title="主页"><img src="/assets/images/Hexo-Theme-MEOW.png" alt="Logo"/></a><a href="/" title="主页">Mei的小窝</a></div><div class="menu-aside-item"><a href="javascript:void(0);"><img src="/assets/images/svg/uc/uc-article.svg" class="icon noview" alt="Icon"><span>文章</span></a><ul class="menu-aside-sub-item"><li><a href="/archives"><img src="/assets/images/svg/uc/uc-archive.svg" class="icon noview" alt="Icon"><span>归档</span></a></li><li><a href="/categories"><img src="/assets/images/svg/uc/uc-category.svg" class="icon noview" alt="Icon"><span>分类</span></a></li><li><a href="/tags"><img src="/assets/images/svg/uc/uc-tag.svg" class="icon noview" alt="Icon"><span>标签</span></a></li><li><a href="/about"><img src="/assets/images/svg/uc/uc-about.svg" class="icon noview" alt="Icon"><span>关于</span></a></li></ul></div><hr/></div></div><main><div class="banner"><div class="banner-info"><div class="banner-avatar"><img src="/assets/images/Hexo-Theme-MEOW.png" alt="Avatar"/></div><div class="banner-title">「 Mei的小窝 」</div></div></div><div class="post-container"><div class="post-main"><div class="post-content"><h1 class="post-title">Crypto_RSA</h1><div class="post-author"><span>作者: Regulus</span></div><div class="post-meta"><div class="post-info"><div class="post-date"><div class="post-pubdate"><img src="/assets/images/svg/ta/ta-pubdate.svg" class="icon noview" alt="Icon"><span>发表于2026-01-30</span></div><div class="post-update"><img src="/assets/images/svg/ta/ta-update.svg" class="icon noview" alt="Icon"><span>更新于2026-01-31</span></div></div><div class="post-read"><div class="post-wordcount"><img src="/assets/images/svg/ta/ta-write.svg" class="icon noview" alt="Icon"><span>总字数: 5.2k字</span></div><div class="post-readtime"><img src="/assets/images/svg/ta/ta-time.svg" class="icon noview" alt="Icon"><span>阅读时长: 19分钟</span></div><div class="post-pageview"><img src="/assets/images/svg/ta/ta-fire.svg" class="icon noview" alt="Icon"><span>访问量: </span><span id="vercount_value_page_pv"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"  stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 6l0 -3" /><path d="M16.25 7.75l2.15 -2.15" /><path d="M18 12l3 0" /><path d="M16.25 16.25l2.15 2.15" /><path d="M12 18l0 3" /><path d="M7.75 16.25l-2.15 2.15" /><path d="M6 12l-3 0" /><path d="M7.75 7.75l-2.15 -2.15" /></svg></span></div></div></div><div class="post-attribute"></div></div><div class="post markdown" indent="false"><h1 id="Crypto-RSA"><a href="#Crypto-RSA" class="headerlink" title="Crypto RSA"></a>Crypto RSA</h1><p>这是我学的第一个现代密码，在学RSA之前先了解一下对称加密和非对称加密的区别。</p>
<p><strong>核心区别</strong></p>
<div class="table-container"><table>
<thead>
<tr>
<th align="left">特性</th>
<th align="left">对称加密</th>
<th align="left">非对称加密</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><strong>密钥数量</strong></td>
<td align="left">1个密钥（加解密相同）</td>
<td align="left">2个密钥（公钥+私钥）</td>
</tr>
<tr>
<td align="left"><strong>速度</strong></td>
<td align="left">快（适合大数据）</td>
<td align="left">慢（适合小数据）</td>
</tr>
<tr>
<td align="left"><strong>主要用途</strong></td>
<td align="left">数据加密传输</td>
<td align="left">密钥交换、数字签名、身份验证</td>
</tr>
<tr>
<td align="left"><strong>典型算法</strong></td>
<td align="left">AES、DES、3DES、ChaCha20</td>
<td align="left">RSA、ECC、ElGamal、DH</td>
</tr>
</tbody></table></div>
<p><strong>对称加密</strong></p>
<p><strong>原理</strong>：加密和解密使用同一密钥</p>
<div class="code-container" code-lang="Plaintext"><div class="codebox"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">明文 + 密钥 → 加密 → 密文</span><br><span class="line">密文 + 密钥 → 解密 → 明文</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>

<p>加密需要使用到密匙，解密也使用这个密匙。</p>
<p>对称加密算法中，数据发送方将明文和密钥一起经过特殊加密算法处理成密文后，将它发送出去。接收方收到密文后，若想解读原文，则需要使用加密用到的相同密钥及相同算法的逆算法对密文进行解密，才能使其恢复成原文。<br>    它的最大优势是加&#x2F;解密速度快，适用于大数据量进行加密，缺点是密钥管理困难，最典型的问题就是如何同步这个密钥，同步过程如果在公网上，不进行加密是可以抓包拿到的，那么这里就遇到了要对密钥加密的问题。<br>    常见的对称加密算法有 <strong>AES</strong>、<strong>DES</strong>、<strong>Blowfish</strong> 等等。<br>    对称加密的核心是只有一把密钥。</p>
<p><strong>非对称加密</strong></p>
<p><strong>原理</strong>：公钥加密，私钥解密；私钥签名，公钥验证</p>
<div class="code-container" code-lang="Plaintext"><div class="codebox"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">加密：明文 + 公钥 → 密文</span><br><span class="line">解密：密文 + 私钥 → 明文</span><br><span class="line">签名：哈希 + 私钥 → 签名</span><br><span class="line">验证：签名 + 公钥 → 验证结果</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>

<p>使用公钥加密和私钥解密，需要有算法来计算对应的公钥和私钥。公钥和私钥是相互的，作用可以交换，重点在于公钥只能用来加密，需要使用对应的私钥才能进行解密。</p>
<p>非对称加密算法中，有两个密钥：公钥和私钥。它们是一对，如果用公钥进行加密，只有用对应的私钥才能解密；如果用私钥进行加密，只有用对应的公钥才能解密。<br>    非对称加密算法实现机密信息的交换过程为：甲方生成一对密钥并将其中一个作为公钥向其他方公开；得到该公钥的乙方使用该密钥对机密信息进行加密后发送给甲方；甲方再用自己的另一个专用密钥对加密后的信息进行解密。<br>    最有名的非对称加密算法当属 <strong>RSA</strong> 了，本文将对 <strong>RSA</strong> 算法的加&#x2F;解密过程进行详细剖析。<br>    非对称加密拥有两把密钥。</p>
<h2 id="1-算法原理"><a href="#1-算法原理" class="headerlink" title="1.算法原理"></a>1.算法原理</h2><p>​       算法本身基于一个简单的数论知识：给出两个素数，很容易将它们相乘，然而给出它们的乘积，想得到这两个素数就显得尤为困难。如果能够解决大整数（比如几百位的整数）分解的快速方法，那么 <strong>RSA</strong> 算法将轻易被破解。</p>
<h2 id="2-公钥和私钥的生成"><a href="#2-公钥和私钥的生成" class="headerlink" title="2.公钥和私钥的生成"></a>2.公钥和私钥的生成</h2><div class="code-container" code-lang="Plaintext"><div class="codebox"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">1. 选择两个大质数 p, q （保密）</span><br><span class="line">2. 计算 n = p × q                     （公开模数）</span><br><span class="line">3. 计算 T=φ(n) = (p-1)(q-1)             （欧拉函数，保密）</span><br><span class="line">4. 选择 e 使得 1 &lt; e &lt; T 且 gcd(e, φ(n)) = 1  （公钥指数，通常65537）</span><br><span class="line">选择公钥e的时候 需要满足不是T的因子，也就是和T互质</span><br><span class="line">5. 计算 d ≡ e⁻¹ mod φ(n)              （私钥指数，保密）</span><br><span class="line">私钥d计算为d*e%T=1  由于都是整数，我们不能直接代数进行计算，可以遍历出符合的私钥</span><br><span class="line"></span><br><span class="line">公钥: (n, e)</span><br><span class="line">私钥: (d, p, q, φ(n))</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>

<p>欧拉函数实际上就是求比n小1到n中间和n互质的数的个数，比如和p为2 q为3 n为6 和6互质的数有1 5 欧拉函数结果就是1*2 等于2</p>
<p>公钥中n和e就是我们可以公开的数字。爆破出私钥需要我们知道e和T，由于e作为公钥，T我们如果想要求就需要通过欧拉函数去计算T。</p>
<p>那有没有可能不通过公式，直接使用欧拉函数的定义去求出T呢，只能说当n足够大的时候，计算数据过大，计算时间过长是不可能算出来的</p>
<p>对于典型RSA-2048：</p>
<div class="code-container" code-lang="Plaintext"><div class="codebox"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">n ≈ 2^2048 ≈ 3.23×10^616</span><br><span class="line">φ(n) ≈ n (因为p,q都很大，φ(n)接近n)</span><br><span class="line"></span><br><span class="line"># 暴力枚举检查每个数是否互质：</span><br><span class="line">操作次数 ≈ 10^616 次</span><br><span class="line">宇宙年龄 ≈ 4.3×10^17 秒</span><br><span class="line">原子数量 ≈ 10^80 个</span><br><span class="line"></span><br><span class="line"># 即使每个原子每普朗克时间(10^-43秒)计算一次</span><br><span class="line"># 到宇宙毁灭也远远不够</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>



<p>于是需要防止私钥被破解就需要保护好私钥d的同时保护好p和q这两个质数，然后还需要p和q两个质数足够大，防止暴力破解T，以及防止通过n来反推出qp。</p>
<h2 id="3-RSA加解密"><a href="#3-RSA加解密" class="headerlink" title="3.RSA加解密"></a>3.RSA加解密</h2><p>我们进行加密的话密文不是字符串，而是一个数字，于是我们需要将原文以某种形式转化为数字，可以是ascii或者是其他的某种转化规则，但宗旨就是将字符串转化为数字才能进行加密。</p>
<div class="code-container" code-lang="Python"><div class="codebox"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">加密（公钥）: c ≡ m^e mod n  先算m的e次方再对n进行取余于是得到密文c</span><br><span class="line">解密（私钥）: m ≡ c^d mod n  密文的d次方然后再对n进行取余得到原文</span><br><span class="line">签名: s ≡ m^d mod n</span><br><span class="line">验证: m ≡ s^e mod n</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>

<p>学了这么多年数学，这个时候我就真的不知道为什么加密公式和解密公式长这个样子，终于知道了为什么要记公式了。</p>
<p>由于使用私钥进行加密的密文使用公钥也可以进行解密，于是就需要使用私钥去构造签名，然后公钥这边进行验证签名。流程也是一样的，只不过相当于是私钥那边将密文发送到公钥那边。</p>
<h2 id="4-加解密算法实现"><a href="#4-加解密算法实现" class="headerlink" title="4.加解密算法实现"></a>4.加解密算法实现</h2><p>这个是叫DS给我写的，还是一如既往的代码写的又长有没什么用，只是用来参考一下，反正现在加解密一堆工具</p>
<div class="code-container" code-lang="Python"><div class="codebox"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">RSA加解密实现详解</span></span><br><span class="line"><span class="string">===========================================</span></span><br><span class="line"><span class="string">这个代码实现了教科书式的RSA算法，包含密钥生成、加密、解密全过程。</span></span><br><span class="line"><span class="string">注意：这是简化版本，仅用于学习CTF题目，实际应用中需要添加填充等安全措施。</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 导入必要的库</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime, inverse, bytes_to_long, long_to_bytes</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TextbookRSA</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    教科书RSA类</span></span><br><span class="line"><span class="string">    ----------------------------</span></span><br><span class="line"><span class="string">    特点：</span></span><br><span class="line"><span class="string">    1. 无填充（直接加密原始数据）</span></span><br><span class="line"><span class="string">    2. 使用标准RSA数学公式</span></span><br><span class="line"><span class="string">    3. 保存所有中间参数（CTF中常见）</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    警告：实际系统不应使用此类，因为：</span></span><br><span class="line"><span class="string">    - 无填充导致易受多种攻击</span></span><br><span class="line"><span class="string">    - 直接加密字符串可能泄露信息</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, key_size=<span class="number">1024</span>, e=<span class="number">65537</span></span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        初始化RSA对象</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        参数：</span></span><br><span class="line"><span class="string">        key_size: 密钥长度（比特），决定n的大小</span></span><br><span class="line"><span class="string">                常用值：512（CTF简单题）, 1024（中等）, 2048（安全）</span></span><br><span class="line"><span class="string">        e: 公钥指数，通常固定为65537（0x10001）</span></span><br><span class="line"><span class="string">          选择原因：</span></span><br><span class="line"><span class="string">          - 二进制只有2个1，计算快速</span></span><br><span class="line"><span class="string">          - 足够大，避免小e攻击</span></span><br><span class="line"><span class="string">          - 是素数，与φ(n)大概率互质</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="variable language_">self</span>.key_size = key_size  <span class="comment"># 密钥长度</span></span><br><span class="line">        <span class="variable language_">self</span>.e = e                <span class="comment"># 公钥指数</span></span><br><span class="line">        <span class="variable language_">self</span>.generate_keys()      <span class="comment"># 调用密钥生成方法</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">generate_keys</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        生成RSA密钥对</span></span><br><span class="line"><span class="string">        过程：</span></span><br><span class="line"><span class="string">        1. 选择两个大素数 p, q</span></span><br><span class="line"><span class="string">        2. 计算 n = p × q</span></span><br><span class="line"><span class="string">        3. 计算 φ(n) = (p-1)(q-1)</span></span><br><span class="line"><span class="string">        4. 选择 e（已固定为65537）</span></span><br><span class="line"><span class="string">        5. 计算 d = e⁻¹ mod φ(n)</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="comment"># 生成两个大素数，每个素数长度为密钥长度的一半</span></span><br><span class="line">        <span class="comment"># 例如：key_size=1024 → p,q各512位</span></span><br><span class="line">        p = getPrime(<span class="variable language_">self</span>.key_size // <span class="number">2</span>)  <span class="comment"># 生成随机素数p</span></span><br><span class="line">        q = getPrime(<span class="variable language_">self</span>.key_size // <span class="number">2</span>)  <span class="comment"># 生成随机素数q</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 确保p≠q（极小概率相同，但防御性编程）</span></span><br><span class="line">        <span class="comment"># 如果p==q，则n=p²，RSA完全失效</span></span><br><span class="line">        <span class="keyword">while</span> p == q:</span><br><span class="line">            q = getPrime(<span class="variable language_">self</span>.key_size // <span class="number">2</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 计算模数n = p × q</span></span><br><span class="line">        <span class="comment"># n是公钥的一部分，公开的</span></span><br><span class="line">        <span class="variable language_">self</span>.n = p * q</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 计算欧拉函数 φ(n) = (p-1)(q-1)</span></span><br><span class="line">        <span class="comment"># φ(n)必须保密！知道φ(n)就可以分解n</span></span><br><span class="line">        phi = (p-<span class="number">1</span>) * (q-<span class="number">1</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 计算私钥指数 d = e⁻¹ mod φ(n)</span></span><br><span class="line">        <span class="comment"># inverse(e, phi) 计算模逆：e × d ≡ 1 (mod φ(n))</span></span><br><span class="line">        <span class="comment"># d是私钥的核心部分，必须绝对保密</span></span><br><span class="line">        <span class="variable language_">self</span>.d = inverse(<span class="variable language_">self</span>.e, phi)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 保存关键参数（CTF中常需要这些中间值）</span></span><br><span class="line">        <span class="variable language_">self</span>.p = p      <span class="comment"># 第一个素数（保密）</span></span><br><span class="line">        <span class="variable language_">self</span>.q = q      <span class="comment"># 第二个素数（保密）</span></span><br><span class="line">        <span class="variable language_">self</span>.phi = phi  <span class="comment"># 欧拉函数值（保密）</span></span><br><span class="line">        </span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        至此，密钥生成完成：</span></span><br><span class="line"><span class="string">        公钥: (n, e)     - 公开</span></span><br><span class="line"><span class="string">        私钥: (d, p, q)  - 保密</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">self, plaintext</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        RSA加密函数</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        加密公式：c ≡ m^e (mod n)</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        参数：</span></span><br><span class="line"><span class="string">        plaintext: 明文，可以是字符串、字节或整数</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        返回：</span></span><br><span class="line"><span class="string">        ciphertext: 密文（整数）</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        注意：这是教科书RSA，无任何填充！</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="comment"># 步骤1：将输入转换为整数m</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">isinstance</span>(plaintext, <span class="built_in">str</span>):</span><br><span class="line">            <span class="comment"># 字符串 → 字节 → 整数</span></span><br><span class="line">            <span class="comment"># 例如：&quot;flag&quot; → b&#x27;flag&#x27; → 0x666c6167</span></span><br><span class="line">            m = bytes_to_long(plaintext.encode())</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">isinstance</span>(plaintext, <span class="built_in">bytes</span>):</span><br><span class="line">            <span class="comment"># 字节直接转整数</span></span><br><span class="line">            m = bytes_to_long(plaintext)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># 已经是整数，直接使用</span></span><br><span class="line">            m = plaintext</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 步骤2：验证 m &lt; n（RSA要求）</span></span><br><span class="line">        <span class="comment"># 如果 m &gt;= n，加密会失败或需要分块</span></span><br><span class="line">        <span class="keyword">if</span> m &gt;= <span class="variable language_">self</span>.n:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">f&quot;明文必须小于n\n明文: <span class="subst">&#123;m&#125;</span>\n模数n: <span class="subst">&#123;self.n&#125;</span>&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 步骤3：执行RSA加密 c = m^e mod n</span></span><br><span class="line">        <span class="comment"># pow(m, e, n) 计算 m^e mod n 的高效方法</span></span><br><span class="line">        <span class="comment"># 使用蒙哥马利算法，避免计算完整的大数幂</span></span><br><span class="line">        c = <span class="built_in">pow</span>(m, <span class="variable language_">self</span>.e, <span class="variable language_">self</span>.n)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> c  <span class="comment"># 返回密文（整数）</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">self, ciphertext</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        RSA解密函数</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        解密公式：m ≡ c^d (mod n)</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        参数：</span></span><br><span class="line"><span class="string">        ciphertext: 密文（整数）</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        返回：</span></span><br><span class="line"><span class="string">        m: 解密后的整数</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        注意：需要后续转换才能得到原始数据</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="comment"># 执行RSA解密 m = c^d mod n</span></span><br><span class="line">        m = <span class="built_in">pow</span>(ciphertext, <span class="variable language_">self</span>.d, <span class="variable language_">self</span>.n)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> m  <span class="comment"># 返回解密后的整数</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_public_key</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        获取公钥</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        返回：</span></span><br><span class="line"><span class="string">        (n, e): 公钥对</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        CTF中常以这种形式给出：</span></span><br><span class="line"><span class="string">        n = 123456789...</span></span><br><span class="line"><span class="string">        e = 65537</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> (<span class="variable language_">self</span>.n, <span class="variable language_">self</span>.e)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_private_key</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        获取私钥（包含所有敏感信息）</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        返回：</span></span><br><span class="line"><span class="string">        (d, p, q, phi): 私钥参数</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        警告：实际应用中永远不要泄露这些！</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> (<span class="variable language_">self</span>.d, <span class="variable language_">self</span>.p, <span class="variable language_">self</span>.q, <span class="variable language_">self</span>.phi)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ===========================================</span></span><br><span class="line"><span class="comment"># 使用示例</span></span><br><span class="line"><span class="comment"># ===========================================</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    演示教科书RSA的完整流程</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span> * <span class="number">50</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;教科书RSA演示&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span> * <span class="number">50</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 1. 创建RSA实例</span></span><br><span class="line">    <span class="comment"># 使用512位密钥（CTF常见，实际不安全）</span></span><br><span class="line">    rsa = TextbookRSA(<span class="number">512</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 2. 获取公钥</span></span><br><span class="line">    n, e = rsa.get_public_key()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[公钥]&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;n (模数): <span class="subst">&#123;n&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;e (指数): <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;n的位数: <span class="subst">&#123;n.bit_length()&#125;</span> bits&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>()</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 3. 准备明文消息</span></span><br><span class="line">    <span class="comment"># CTF中flag通常有固定格式</span></span><br><span class="line">    message = <span class="string">&quot;flag&#123;test_123&#125;&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[明文]&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;原始消息: <span class="subst">&#123;message&#125;</span>&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 查看明文转换为整数后的值</span></span><br><span class="line">    m_int = bytes_to_long(message.encode())</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;消息转为整数: <span class="subst">&#123;m_int&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;整数位数: <span class="subst">&#123;m_int.bit_length()&#125;</span> bits&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>()</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 4. 加密</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[加密]&quot;</span>)</span><br><span class="line">    cipher = rsa.encrypt(message)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;密文(c): <span class="subst">&#123;cipher&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;密文位数: <span class="subst">&#123;cipher.bit_length()&#125;</span> bits&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>()</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 5. 解密</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[解密]&quot;</span>)</span><br><span class="line">    decrypted_int = rsa.decrypt(cipher)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;解密后整数: <span class="subst">&#123;decrypted_int&#125;</span>&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 将整数转换回字节，再转为字符串</span></span><br><span class="line">    decrypted_bytes = long_to_bytes(decrypted_int)</span><br><span class="line">    decrypted_str = decrypted_bytes.decode()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;解密后字符串: <span class="subst">&#123;decrypted_str&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>()</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 6. 验证</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[验证]&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> decrypted_str == message:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;✓ 加解密成功！&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;✗ 加解密失败！&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>()</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 7. 展示关键参数（CTF中常见）</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[关键参数]&quot;</span>)</span><br><span class="line">    d, p, q, phi = rsa.get_private_key()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;p: <span class="subst">&#123;p&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;q: <span class="subst">&#123;q&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;φ(n): <span class="subst">&#123;phi&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;d: <span class="subst">&#123;d&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>()</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 验证数学关系</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[数学验证]&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;1. n = p × q: <span class="subst">&#123;n == p * q&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;2. e × d mod φ(n) = 1: <span class="subst">&#123;(e * d) % phi == <span class="number">1</span>&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;3. (m^e)^d mod n = m: <span class="subst">&#123;<span class="built_in">pow</span>(<span class="built_in">pow</span>(m_int, e, n), d, n) == m_int&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ===========================================</span></span><br><span class="line"><span class="comment"># 安全注意事项</span></span><br><span class="line"><span class="comment"># ===========================================</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">security_warnings</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    教科书RSA的安全问题</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span> * <span class="number">50</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;安全警告：为什么教科书RSA不安全&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span> * <span class="number">50</span>)</span><br><span class="line">    </span><br><span class="line">    warnings = [</span><br><span class="line">        <span class="string">&quot;1. 无填充 → 确定性加密&quot;</span>,</span><br><span class="line">        <span class="string">&quot;   相同明文总是产生相同密文&quot;</span>,</span><br><span class="line">        <span class="string">&quot;   攻击者可以构建字典&quot;</span>,</span><br><span class="line">        <span class="string">&quot;&quot;</span>,</span><br><span class="line">        <span class="string">&quot;2. 易受小指数攻击&quot;</span>,</span><br><span class="line">        <span class="string">&quot;   如果e=3且m^3 &lt; n，可直接开立方&quot;</span>,</span><br><span class="line">        <span class="string">&quot;&quot;</span>,</span><br><span class="line">        <span class="string">&quot;3. 易受共模攻击&quot;</span>,</span><br><span class="line">        <span class="string">&quot;   同一明文用不同e加密，可恢复明文&quot;</span>,</span><br><span class="line">        <span class="string">&quot;&quot;</span>,</span><br><span class="line">        <span class="string">&quot;4. 不能抵抗选择密文攻击&quot;</span>,</span><br><span class="line">        <span class="string">&quot;   攻击者可以操纵密文获取信息&quot;</span>,</span><br><span class="line">        <span class="string">&quot;&quot;</span>,</span><br><span class="line">        <span class="string">&quot;5. 需要 m &lt; n&quot;</span>,</span><br><span class="line">        <span class="string">&quot;   长消息需要分块，但分块会暴露结构&quot;</span>,</span><br><span class="line">    ]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> warnings:</span><br><span class="line">        <span class="built_in">print</span>(line)</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\n解决方案：使用填充方案&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;- PKCS#1 v1.5 (旧)&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;- OAEP (推荐)&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;- PSS (签名)&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ===========================================</span></span><br><span class="line"><span class="comment"># CTF实战技巧</span></span><br><span class="line"><span class="comment"># ===========================================</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ctf_tips</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    CTF中遇到此类RSA的解题思路</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span> * <span class="number">50</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;CTF解题思路&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span> * <span class="number">50</span>)</span><br><span class="line">    </span><br><span class="line">    tips = [</span><br><span class="line">        <span class="string">&quot;1. 检查n是否可分解&quot;</span>,</span><br><span class="line">        <span class="string">&quot;   - n &lt; 256位：直接分解&quot;</span>,</span><br><span class="line">        <span class="string">&quot;   - n有特殊结构：Fermat分解&quot;</span>,</span><br><span class="line">        <span class="string">&quot;   - 使用factordb.com&quot;</span>,</span><br><span class="line">        <span class="string">&quot;&quot;</span>,</span><br><span class="line">        <span class="string">&quot;2. 检查e是否很小&quot;</span>,</span><br><span class="line">        <span class="string">&quot;   - e=3：可能直接开方&quot;</span>,</span><br><span class="line">        <span class="string">&quot;   - e和n相近：维纳攻击&quot;</span>,</span><br><span class="line">        <span class="string">&quot;&quot;</span>,</span><br><span class="line">        <span class="string">&quot;3. 是否有多个密文/密钥&quot;</span>,</span><br><span class="line">        <span class="string">&quot;   - 相同n不同e：共模攻击&quot;</span>,</span><br><span class="line">        <span class="string">&quot;   - 相同e不同n：广播攻击&quot;</span>,</span><br><span class="line">        <span class="string">&quot;&quot;</span>,</span><br><span class="line">        <span class="string">&quot;4. 检查填充&quot;</span>,</span><br><span class="line">        <span class="string">&quot;   - 无填充：直接攻击&quot;</span>,</span><br><span class="line">        <span class="string">&quot;   - 有填充：可能需要预言机&quot;</span>,</span><br><span class="line">        <span class="string">&quot;&quot;</span>,</span><br><span class="line">        <span class="string">&quot;5. 其他攻击&quot;</span>,</span><br><span class="line">        <span class="string">&quot;   - 已知明文攻击&quot;</span>,</span><br><span class="line">        <span class="string">&quot;   - 选择密文攻击&quot;</span>,</span><br><span class="line">        <span class="string">&quot;   - 时序攻击&quot;</span>,</span><br><span class="line">    ]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> tips:</span><br><span class="line">        <span class="built_in">print</span>(line)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="comment"># 运行演示</span></span><br><span class="line">    main()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\n&quot;</span> + <span class="string">&quot;=&quot;</span>*<span class="number">50</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 显示安全警告</span></span><br><span class="line">    security_warnings()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\n&quot;</span> + <span class="string">&quot;=&quot;</span>*<span class="number">50</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 显示CTF技巧</span></span><br><span class="line">    ctf_tips()</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 简单测试</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\n&quot;</span> + <span class="string">&quot;=&quot;</span>*<span class="number">50</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;快速测试：&quot;</span>)</span><br><span class="line">    test_rsa = TextbookRSA(<span class="number">256</span>)  <span class="comment"># 小密钥测试</span></span><br><span class="line">    test_msg = <span class="string">&quot;Hello RSA!&quot;</span></span><br><span class="line">    test_cipher = test_rsa.encrypt(test_msg)</span><br><span class="line">    test_decrypted = long_to_bytes(test_rsa.decrypt(test_cipher)).decode()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;测试消息: <span class="subst">&#123;test_msg&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;测试结果: <span class="subst">&#123;<span class="string">&#x27;成功&#x27;</span> <span class="keyword">if</span> test_decrypted == test_msg <span class="keyword">else</span> <span class="string">&#x27;失败&#x27;</span>&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>

<p>python在某些方面还是太方便了，可以直接使用pow函数进行加解密不需要我们自己去写算法，然后字符串转数字也十分方便。</p>
<h2 id="5-私钥计算算法实现"><a href="#5-私钥计算算法实现" class="headerlink" title="5.私钥计算算法实现"></a>5.私钥计算算法实现</h2><p>虽然私钥的计算看起来简单，但是还是需要一定的算力才可以实现的</p>
<div class="code-container" code-lang="Python"><div class="codebox"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">RSA私钥d计算器</span></span><br><span class="line"><span class="string">用法：已知φ(n)和e，计算私钥d</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> gcd</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mod_inverse</span>(<span class="params">e, phi</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    计算 e⁻¹ mod φ 使用扩展欧几里得算法</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    参数：</span></span><br><span class="line"><span class="string">        e: 公钥指数</span></span><br><span class="line"><span class="string">        phi: φ(n) = (p-1)(q-1)</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    返回：</span></span><br><span class="line"><span class="string">        d: 私钥指数</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># 简化的扩展欧几里得算法</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">egcd</span>(<span class="params">a, b</span>):</span><br><span class="line">        <span class="keyword">if</span> b == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> a, <span class="number">1</span>, <span class="number">0</span></span><br><span class="line">        g, x1, y1 = egcd(b, a % b)</span><br><span class="line">        <span class="keyword">return</span> g, y1, x1 - (a // b) * y1</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 检查e和φ是否互质</span></span><br><span class="line">    <span class="keyword">if</span> gcd(e, phi) != <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">f&quot;e=<span class="subst">&#123;e&#125;</span> 和 φ=<span class="subst">&#123;phi&#125;</span> 不互质，无法计算逆元&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 计算模逆</span></span><br><span class="line">    g, x, _ = egcd(e, phi)</span><br><span class="line">    <span class="keyword">if</span> g != <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">f&quot;e=<span class="subst">&#123;e&#125;</span> 在模 φ=<span class="subst">&#123;phi&#125;</span> 下没有逆元&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 确保结果是正数</span></span><br><span class="line">    d = x % phi</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 验证</span></span><br><span class="line">    <span class="keyword">if</span> (e * d) % phi != <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">&quot;计算错误：验证失败&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> d</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;RSA私钥d计算器&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span> * <span class="number">40</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 从命令行参数获取输入</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(sys.argv) == <span class="number">3</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            phi = <span class="built_in">int</span>(sys.argv[<span class="number">1</span>])</span><br><span class="line">            e = <span class="built_in">int</span>(sys.argv[<span class="number">2</span>])</span><br><span class="line">        <span class="keyword">except</span> ValueError:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;错误：参数必须是整数&quot;</span>)</span><br><span class="line">            sys.exit(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="comment"># 交互式输入</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            phi_input = <span class="built_in">input</span>(<span class="string">&quot;请输入 φ(n) 的值: &quot;</span>).strip()</span><br><span class="line">            e_input = <span class="built_in">input</span>(<span class="string">&quot;请输入 e 的值 (默认为65537): &quot;</span>).strip()</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> phi_input:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;错误：φ(n)不能为空&quot;</span>)</span><br><span class="line">                sys.exit(<span class="number">1</span>)</span><br><span class="line">            </span><br><span class="line">            phi = <span class="built_in">int</span>(phi_input)</span><br><span class="line">            e = <span class="built_in">int</span>(e_input) <span class="keyword">if</span> e_input <span class="keyword">else</span> <span class="number">65537</span></span><br><span class="line">        <span class="keyword">except</span> ValueError:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;错误：输入必须是整数&quot;</span>)</span><br><span class="line">            sys.exit(<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">except</span> KeyboardInterrupt:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;\n程序已退出&quot;</span>)</span><br><span class="line">            sys.exit(<span class="number">0</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;\n输入参数:&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;φ(n) = <span class="subst">&#123;phi&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;e     = <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># 计算私钥d</span></span><br><span class="line">        d = mod_inverse(e, phi)</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;\n计算结果:&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;私钥 d = <span class="subst">&#123;d&#125;</span>&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;\n验证:&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;e&#125;</span> × <span class="subst">&#123;d&#125;</span> mod <span class="subst">&#123;phi&#125;</span> = <span class="subst">&#123;(e * d) % phi&#125;</span>&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 额外信息</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;\n附加信息:&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;d的位数: <span class="subst">&#123;d.bit_length()&#125;</span> bits&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;d的16进制: <span class="subst">&#123;<span class="built_in">hex</span>(d)&#125;</span>&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 生成示例RSA参数（如果phi不太大）</span></span><br><span class="line">        <span class="keyword">if</span> phi.bit_length() &lt;= <span class="number">32</span>:  <span class="comment"># 小数字时演示</span></span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                <span class="comment"># 尝试从φ(n)恢复p和q（仅适用于小数字演示）</span></span><br><span class="line">                <span class="comment"># 解方程: p*q - (p+q) + 1 = φ</span></span><br><span class="line">                <span class="comment"># 假设p≈q，则p+q ≈ 2√(φ+p+q-1) ≈ 2√(n)</span></span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;\n[小数字演示] 尝试分解:&quot;</span>)</span><br><span class="line">                <span class="comment"># 简单试除法找可能的p,q</span></span><br><span class="line">                <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, <span class="built_in">min</span>(<span class="number">1000000</span>, <span class="built_in">int</span>(phi**<span class="number">0.5</span>) + <span class="number">100</span>)):</span><br><span class="line">                    <span class="keyword">if</span> phi % (i-<span class="number">1</span>) == <span class="number">0</span>:</span><br><span class="line">                        p = i</span><br><span class="line">                        q_candidate = phi // (p-<span class="number">1</span>) + <span class="number">1</span></span><br><span class="line">                        <span class="keyword">if</span> (p-<span class="number">1</span>)*(q_candidate-<span class="number">1</span>) == phi <span class="keyword">and</span> \</span><br><span class="line">                           <span class="built_in">abs</span>(p - q_candidate) &lt; p//<span class="number">2</span>:  <span class="comment"># p,q相近</span></span><br><span class="line">                            q = q_candidate</span><br><span class="line">                            n = p * q</span><br><span class="line">                            <span class="built_in">print</span>(<span class="string">f&quot;可能的 p = <span class="subst">&#123;p&#125;</span>&quot;</span>)</span><br><span class="line">                            <span class="built_in">print</span>(<span class="string">f&quot;可能的 q = <span class="subst">&#123;q&#125;</span>&quot;</span>)</span><br><span class="line">                            <span class="built_in">print</span>(<span class="string">f&quot;可能的 n = p×q = <span class="subst">&#123;n&#125;</span>&quot;</span>)</span><br><span class="line">                            <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="keyword">pass</span></span><br><span class="line">        </span><br><span class="line">    <span class="keyword">except</span> ValueError <span class="keyword">as</span> ve:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;\n错误: <span class="subst">&#123;ve&#125;</span>&quot;</span>)</span><br><span class="line">        sys.exit(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> ex:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;\n未知错误: <span class="subst">&#123;ex&#125;</span>&quot;</span>)</span><br><span class="line">        sys.exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">quick_usage</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;快速使用示例&quot;&quot;&quot;</span></span><br><span class="line">    examples = [</span><br><span class="line">        (<span class="string">&quot;python3 rsa_d.py 60 17&quot;</span>, <span class="string">&quot;计算e=17, φ=60时的d&quot;</span>),</span><br><span class="line">        (<span class="string">&quot;python3 rsa_d.py 3120 17&quot;</span>, <span class="string">&quot;计算e=17, φ=3120时的d&quot;</span>),</span><br><span class="line">        (<span class="string">&quot;echo &#x27;123456\n65537&#x27; | python3 rsa_d.py&quot;</span>, <span class="string">&quot;管道输入&quot;</span>),</span><br><span class="line">    ]</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;快速使用:&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> cmd, desc <span class="keyword">in</span> examples:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;  <span class="subst">&#123;cmd:<span class="number">45</span>&#125;</span> # <span class="subst">&#123;desc&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(sys.argv) &gt; <span class="number">1</span> <span class="keyword">and</span> sys.argv[<span class="number">1</span>] <span class="keyword">in</span> [<span class="string">&quot;-h&quot;</span>, <span class="string">&quot;--help&quot;</span>, <span class="string">&quot;help&quot;</span>]:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;RSA私钥d计算器 - 已知φ(n)和e，计算私钥d&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;\n使用方法:&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;  1. 交互模式: python3 rsa_d.py&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;  2. 命令行模式: python3 rsa_d.py &lt;φ(n)&gt; &lt;e&gt;&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;  3. 从文件读取: python3 rsa_d.py &lt; φ_e.txt&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;\n示例:&quot;</span>)</span><br><span class="line">        quick_usage()</span><br><span class="line">        sys.exit(<span class="number">0</span>)</span><br><span class="line">    </span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>



<p>还可以直接使用更加暴力的算法</p>
<div class="code-container" code-lang="Python"><div class="codebox"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">超级简洁的RSA私钥d计算器</span></span><br><span class="line"><span class="string">用法: python3 rsa_d_simple.py &lt;φ&gt; &lt;e&gt;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mod_inverse</span>(<span class="params">e, phi</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;计算 e⁻¹ mod φ&quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># 扩展欧几里得算法（简洁版）</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">egcd</span>(<span class="params">a, b</span>):</span><br><span class="line">        <span class="keyword">if</span> b == <span class="number">0</span>: <span class="keyword">return</span> (a, <span class="number">1</span>, <span class="number">0</span>)</span><br><span class="line">        g, x1, y1 = egcd(b, a % b)</span><br><span class="line">        <span class="keyword">return</span> (g, y1, x1 - (a // b) * y1)</span><br><span class="line">    </span><br><span class="line">    g, x, _ = egcd(e, phi)</span><br><span class="line">    <span class="keyword">if</span> g != <span class="number">1</span>: <span class="keyword">return</span> <span class="literal">None</span>  <span class="comment"># 无逆元</span></span><br><span class="line">    <span class="keyword">return</span> x % phi</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="comment"># 命令行或交互式输入</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(sys.argv) == <span class="number">3</span>:</span><br><span class="line">        phi, e = <span class="built_in">int</span>(sys.argv[<span class="number">1</span>]), <span class="built_in">int</span>(sys.argv[<span class="number">2</span>])</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        phi = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;φ(n): &quot;</span>))</span><br><span class="line">        e = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;e: &quot;</span>) <span class="keyword">or</span> <span class="string">&quot;65537&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 计算并输出</span></span><br><span class="line">    d = mod_inverse(e, phi)</span><br><span class="line">    <span class="keyword">if</span> d <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;错误: e=<span class="subst">&#123;e&#125;</span> 在模 φ=<span class="subst">&#123;phi&#125;</span> 下没有逆元&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;d = <span class="subst">&#123;d&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;验证: <span class="subst">&#123;e&#125;</span>×<span class="subst">&#123;d&#125;</span> mod <span class="subst">&#123;phi&#125;</span> = <span class="subst">&#123;(e*d)%phi&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>



<p>直接通过qp进行T的计算，有时候数据过大了还是使用Python方便一点。</p>
<div class="code-container" code-lang="Python"><div class="codebox"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">超级简洁的RSA φ(n) 计算器</span></span><br><span class="line"><span class="string">用法: python3 rsa_phi_simple.py &lt;p&gt; &lt;q&gt;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(sys.argv) != <span class="number">3</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;用法: <span class="subst">&#123;sys.argv[<span class="number">0</span>]&#125;</span> &lt;p&gt; &lt;q&gt;&quot;</span>)</span><br><span class="line">    sys.exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">p, q = <span class="built_in">int</span>(sys.argv[<span class="number">1</span>]), <span class="built_in">int</span>(sys.argv[<span class="number">2</span>])</span><br><span class="line">phi = (p-<span class="number">1</span>) * (q-<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;φ(<span class="subst">&#123;p*q&#125;</span>) = <span class="subst">&#123;phi&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>





<h2 id="6-中国剩余定理"><a href="#6-中国剩余定理" class="headerlink" title="6.中国剩余定理"></a>6.中国剩余定理</h2><p>写题目的时候遇到了dp和dq但是根本不知道什么意思。</p>
<p>原来的RSA</p>
<div class="code-container" code-lang="Python"><div class="codebox"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">m = c^d mod n</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>

<ul>
<li><strong>n是2048位</strong>的大整数</li>
<li><strong>d也是2048位</strong>的大整数</li>
<li>直接计算 <code>c^d mod n</code> 非常耗时</li>
<li>时间复杂度：O(log d) 次模乘，每次模乘操作大数</li>
</ul>
<p>CRT(中国剩余定理)优化的核心思想</p>
<p>将<strong>一个大问题分解为两个小问题</strong>：</p>
<div class="code-container" code-lang="Python"><div class="codebox"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">大数模运算：c^d mod n</span><br><span class="line">↓ 分解为 ↓</span><br><span class="line">小数模运算：c^dp mod p   <span class="comment"># p是1024位</span></span><br><span class="line">小数模运算：c^dq mod q   <span class="comment"># q是1024位</span></span><br><span class="line">然后合并结果</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>



<p>然后我们需要先了解一下中国剩余定理在RSA的数学基础</p>
<div class="code-container" code-lang="Python"><div class="codebox"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">已知：</span><br><span class="line">x ≡ a (mod p)</span><br><span class="line">x ≡ b (mod q)</span><br><span class="line"></span><br><span class="line">其中p,q互质</span><br><span class="line"></span><br><span class="line">则存在唯一解 x (mod p×q)：</span><br><span class="line">x = a + p × ((b-a) × p⁻¹ mod q)</span><br><span class="line">或者</span><br><span class="line">x = b + q × ((a-b) × q⁻¹ mod p)</span><br></pre></td></tr></table></figure><div class="code-fold" title="Fold/Open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg></div><div class="code-copy" title="Copy"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg></div></div></div>









</div><div class="post-reward"><div class="post-reward-btn" title="赞赏作者"><img src="/assets/images/svg/uc/uc-gift.svg" class="icon noview" alt="Icon"><span></span></div><div class="post-reward-content"><div class="post-reward-text"></div><div class="post-reward-list"><a href="/null" target="_blank">致谢名单</a></div></div></div><div class="post-copyright"><div class="post-copyright-info">本作品由 Regulus 于 2026-01-30 13:32:09 发布</div><div class="post-copyright-link"><span>作品地址：<a href="http://example.com/2026/01/30/Crypto-RSA/">Crypto_RSA</a></span><button class="copy-text" type="button" data-text="http://example.com/2026/01/30/Crypto-RSA/">复制</button></div><div class="post-copyright-detail">除特别声明外，本站作品均采用 <a href='https://creativecommons.org/licenses/by-nc-sa/4.0/' title='Attribution-NonCommercial-ShareAlike' target='_blank'>CC BY-NC-SA 4.0</a> 许可协议，转载请注明来自 <a href='/'>Mei的小窝</a></div><img class="post-copyright-icon noview" src="/assets/images/Hexo-Theme-MEOW.png" alt="Logo"/></div><div class="post-tail-tags"></div></div><aside id="post-sidebar" status="show"><div id="toc-container"><div class="toc-title"><img src="/assets/images/svg/ta/ta-toc.svg" class="icon noview" alt="Icon"><span>目录</span></div><div class="toc-content" id="toc-div"><ol class="toc-list"><li class="toc-list-item toc-list-level-1"><a class="toc-list-link" href="#Crypto-RSA"><span class="toc-list-text">Crypto RSA</span></a><ol class="toc-list-child"><li class="toc-list-item toc-list-level-2"><a class="toc-list-link" href="#1-%E7%AE%97%E6%B3%95%E5%8E%9F%E7%90%86"><span class="toc-list-text">1.算法原理</span></a></li><li class="toc-list-item toc-list-level-2"><a class="toc-list-link" href="#2-%E5%85%AC%E9%92%A5%E5%92%8C%E7%A7%81%E9%92%A5%E7%9A%84%E7%94%9F%E6%88%90"><span class="toc-list-text">2.公钥和私钥的生成</span></a></li><li class="toc-list-item toc-list-level-2"><a class="toc-list-link" href="#3-RSA%E5%8A%A0%E8%A7%A3%E5%AF%86"><span class="toc-list-text">3.RSA加解密</span></a></li><li class="toc-list-item toc-list-level-2"><a class="toc-list-link" href="#4-%E5%8A%A0%E8%A7%A3%E5%AF%86%E7%AE%97%E6%B3%95%E5%AE%9E%E7%8E%B0"><span class="toc-list-text">4.加解密算法实现</span></a></li><li class="toc-list-item toc-list-level-2"><a class="toc-list-link" href="#5-%E7%A7%81%E9%92%A5%E8%AE%A1%E7%AE%97%E7%AE%97%E6%B3%95%E5%AE%9E%E7%8E%B0"><span class="toc-list-text">5.私钥计算算法实现</span></a></li><li class="toc-list-item toc-list-level-2"><a class="toc-list-link" href="#6-%E4%B8%AD%E5%9B%BD%E5%89%A9%E4%BD%99%E5%AE%9A%E7%90%86"><span class="toc-list-text">6.中国剩余定理</span></a></li></ol></li></ol></div></div></aside></div></div><div id="toolbar" hide=""><div id="toolbar-setting-container" hide=""><div class="toolbar-item"><button id="tool-color-mode" title="深色模式" type="button"><img src="/assets/images/svg/ta/ta-moon.svg" class="icon noview" alt="Icon"></button></div><div class="toolbar-item"><button class="copy-text" id="tool-share" title="分享" type="button" data-text="http://example.com/2026/01/30/Crypto-RSA/"><img src="/assets/images/svg/ta/ta-share.svg" class="icon noview" alt="Icon"></button></div><div class="toolbar-item"><button id="tool-font-size-plus" title="放大字体" type="button"><img src="/assets/images/svg/ta/ta-text-plus.svg" class="icon noview" alt="Icon"></button></div><div class="toolbar-item"><button id="tool-font-size-minus" title="缩小字体" type="button"><img src="/assets/images/svg/ta/ta-text-minus.svg" class="icon noview" alt="Icon"></button></div></div><div class="toolbar-container"><div class="toolbar-item"><button id="tool-setting" title="设置" type="button"><img src="/assets/images/svg/ta/ta-setting.svg" class="icon noview" alt="Icon"></button></div><div class="toolbar-item"><button id="tool-toc" title="目录" type="button"><img src="/assets/images/svg/ta/ta-toc.svg" class="icon noview" alt="Icon"></button></div><div class="toolbar-item"><button id="tool-gototop" title="返回顶部" type="button"><img src="/assets/images/svg/ta/ta-up.svg" class="icon noview" alt="Icon"></button></div></div></div><div class="search-overlay"><div class="search-container"><div class="search-header"><div class="search-title"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0" /><path d="M21 21l-6 -6" /></svg>
搜索</div><div class="search-close-btn"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 21a9 9 0 0 0 9 -9a9 9 0 0 0 -9 -9a9 9 0 0 0 -9 9a9 9 0 0 0 9 9z" /><path d="M9 8l6 8" /><path d="M15 8l-6 8" /></svg></div></div><div class="search-input-box"><input id="search-input" type="search" placeholder="请输入关键词进行站内搜索……" value="" maxlength="80"/></div><div class="search-result-container"><div class="search-result-icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0" /><path d="M21 21l-6 -6" /></svg></div></div></div></div></main><footer><div class="footer"><div id="footer-copyright">© 2024 - 2026 <span>💗</span> <a href="/null">Regulus</a></div><div id="footer-info"><div id="footer-framework">🚀本站由 <a href="https://hexo.io" target="_blank">Hexo</a> & <a href="https://github.com/chanwj/hexo-theme-meow" title="3.2.0" target="_blank">Meow</a> 强力驱动</div><div id="footer-runtime"><span id="runtime" data-startdate="2024-04-02T22:16:20.000Z">🌻已稳定运行.年.月.天</span></div></div><div id="footer-statistic"><span>共撰写168篇文章，全站共460.2k字</span></div><div id="footer-pageview"><div id="container_site_pv"><span>🔥总访问量</span><span id="vercount_value_site_pv"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"  stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 6l0 -3" /><path d="M16.25 7.75l2.15 -2.15" /><path d="M18 12l3 0" /><path d="M16.25 16.25l2.15 2.15" /><path d="M12 18l0 3" /><path d="M7.75 16.25l-2.15 2.15" /><path d="M6 12l-3 0" /><path d="M7.75 7.75l-2.15 -2.15" /></svg></span></div><div id="container_site_uv"><span>🐈访客人数</span><span id="vercount_value_site_uv"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"  stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 6l0 -3" /><path d="M16.25 7.75l2.15 -2.15" /><path d="M18 12l3 0" /><path d="M16.25 16.25l2.15 2.15" /><path d="M12 18l0 3" /><path d="M7.75 16.25l-2.15 2.15" /><path d="M6 12l-3 0" /><path d="M7.75 7.75l-2.15 -2.15" /></svg></span></div></div></div></footer><div class="scripts"><script>const GLOBALCONFIG = {
  root: '/',
  toolbar: true,
  lazyload_src: '/assets/images/Meow-Loading.webp',
  friends: false,
  codeblock: true,
  share_text: '',
  onblur_title: 'Please Come Back～✧(´▽`ʃ♡ƪ)',
  mouse_click: false,
  notify:{
    enable: false,
    info: '复制成功～转载请标注本文地址',
    f12_info: '开发者模式已打开，请遵循本站版权协议'
  },
  search: {
    enable: true,
    path: 'search.json',
    local: {
      top_n_per_article: 1,
      preload: false
    }
  },
  encrypt: false,
};
</script><script>if (!localStorage.getItem('color-mode')) {
  localStorage.setItem('color-mode', 'light' || 'light');
}
document.body.setAttribute('data-mode', localStorage.getItem('color-mode'));
</script>
<script src="/js/theme/tools/utils.js"></script>

<script src="/js/plugins/dist/lazyload.min.js"></script>

<script src="/js/plugins/view-image.min.js"></script>
<script src="https://events.vercount.one/js" defer="defer"></script><script>if (localStorage.getItem('font-size')) {
  document.querySelector('.post').style.fontSize = localStorage.getItem('font-size') + 'px';
}
</script>
<script src="/js/plugins/dist/search.js"></script>

<script src="/js/main.js" type="module"></script>
</div></body></html>